!function(){"use strict";var e,t,T,n,r,l,i;(e=e=e||{}).SoftOptIn="Soft Opt-in",e.Explicit="Explicit",e.Implicit="Implicit",(t=t=t||{}).ConsentChanged="ConsentChanged",t.ShowChangeSettingsModal="ShowChangeSettingsModal",t.ShowConsentNotice="ConsentNotice",t.CloseChangeSettingsModal="CloseChangeSettingsModal",t.CloseConsentNotice="CloseConsentNotice",t.AcceptAll="AcceptAll",t.RejectAll="RejectAll",t.ShowTemplate="ShowTemplate",t.CloseTemplate="CloseTemplate",t.UpdateConsent="UpdateConsent",(T=T=T||{}).Init="Init",T.ConsentModelSelected="ConsentModelSelected",(n=n=n||{}).Default="Default",n.HeadLess="HeadLess",(r=r=r||{}).Url="Url",r.Text="Text",(i=i=i||{}).ConsentNotice="consentNotice",i.ChangeSettingsModal="preferenceCenter",(i=l=l||{}).OFF="0",i.ON="1",(A=A=A||{}).Script="SCRIPT",A.IFrame="IFRAME";var c=(o.shouldScriptConsented=function(t,e){if(null===e||e===this.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE)return!1;e=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return null!==e.identifier&&e.type===window.__MSFT_SDK.enums.RegisteredDivType.Script&&e.identifier===t});return this.consentCategoriesPending(e)},o.shouldIFrameConsented=function(t){if(null==t)return!1;var e=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return null!==e.identifier&&e.type===window.__MSFT_SDK.enums.RegisteredDivType.IFrame&&e.identifier===t});return this.consentCategoriesPending(e)},o.consentCategoriesPending=function(e){if(null==e)return!1;e=null===(e=e.categories)||void 0===e?void 0:e.split(",").filter(function(e){var t;return!((null===(t=window.__MSFT_SDK.Store.getters.userConsent)||void 0===t?void 0:t.preferences[e])===l.ON)});return null!=e&&0<e.length},o.shouldbeUnblocked=function(e){if(null==e)return!1;e=e.split(",").filter(function(e){var t;return!((null===(t=window.__MSFT_SDK.Store.getters.userConsent)||void 0===t?void 0:t.preferences[e])===l.ON)});return null==e||0==e.length},o.shouldScriptUnblocked=function(e,t){return null!==e&&e===this.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE&&this.shouldbeUnblocked(t)},o.shouldIFrameUnblocked=function(e,t){return null!==e&&this.shouldbeUnblocked(t)},o.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE="text/blocked",o.MSFT_CONSENT_CATEGORIES_ATTRIBUTE="msft-consent-categories",o.SRC_ATTRIBUTE="src",o.DATASET_SRC_ATTRIBUTE="data-src",o.SCRIPT_TYPE_ATTRIBUTE="type",o.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE="msft-post-consent-type",o.MSFT_CONSENT_IGNORE_ATTRIBUTE="msft-ignore-consent",o);function o(){}function _(e,t){var T="function"==typeof Symbol&&e[Symbol.iterator];if(!T)return e;var n,r,i=T.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)o.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(T=i.return)&&T.call(i)}finally{if(r)throw r.error}}return o}function S(e,t,T){if(T||2===arguments.length)for(var n,r=0,i=t.length;r<i;r++)!n&&r in t||((n=n||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}var u=document.createElement;function E(e){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ConsentChanged,E.unblock),this.domObserver=null,e&&(this.domObserver=new MutationObserver(function(e){return E.mutationCallback(e)}),this.domObserver.observe(document.documentElement,{childList:!0,subtree:!0}))}document.createElement=function(e){for(var t=[],T=1;T<arguments.length;T++)t[T-1]=arguments[T];if("script"!==e.toLowerCase())return u.bind(document).apply(void 0,S([e],_(t),!1));var r=u.bind(document).apply(void 0,S([e],_(t),!1));try{Object.defineProperties(r,{src:{get:function(){return r.getAttribute(c.SRC_ATTRIBUTE)},set:function(t){var e,T=r.getAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE),n=r.getAttribute(c.SCRIPT_TYPE_ATTRIBUTE);c.shouldScriptConsented(t,n)?(null!=(e=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return e.type===window.__MSFT_SDK.enums.RegisteredDivType.Script&&e.identifier===t}))&&HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE,e.categories.join(",")),null===T&&null!==n&&HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE,n),HTMLScriptElement.prototype.setAttribute.call(r,c.SCRIPT_TYPE_ATTRIBUTE,c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE)):n===c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE&&(T=r.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE),c.shouldScriptUnblocked(n,T)&&(T=null!=(T=r.getAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE))?T:"application/javascript",HTMLScriptElement.prototype.setAttribute.call(r,c.SCRIPT_TYPE_ATTRIBUTE,T))),HTMLScriptElement.prototype.setAttribute.call(r,c.SRC_ATTRIBUTE,t)}},type:{get:function(){return r.getAttribute(c.SCRIPT_TYPE_ATTRIBUTE)},set:function(e){var t,e=e,T=r.getAttribute(c.SRC_ATTRIBUTE);c.shouldScriptConsented(T,e)?(null!=(t=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return e.type===window.__MSFT_SDK.enums.RegisteredDivType.Script&&e.identifier===T}))&&HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE,t.categories.join(",")),HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE,e),e=c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE):e===c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE&&(t=r.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE),c.shouldScriptUnblocked(e,t)&&(e=null!=(t=r.getAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE))?t:"application/javascript")),HTMLScriptElement.prototype.setAttribute.call(r,c.SCRIPT_TYPE_ATTRIBUTE,e)}},"msft-consent-categories":{get:function(){return r.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE)},set:function(e){var t,T=r.getAttribute(c.SRC_ATTRIBUTE),n=r.getAttribute(c.SCRIPT_TYPE_ATTRIBUTE);null!=n&&c.shouldScriptConsented(T,n)?(null!=(t=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return e.type===window.__MSFT_SDK.enums.RegisteredDivType.Script&&e.identifier===T}))&&HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE,t.categories.join(",")),HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE,n),n=c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE):n===c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE&&c.shouldScriptUnblocked(n,e)&&(n=null!=(t=r.getAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE))?t:"application/javascript"),null!=n&&HTMLScriptElement.prototype.setAttribute.call(r,c.SCRIPT_TYPE_ATTRIBUTE,n),HTMLScriptElement.prototype.setAttribute.call(r,c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE,e)}}}),r.setAttribute=function(e,t){e===c.SCRIPT_TYPE_ATTRIBUTE||e===c.SRC_ATTRIBUTE||e===c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE?r[e]=t:HTMLScriptElement.prototype.setAttribute.call(r,e,t)}}catch(e){console.warn("Script execution for the script with src",r.src," can't be blocked")}return r};var s=new(E.mutationCallback=function(e){e.forEach(function(e){e.addedNodes.forEach(function(t){try{1===t.nodeType&&!1===t.hasAttribute(c.MSFT_CONSENT_IGNORE_ATTRIBUTE)&&(t.nodeName===window.__MSFT_SDK.enums.RegisteredDivType.Script?E.scriptMutationObserver(t):t.nodeName===window.__MSFT_SDK.enums.RegisteredDivType.IFrame&&E.iframeMutationObserver(t))}catch(e){console.warn("Failed to block tag ",t.nodeName)}})})},E.scriptMutationObserver=function(t){var e,T,n=t.src,r=t.type,i=t.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);c.shouldScriptConsented(n,r)?(void 0!==(e=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return e.type===window.__MSFT_SDK.enums.RegisteredDivType.Script&&e.identifier===n}))&&(t.setAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE,e.categories.join(",")),t.setAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE,r)),t.setAttribute(c.SCRIPT_TYPE_ATTRIBUTE,c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE),T=function(e){t.getAttribute(c.SCRIPT_TYPE_ATTRIBUTE)===c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE&&e.preventDefault(),t.removeEventListener("beforescriptexecute",T)},t.addEventListener("beforescriptexecute",T)):r===c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE&&c.shouldScriptUnblocked(r,i)&&(i=null!=(i=t.getAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE))?i:"application/javascript",t.setAttribute(c.SCRIPT_TYPE_ATTRIBUTE,i))},E.iframeMutationObserver=function(e){var t,T=e.src,n=e.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE),r=e.getAttribute(c.DATASET_SRC_ATTRIBUTE);c.shouldIFrameConsented(T)?void 0!==(t=window.__MSFT_SDK.Store.getters.extendedTrackers.find(function(e){return e.type===window.__MSFT_SDK.enums.RegisteredDivType.IFrame&&e.identifier===T}))&&(e.setAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE,t.categories.join(",")),e.removeAttribute(c.SRC_ATTRIBUTE),e.setAttribute(c.DATASET_SRC_ATTRIBUTE,T)):null!==r&&c.shouldIFrameUnblocked(T,n)&&(e.removeAttribute(c.DATASET_SRC_ATTRIBUTE),e.setAttribute(c.SRC_ATTRIBUTE,r))},E.unblock=function(){E.unblockScripts(),E.unblockIFrames()},E.unblockScripts=function(){document.querySelectorAll("script["+c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE+"]["+c.SCRIPT_TYPE_ATTRIBUTE+'="'+c.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE+'"]:not(['+c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE+'=""])').forEach(function(e){var t=e;try{var T=t.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE),n=null==T?void 0:T.split(",").filter(function(e){var t;return!((null===(t=window.__MSFT_SDK.Store.getters.userConsent)||void 0===t?void 0:t.preferences[e])===l.ON)});if(null==n||0===n.length){var r=null!=(r=t.getAttribute(c.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE))?r:"application/javascript",i=t.parentNode;null!=i&&i.removeChild(t);for(var o=document.createElement("script"),_=0;_<t.attributes.length;_++){var S=t.attributes[_];"type"!==S.name?o.setAttribute(S.name,t.attributes[_].value):o.setAttribute(c.SCRIPT_TYPE_ATTRIBUTE,r)}o.appendChild(document.createTextNode(t.innerHTML)),(null==i?document.head:i).appendChild(o)}}catch(e){console.warn("Failed to unblock the script ",t.src,"with error ",e)}})},E.unblockIFrames=function(){document.querySelectorAll("iframe["+c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE+"]["+c.DATASET_SRC_ATTRIBUTE+"]:not(["+c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE+'=""]['+c.DATASET_SRC_ATTRIBUTE+'=""])').forEach(function(t){try{var e,T,n,r=t.getAttribute(c.MSFT_CONSENT_CATEGORIES_ATTRIBUTE),i=null==r?void 0:r.split(",").filter(function(e){var t;return!((null===(t=window.__MSFT_SDK.Store.getters.userConsent)||void 0===t?void 0:t.preferences[e])===l.ON)});null!=i&&0!==i.length||(null!=(e=t.parentNode)&&e.removeChild(t),n=null!==(n=(T=t.cloneNode(!0)).getAttribute(c.DATASET_SRC_ATTRIBUTE))?n:"",T.setAttribute(c.SRC_ATTRIBUTE,n),T.removeAttribute(c.DATASET_SRC_ATTRIBUTE),(null==e?document.head:e).appendChild(T))}catch(e){console.warn("Failed to unblock the iframe ",t.src,"with error ",e)}})},E)(!0),A=(d.getBlockingService=function(){return s},d);function d(){}window.__MSFT_SDK.Helpers.AddPublicApis(A),window.__MSFT_SDK.Helpers.exposeApis()}();
