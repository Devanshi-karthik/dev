!function(){"use strict";var n,e;(i=n=n||{}).INIT_CONFIG="initConfig",i.DISCONNECT="disconnect",(e=e||{}).CONNECTED="connected";var i=(t.prototype.send=function(n){var e;null!==(e=this.source)&&void 0!==e&&e.postMessage(n,{targetOrigin:"*"})},t.prototype.listen=function(e){var i=this;window.addEventListener("message",function(n){i.source=i.source||n.source,i.origin=i.origin||n.origin,e(n.data)})},t);function t(n){this.source=null,this.origin="",this.listen(n)}var o=(s.send=function(n){s.messengerPlugin.send(n)},s.listen=function(n,e){s.callbacksMap[n]=s.callbacksMap[n]||[],s.callbacksMap[n].push(e)},s.onMessage=function(n){var e=n.event,i=n.value;null!==(e=s.callbacksMap[e])&&void 0!==e&&e.forEach(function(n){return n(i)})},s.callbacksMap={},s.messengerPlugin=new i(s.onMessage),s);function s(){}var c=((i={})[e.CONNECTED]=function(){o.send({event:e.CONNECTED})},i),a=((i={})[n.INIT_CONFIG]=function(n){window.MSFTConsent.init({consentModel:n}),c.connected()},i[n.DISCONNECT]=function(){window.close()},i);Object.keys(a).forEach(function(n){o.listen(n,a[n])})}();
