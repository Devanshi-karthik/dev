!function(){"use strict";var n,e;(i=n=n||{}).INIT_CONFIG="initConfig",i.DISCONNECT="disconnect",(e=e||{}).CONNECTED="connected";var i=(t.prototype.send=function(n){var e;null!==(e=this.source)&&void 0!==e&&e.postMessage(n,{targetOrigin:"*"})},t.prototype.listen=function(e){var i=this;window.addEventListener("message",function(n){i.source=i.source||n.source,i.origin=i.origin||n.origin,e(n.data)})},t);function t(n){this.source=null,this.origin="",this.listen(n)}var s=(o.send=function(n){o.messengerPlugin.send(n)},o.listen=function(n,e){o.callbacksMap[n]=o.callbacksMap[n]||[],o.callbacksMap[n].push(e)},o.onMessage=function(n){var e=n.event,i=n.value;null!==(e=o.callbacksMap[e])&&void 0!==e&&e.forEach(function(n){return n(i)})},o.callbacksMap={},o.messengerPlugin=new i(o.onMessage),o);function o(){}var c=((i={})[e.CONNECTED]=function(){s.send({event:e.CONNECTED})},i),a=((i={})[n.INIT_CONFIG]=function(n){window.__MSFT_SDK.initConsent(n),c.connected()},i[n.DISCONNECT]=function(){window.close()},i);Object.keys(a).forEach(function(n){s.listen(n,a[n])})}();
