!function(){"use strict";var e,r,u,i,w,t,S=function(){return(S=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function n(e,a,s,l){return new(s=s||Promise)(function(n,t){function o(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,r)}i((l=l.apply(e,a||[])).next())})}function a(o,r){var i,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=r.call(o,l)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function f(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||((o=o||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}(o=e=e||{}).ConsentChanged="ConsentChanged",o.ShowConsentNotice="ShowConsentNotice",o.ShowFirstPage="ShowFirstPage",o.CloseConsentNotice="CloseConsentNotice",o.AcceptAll="AcceptAll",o.RejectAll="RejectAll",o.ShowTemplate="ShowTemplate",o.CloseTemplate="CloseTemplate",o.UpdateConsent="UpdateConsent",o.AnchorTagClicked="AnchorTagClicked",o.FetchConfig="FetchConfig",o.QuestionsFormSubmitWithoutMetaData="QuestionsFormSubmitWithoutMetaData",o.QuestionsFormSubmit="QuestionsFormSubmit",o.ShowPreferences="ShowPreferences",(o=r=r||{}).Url="Url",o.Text="Text",(o=u=u||{}).TrackerCategory="trackerCategory",o.Questions="Questions",(i=i||{}).TemplateError="<b>There is something wrong with template. Please check logs.</b>",(o=w=w||{}).WebConsentModel="WebConsentModel",o.QuestionModel="DSRSubmissionModel",(t=t||{}).Preferences="Preferences";s.registerShowTemplateHandlers=function(){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowConsentNotice,s.showFirstPage),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice,s.hideConsentNotice),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.Init,s.saveStylesOnInit),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowTemplate,s.showTemplate),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseTemplate,s.closeTemplate),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.ConfigReady,s.init),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowPreferences,s.showPreferences)},s.showPreferences=function(){try{s.showTemplate({templateId:t.Preferences})}catch(e){s.showFirstPage()}},s.showTemplate=function(e){e=e.templateId;if(!window.__MSFT_SDK.Store.getters.components||!window.__MSFT_SDK.Store.getters.components[e])throw new Error("Template : ".concat(e," not found."));var t=window.__MSFT_SDK.Store.getters.currentModel;s.showTemplateInIFrame(window.__MSFT_SDK.Store.getters.components[e],e,[{type:r.Text,value:(null==t?void 0:t.layout.ui.css)||""}],s.getParentElement(e))},s.closeTemplate=function(e){e=e.templateId;s.closeIFrame(e)},s.saveStylesOnInit=function(e){e.styles&&(window.__MSFT_SDK.Logger.info("user provided styles persisted to window.__MSFT_SDK.Store."),window.__MSFT_SDK.Store.reducers.setStyles(e.styles))},s.validationArrayToObject=function(e){return e.reduce(function(e,t){return S(S({},e),((e={})[t]=!0,e))},{})},s.getTemplateData=function(o){var r=this,e=window.__MSFT_SDK.Store.getters.translations,t=window.__MSFT_SDK.Store.getters.questions,i={},a={},s=(i[u.TrackerCategory]=[],i[u.Questions]=[],new Map),l=new Map,c=new Set,d=new Set;return o.kind===w.WebConsentModel?o.trackerCategories.forEach(function(e){s.set(e.id,e)}):o.kind===w.QuestionModel&&(t.forEach(function(e){l.set(e.name,e)}),i.captcha=o.captcha),e.forEach(function(n){return Object.keys(n).forEach(function(t){var e;"model"===t?i=S(S({},i),n[t]):l.has(t)&&!c.has(t)?((a=S(S(S({},n[t]),l.get(t)),{validations:r.validationArrayToObject((null==(e=l.get(t))?void 0:e.validations)||[])})).validations=S(S({},a.validations),r.validationArrayToObject((null==(e=o.questions.find(function(e){return e.questionName==t}))?void 0:e.validations)||[])),i[u.Questions].push(a),c.add(t)):o.kind===w.QuestionModel?i=S(S({},i),((e={})[t]=n[t],e)):s.has(t)&&!d.has(t)&&(e=S(S({},n[t]),{name:null==(e=s.get(t))?void 0:e.categoryName,isEssential:null==(e=s.get(t))?void 0:e.isEssential}),i[u.TrackerCategory].push(e),d.add(t))})}),i[u.TrackerCategory]=f(f([],_(i[u.TrackerCategory].filter(function(e){return e.isEssential})),!1),_(i[u.TrackerCategory].filter(function(e){return!e.isEssential})),!1),i["msft-script-open"]="<script>",i["msft-script-close"]="<\/script>",window.__MSFT_SDK.Logger.info("getTemplate data invoked",{consentModel:o,data:i}),S(S({},i),window.__MSFT_SDK.Store.getters.templateData)},s.init=function(){var e,t,o;window.Handlebars&&(window.Handlebars.registerHelper("toLowerCase",function(e){return e.toLowerCase()}),window.Handlebars.registerHelper("equals",function(e,t){return e.toLowerCase()===t.toLowerCase()})),void 0===window.__MSFT_SDK.Store.getters.currentModel||void 0===window.__MSFT_SDK.Store.getters.template?window.__MSFT_SDK.Logger.warn("Cannot call init before config is ready."):(e=window.__MSFT_SDK.Store.getters.currentModel,t=window.__MSFT_SDK.Store.getters.template,o=s.getTemplateData(e),t.pages.forEach(function(e){var t;try{var n=window.Handlebars.compile(e.content)(o)}catch(e){window.__MSFT_SDK.Logger.error(e.message,e),n=i.TemplateError}window.__MSFT_SDK.Store.reducers.setComponents(S(S({},window.__MSFT_SDK.Store.getters.components),((t={})[e.name]=n,t)))}),window.__MSFT_SDK.Logger.info("Components updated"),s.initialized=!0,window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowFirstPage,s.showFirstPage))},s.showFirstPage=function(){s.initialized||s.init();var t,e,n,o=window.__MSFT_SDK.Store.getters.currentModel;void 0===o?window.__MSFT_SDK.Logger.warn("Cannot call init before consent model is selected."):(t=o.layout.ui.mode,e=null==(e=null==(e=window.__MSFT_SDK.Store.getters.template)?void 0:e.modes.find(function(e){return e.name===t}))?void 0:e.initPage,void 0===window.__MSFT_SDK.Store.getters.components||void 0===e||void 0===window.__MSFT_SDK.Store.getters.components[e]?window.__MSFT_SDK.Logger.error("Notice template not found."):(n=window.__MSFT_SDK.Store.getters.components[e],s.showTemplateInIFrame(n,e,[{type:r.Text,value:o.layout.ui.css||""}],s.getParentElement(e))))},s.getParentElement=function(e){var t=((null==(t=window.__MSFT_SDK.Store.getters.config.initConfig)?void 0:t.componentParentMap)||window.__MSFT_SDK.Store.getters.templateParentMap)[e];return t?document.getElementById(t):null},s.showTemplateInIFrame=function(e,t,n,o){var r;void 0===n&&(n=[]),document.getElementById(t)?window.__MSFT_SDK.Logger.info("Template: ".concat(t," is already open.")):(e!==i.TemplateError||window.__MSFT_SDK.Store.getters.isLivePreviewMode&&window.__MSFT_SDK.Store.getters.isPreviewMode)&&(r={origin:window.origin},e="<script>var msftData = ".concat(JSON.stringify(r),"<\/script>")+e,null!=(r=window.__MSFT_SDK.Store.getters.config.initConfig)&&r.renderTemplateWithoutIframe||(e="<script>".concat(window.__MSFT_SDK.Store.getters.proxyJS,"<\/script>")+e),window.__MSFT_SDK.Utils.IFrameUtils.createIFrame(e,t,o,n))},s.hideConsentNotice=function(){var t,e=window.__MSFT_SDK.Store.getters.currentModel;void 0===e?window.__MSFT_SDK.Logger.warn("Cannot call hideConsentNotice before consent model is selected."):(t=e.layout.ui.mode,(e=null==(e=null==(e=window.__MSFT_SDK.Store.getters.template)?void 0:e.modes.find(function(e){return e.name===t}))?void 0:e.initPage)&&s.closeIFrame(e))},s.closeIFrame=function(e){var t,e=document.getElementById(e);null!=(t=null==e?void 0:e.parentElement)&&t.removeChild(e)},s.initialized=!1;var o=s;function s(){s.registerShowTemplateHandlers()}window.onmessage=function(o){return n(void 0,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:return"null"!==o.origin?[3,3]:window.__MSFT_SDK.Store.getters.isActionDisabled&&"trigger"===o.data.method?[2]:(t=(t=window.MSFTConsent)[o.data.method].apply(t,f([],_(o.data.params),!1)))instanceof Promise?[4,t]:[3,2];case 1:t=e.sent(),e.label=2;case 2:o.data.responseId&&null!=(n=o.source)&&n.postMessage(S(S({},o.data),{response:t}),{targetOrigin:"*"}),e.label=3;case 3:return[2]}})})},window.__MSFT_SDK.EventBus.on(e.AnchorTagClicked,function(e){var t=e.attributes,n=document.createElement("a");Object.keys(t).forEach(function(e){n.setAttribute(e,t[e])}),n.click()}),new o}();
