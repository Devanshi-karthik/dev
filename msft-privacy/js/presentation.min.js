(function () {
    'use strict';

    /******************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
    /* global Reflect, Promise */

    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };

    function __extends(d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }

    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m) return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
        }
        catch (error) { e = { error: error }; }
        finally {
            try {
                if (r && !r.done && (m = i["return"])) m.call(i);
            }
            finally { if (e) throw e.error; }
        }
        return ar;
    }

    function __spreadArray(to, from, pack) {
        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
            if (ar || !(i in from)) {
                if (!ar) ar = Array.prototype.slice.call(from, 0, i);
                ar[i] = from[i];
            }
        }
        return to.concat(ar || Array.prototype.slice.call(from));
    }

    var ConsentModelType;
    (function (ConsentModelType) {
        ConsentModelType["Explicit"] = "Explicit";
        ConsentModelType["Implicit"] = "Implicit";
    })(ConsentModelType || (ConsentModelType = {}));
    var PublicEvents;
    (function (PublicEvents) {
        PublicEvents["ConsentChanged"] = "ConsentChanged";
        PublicEvents["ShowConsentNotice"] = "ShowConsentNotice";
        PublicEvents["ShowFirstPage"] = "ShowFirstPage";
        PublicEvents["CloseConsentNotice"] = "CloseConsentNotice";
        PublicEvents["AcceptAll"] = "AcceptAll";
        PublicEvents["RejectAll"] = "RejectAll";
        PublicEvents["ShowTemplate"] = "ShowTemplate";
        PublicEvents["CloseTemplate"] = "CloseTemplate";
        PublicEvents["UpdateConsent"] = "UpdateConsent";
        PublicEvents["AnchorTagClicked"] = "AnchorTagClicked";
        PublicEvents["FetchConfig"] = "FetchConfig";
        PublicEvents["QuestionsFormSubmitWithoutMetaData"] = "QuestionsFormSubmitWithoutMetaData";
        PublicEvents["QuestionsFormSubmit"] = "QuestionsFormSubmit";
        PublicEvents["ShowPreferences"] = "ShowPreferences";
    })(PublicEvents || (PublicEvents = {}));
    var Events;
    (function (Events) {
        Events["Init"] = "Init";
        Events["CoreConsentModelSelected"] = "CoreConsentModelSelected";
        Events["ConfigReady"] = "ConfigReady";
    })(Events || (Events = {}));
    var SDKMode;
    (function (SDKMode) {
        SDKMode["Default"] = "Default";
        SDKMode["HeadLess"] = "HeadLess";
    })(SDKMode || (SDKMode = {}));
    var StyleType;
    (function (StyleType) {
        StyleType["Url"] = "Url";
        StyleType["Text"] = "Text";
    })(StyleType || (StyleType = {}));
    var Preference;
    (function (Preference) {
        Preference["OFF"] = "0";
        Preference["ON"] = "1";
    })(Preference || (Preference = {}));
    var Cookie;
    (function (Cookie) {
        Cookie["Consent"] = "msft-consent";
    })(Cookie || (Cookie = {}));
    var RegisteredDivType;
    (function (RegisteredDivType) {
        RegisteredDivType["Script"] = "script";
        RegisteredDivType["IFrame"] = "iframe";
    })(RegisteredDivType || (RegisteredDivType = {}));
    var NoticeType;
    (function (NoticeType) {
        NoticeType["TrackerCategory"] = "trackerCategory";
    })(NoticeType || (NoticeType = {}));
    var ErrorStrings;
    (function (ErrorStrings) {
        ErrorStrings["TemplateError"] = "<b>There is something wrong with template. Please check logs.</b>";
    })(ErrorStrings || (ErrorStrings = {}));
    var IntervalUnits;
    (function (IntervalUnits) {
        IntervalUnits["day"] = "day";
        IntervalUnits["week"] = "week";
        IntervalUnits["month"] = "month";
        IntervalUnits["year"] = "year";
    })(IntervalUnits || (IntervalUnits = {}));
    var QuestionType;
    (function (QuestionType) {
        QuestionType["Text"] = "Text";
        QuestionType["Email"] = "Email";
        QuestionType["Radio"] = "Radio";
        QuestionType["MultiSelect"] = "MultiSelect";
        QuestionType["Select"] = "Select";
        QuestionType["Date"] = "Date";
        QuestionType["PhoneNumber"] = "PhoneNumber";
        QuestionType["CreditCard"] = "CreditCard";
        QuestionType["Number"] = "Number";
        QuestionType["MultiLineText"] = "multiLineText";
    })(QuestionType || (QuestionType = {}));
    var QuestionValidation;
    (function (QuestionValidation) {
        QuestionValidation["Required"] = "required";
    })(QuestionValidation || (QuestionValidation = {}));
    var QuestionField;
    (function (QuestionField) {
        QuestionField["Question"] = "question";
        QuestionField["Placeholder"] = "placeholder";
        QuestionField["Options"] = "options";
    })(QuestionField || (QuestionField = {}));
    var ModelKind;
    (function (ModelKind) {
        ModelKind["WebConsentModel"] = "WebConsentModel";
        ModelKind["QuestionModel"] = "DSRSubmissionModel";
    })(ModelKind || (ModelKind = {}));
    var Template;
    (function (Template) {
        Template["Preferences"] = "Preferences";
    })(Template || (Template = {}));

    var ObjectUtils = /** @class */ (function () {
        function ObjectUtils() {
        }
        ObjectUtils.isObject = function (item) {
            return item && typeof item === 'object' && !Array.isArray(item);
        };
        ObjectUtils.mergeDeep = function (target) {
            var _a, _b;
            var sources = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                sources[_i - 1] = arguments[_i];
            }
            if (!sources.length)
                return target;
            var source = sources.shift();
            if (this.isObject(target) && this.isObject(source)) {
                for (var key in source) {
                    if (this.isObject(source[key])) {
                        if (!target[key])
                            Object.assign(target, (_a = {}, _a[key] = {}, _a));
                        this.mergeDeep(target[key], source[key]);
                    }
                    else {
                        Object.assign(target, (_b = {}, _b[key] = source[key], _b));
                    }
                }
            }
            return this.mergeDeep.apply(this, __spreadArray([target], __read(sources), false));
        };
        return ObjectUtils;
    }());

    var SDKModules;
    (function (SDKModules) {
        SDKModules["PRESENTATION"] = "presentation";
        SDKModules["PREVIEW"] = "preview";
        SDKModules["CONFIG"] = "config";
        SDKModules["HANDLEBAR"] = "handlebar";
        SDKModules["PROXY"] = "proxy";
        SDKModules["DSR"] = "dsr";
    })(SDKModules || (SDKModules = {}));
    var SDKModulesPath;
    (function (SDKModulesPath) {
        SDKModulesPath["PRESENTATION"] = "$jsRootPath/msft-privacy/js/presentation.min.js";
        SDKModulesPath["PREVIEW"] = "$jsRootPath/msft-privacy/js/preview.min.js";
        SDKModulesPath["HANDLEBAR"] = "$jsRootPath/msft-privacy/js/vendor/handlebars.min.js";
        SDKModulesPath["PROXY"] = "$jsRootPath/msft-privacy/js/proxy.min.js";
        SDKModulesPath["DSR"] = "$jsRootPath/msft-privacy/js/dsr.min.js";
    })(SDKModulesPath || (SDKModulesPath = {}));
    var SDKModulesSourceVariable;
    (function (SDKModulesSourceVariable) {
        SDKModulesSourceVariable["PRESENTATION"] = "msft-presentation.js";
        SDKModulesSourceVariable["HANDLEBAR"] = "msft-handlebars.js";
        SDKModulesSourceVariable["PROXY"] = "msft-proxy.js";
        SDKModulesSourceVariable["DSR"] = "dsr.js";
    })(SDKModulesSourceVariable || (SDKModulesSourceVariable = {}));
    var ModuleSourceType;
    (function (ModuleSourceType) {
        ModuleSourceType["PATH"] = "path";
        ModuleSourceType["VARIABLE"] = "variable";
    })(ModuleSourceType || (ModuleSourceType = {}));

    var State = /** @class */ (function () {
        function State(state) {
            this.state = state || {
                config: {},
                debug: {
                    logs: [],
                    events: [],
                },
                custom: {},
            };
        }
        return State;
    }());

    var Getters = /** @class */ (function (_super) {
        __extends(Getters, _super);
        function Getters(state) {
            return _super.call(this, state) || this;
        }
        Object.defineProperty(Getters.prototype, "debugInfo", {
            get: function () {
                return this.state.debug;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "config", {
            get: function () {
                return this.state.config;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "userConsent", {
            get: function () {
                return this.state.custom.userConsent;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "isHeadless", {
            // TODO: Implement below getters
            get: function () {
                return false;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "isPreviewMode", {
            get: function () {
                var _a;
                return ((_a = this.state.config.initConfig) === null || _a === void 0 ? void 0 : _a.preview) || false;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "isActionDisabled", {
            get: function () {
                var _a;
                return ((_a = this.state.config.initConfig) === null || _a === void 0 ? void 0 : _a.disableActions) || false;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "isLivePreviewMode", {
            get: function () {
                var _a;
                return ((_a = window.parent) === null || _a === void 0 ? void 0 : _a.name) === 'ConsentLivePreview';
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "presentationVariable", {
            get: function () {
                return SDKModulesSourceVariable.PRESENTATION;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "handlebarVariable", {
            get: function () {
                return SDKModulesSourceVariable.HANDLEBAR;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "proxyVariable", {
            get: function () {
                return SDKModulesSourceVariable.PROXY;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(Getters.prototype, "dsrVariable", {
            get: function () {
                return SDKModulesSourceVariable.DSR;
            },
            enumerable: false,
            configurable: true
        });
        return Getters;
    }(State));

    var Reducers = /** @class */ (function (_super) {
        __extends(Reducers, _super);
        function Reducers(state) {
            return _super.call(this, state) || this;
        }
        Reducers.prototype.saveDebugInfo = function (_a) {
            var event = _a.event, log = _a.log;
            if (event) {
                this.state.debug.events.push(event);
            }
            if (log) {
                this.state.debug.logs.push(log);
            }
        };
        Reducers.prototype.setUserConsent = function (consent) {
            this.state.custom.userConsent = consent;
        };
        Reducers.prototype.setInitConfig = function (initConfig) {
            this.state.config.initConfig = initConfig;
        };
        return Reducers;
    }(State));

    var state = new State().state;
    var getter = new Getters(state);
    var reducer = new Reducers(state);
    var Store = {
        getters: getter,
        reducers: reducer,
        addReducers: function (reducers) {
            this.reducers = ObjectUtils.mergeDeep(this.reducers, reducers);
        },
        addGetters: function (getters) {
            Object.defineProperties(this.getters, Object.getOwnPropertyDescriptors(getters.prototype));
        },
    };

    var LogLevels;
    (function (LogLevels) {
        LogLevels[LogLevels["INFO"] = 0] = "INFO";
        LogLevels[LogLevels["WARN"] = 1] = "WARN";
        LogLevels[LogLevels["ERROR"] = 2] = "ERROR";
    })(LogLevels || (LogLevels = {}));

    var ConsoleLogger = /** @class */ (function () {
        function ConsoleLogger() {
        }
        /**
         * Browser's console logger plugin.
         *
         * @param {LogLevels} level Log level
         * @param {string} message Log message
         */
        ConsoleLogger.log = function (level, message) {
            switch (level) {
                case LogLevels.WARN:
                    console.warn(message);
                    break;
                case LogLevels.ERROR:
                    console.error(message);
                    break;
                default:
                    {
                        console.log(message);
                    }
                    break;
            }
        };
        return ConsoleLogger;
    }());

    /**
     * @typedef {import("core/types/interfaces").IGenericObject} IGenericObject
     */
    var Logger = /** @class */ (function () {
        function Logger() {
        }
        /**
         * Info logs
         *
         * @param {string} message Logger message
         * @param {IGenericObject} data Additional details to log
         */
        Logger.info = function (message, data) {
            Logger.log(LogLevels.INFO, message, data);
        };
        /**
         * Warning logs
         *
         * @param {string} message Logger message
         * @param {IGenericObject} data Additional details to log
         */
        Logger.warn = function (message, data) {
            Logger.log(LogLevels.WARN, message, data);
        };
        /**
         * Error logs
         *
         * @param {string} message Logger message
         * @param {IGenericObject} data Additional details to log
         */
        Logger.error = function (message, data) {
            Logger.log(LogLevels.ERROR, message, data);
        };
        /**
         * Logs the message using the plugin based in level.
         *
         * @param {LogLevels} logLevel Log level
         * @param {string} message Logger message
         * @param {IGenericObject} data Additional details to log
         */
        Logger.log = function (logLevel, message, data) {
            var formattedMessage = Logger.formatLogMessage(logLevel, message, data);
            Store.reducers.saveDebugInfo({ log: formattedMessage });
            ConsoleLogger.log(logLevel, formattedMessage);
        };
        /**
         * Formats the logger message.
         *
         * @param {LogLevels} logLevel Log level
         * @param {string} message Logger message
         * @param {IGenericObject} data Additional details to log
         * @returns {string} Formatted logger message
         */
        Logger.formatLogMessage = function (logLevel, message, data) {
            var stringifiedData = data ? "| ".concat(JSON.stringify(data)) : '';
            return "[".concat(LogLevels[logLevel], "] ").concat(message, " ").concat(stringifiedData);
        };
        return Logger;
    }());

    var TemplateHandler = /** @class */ (function () {
        function TemplateHandler() {
            TemplateHandler.registerShowTemplateHandlers();
        }
        /**
         * Register event handlers to open/close different templates
         */
        TemplateHandler.registerShowTemplateHandlers = function () {
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowConsentNotice, TemplateHandler.showFirstPage);
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice, TemplateHandler.hideConsentNotice);
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.Init, TemplateHandler.saveStylesOnInit);
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowTemplate, TemplateHandler.showTemplate);
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseTemplate, TemplateHandler.closeTemplate);
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.ConfigReady, TemplateHandler.init);
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowPreferences, TemplateHandler.showPreferences);
        };
        TemplateHandler.showPreferences = function () {
            try {
                TemplateHandler.showTemplate({ templateId: Template.Preferences });
            }
            catch (e) {
                TemplateHandler.showFirstPage();
            }
        };
        /**
         * Show template
         *
         * @param  {import("core/types/interfaces").IGenericObject} payload payload data
         */
        TemplateHandler.showTemplate = function (_a) {
            var templateId = _a.templateId;
            if (window.__MSFT_SDK.Store.getters.components &&
                window.__MSFT_SDK.Store.getters.components[templateId]) {
                var consentModel = window.__MSFT_SDK.Store.getters.currentModel;
                TemplateHandler.showTemplateInIFrame(window.__MSFT_SDK.Store.getters.components[templateId], templateId, [
                    {
                        type: StyleType.Text,
                        value: (consentModel === null || consentModel === void 0 ? void 0 : consentModel.layouts[0].css) || '',
                    },
                ], TemplateHandler.getParentElement(templateId));
            }
            else {
                throw new Error("Template : ".concat(templateId, " not found."));
            }
        };
        /**
         * Hide template
         *
         * @param  {import("core/types/interfaces").IGenericObject} payload payload data
         */
        TemplateHandler.closeTemplate = function (_a) {
            var templateId = _a.templateId;
            TemplateHandler.closeIFrame(templateId);
        };
        /**
         * Save styles passed by user in window.__MSFT_SDK.Store
         *
         * @param  {import("core/types/interfaces").IInitConfig} config init config
         */
        TemplateHandler.saveStylesOnInit = function (config) {
            if (config.styles) {
                window.__MSFT_SDK.Logger.info('user provided styles persisted to window.__MSFT_SDK.Store.');
                window.__MSFT_SDK.Store.reducers.setStyles(config.styles);
            }
        };
        TemplateHandler.getTemplateData = function (consentModel) {
            var groupedTranslations = window.__MSFT_SDK.Store.getters.translations;
            var modelName = consentModel.name;
            var data = {};
            data[NoticeType.TrackerCategory] = [];
            var trackerCategories = new Set();
            var addTrackerCategories = new Set();
            if (consentModel.kind === ModelKind.WebConsentModel) {
                consentModel.trackerCategories.forEach(function (category) {
                    trackerCategories.add(category.categoryName);
                });
            }
            else if (consentModel.kind === ModelKind.QuestionModel) {
                data.captcha = consentModel.captcha;
            }
            groupedTranslations.forEach(function (groupedTranslation) {
                return Object.keys(groupedTranslation).forEach(function (namespace) {
                    var _a;
                    if (namespace === modelName) {
                        data = __assign(__assign({}, data), groupedTranslation[namespace]);
                    }
                    else if (consentModel.kind === ModelKind.QuestionModel) {
                        data = __assign(__assign({}, data), (_a = {}, _a[namespace] = groupedTranslation[namespace], _a));
                    }
                    else if (trackerCategories.has(namespace) &&
                        !addTrackerCategories.has(namespace)) {
                        var categoryTranslation = __assign(__assign({}, groupedTranslation[namespace]), { name: namespace });
                        data[NoticeType.TrackerCategory].push(categoryTranslation);
                        addTrackerCategories.add(namespace);
                    }
                });
            });
            data['msft-script-open'] = '<script>';
            data['msft-script-close'] = '</script>';
            Logger.info('getTemplate data invoked', { consentModel: consentModel, data: data });
            return __assign(__assign({}, data), window.__MSFT_SDK.Store.getters.templateData);
        };
        /**
         * Perform all necessary steps like replacing placeholders in
         * templates during init.
         */
        TemplateHandler.init = function () {
            if (window.__MSFT_SDK.Store.getters.currentModel === undefined ||
                window.__MSFT_SDK.Store.getters.template === undefined) {
                window.__MSFT_SDK.Logger.warn('Cannot call init before config is ready.');
                return;
            }
            var consentModel = window.__MSFT_SDK.Store.getters.currentModel;
            var template = window.__MSFT_SDK.Store.getters.template;
            var data = TemplateHandler.getTemplateData(consentModel);
            template.pages.forEach(function (page) {
                var _a;
                var templateString;
                try {
                    var template_1 = window.Handlebars.compile(page.content.replaceAll('{{{questions}}}', data.questions));
                    templateString = template_1(data);
                }
                catch (e) {
                    window.__MSFT_SDK.Logger.error(e.message, e);
                    templateString = ErrorStrings.TemplateError;
                }
                window.__MSFT_SDK.Store.reducers.setComponents(__assign(__assign({}, window.__MSFT_SDK.Store.getters.components), (_a = {}, _a[page.name] = templateString, _a)));
            });
            window.__MSFT_SDK.Logger.info('Components updated');
            TemplateHandler.initialized = true;
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowFirstPage, TemplateHandler.showFirstPage);
        };
        /**
         * Show Consent notice template
         */
        TemplateHandler.showFirstPage = function () {
            var _a, _b;
            if (!TemplateHandler.initialized) {
                TemplateHandler.init();
            }
            var consentModel = window.__MSFT_SDK.Store.getters.currentModel;
            if (consentModel === undefined) {
                window.__MSFT_SDK.Logger.warn('Cannot call init before consent model is selected.');
                return;
            }
            var mode = consentModel.layouts[0].mode;
            var initComponent = (_b = (_a = window.__MSFT_SDK.Store.getters.template) === null || _a === void 0 ? void 0 : _a.modes.find(function (m) { return m.name === mode; })) === null || _b === void 0 ? void 0 : _b.initPage;
            if (window.__MSFT_SDK.Store.getters.components === undefined ||
                initComponent === undefined ||
                window.__MSFT_SDK.Store.getters.components[initComponent] === undefined) {
                window.__MSFT_SDK.Logger.error('Notice template not found.');
                return;
            }
            var template = window.__MSFT_SDK.Store.getters.components[initComponent];
            TemplateHandler.showTemplateInIFrame(template, initComponent, [
                {
                    type: StyleType.Text,
                    value: consentModel.layouts[0].css || '',
                },
            ], TemplateHandler.getParentElement(initComponent));
        };
        TemplateHandler.getParentElement = function (templateId) {
            var _a;
            var parentElementId = (((_a = window.__MSFT_SDK.Store.getters.config.initConfig) === null || _a === void 0 ? void 0 : _a.componentParentMap) ||
                window.__MSFT_SDK.Store.getters.templateParentMap)[templateId];
            if (parentElementId) {
                return document.getElementById(parentElementId);
            }
            return null;
        };
        /**
         * Adds template to iframe and append it to dom
         *
         * @param  {string} template template to add
         * @param  {string} iframeId iframe id
         * @param  {IStyle[]} styles styles
         * @param  {HTMLElement|null} parentElement if iframe should be added to a specific element instead of body
         */
        TemplateHandler.showTemplateInIFrame = function (template, iframeId, styles, parentElement) {
            if (styles === void 0) { styles = []; }
            var iframeElement = document.getElementById(iframeId);
            if (iframeElement) {
                Logger.info("Template: ".concat(iframeId, " is already open."));
            }
            else {
                if (template === ErrorStrings.TemplateError &&
                    (!window.__MSFT_SDK.Store.getters.isLivePreviewMode ||
                        !window.__MSFT_SDK.Store.getters.isPreviewMode)) {
                    return;
                }
                var data = {
                    origin: window.origin,
                };
                template =
                    "<script>var msftData = ".concat(JSON.stringify(data), "</script>") +
                        "<script>".concat(window.__MSFT_SDK.Store.getters.proxyJS, "</script>") +
                        template;
                window.__MSFT_SDK.Utils.IFrameUtils.createIFrame(template, iframeId, parentElement, __spreadArray(__spreadArray([], __read(styles), false), __read((window.__MSFT_SDK.Store.getters.styles || [])), false));
            }
        };
        /**
         * Hide consent notice iframe
         */
        TemplateHandler.hideConsentNotice = function () {
            var _a, _b;
            var consentModel = window.__MSFT_SDK.Store.getters.currentModel;
            if (consentModel === undefined) {
                window.__MSFT_SDK.Logger.warn('Cannot call hideConsentNotice before consent model is selected.');
                return;
            }
            var mode = consentModel.layouts[0].mode;
            var initComponent = (_b = (_a = window.__MSFT_SDK.Store.getters.template) === null || _a === void 0 ? void 0 : _a.modes.find(function (m) { return m.name === mode; })) === null || _b === void 0 ? void 0 : _b.initPage;
            initComponent && TemplateHandler.closeIFrame(initComponent);
        };
        /**
         * Set iframe display to none
         *
         * @param  {string} iframeId id of iframe element
         */
        TemplateHandler.closeIFrame = function (iframeId) {
            var _a;
            var iframeElement = document.getElementById(iframeId);
            (_a = iframeElement === null || iframeElement === void 0 ? void 0 : iframeElement.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(iframeElement);
        };
        TemplateHandler.initialized = false;
        return TemplateHandler;
    }());

    window.onmessage = function (e) {
        var _a;
        var _b;
        if (e.origin === 'null') {
            if (window.__MSFT_SDK.Store.getters.isActionDisabled &&
                e.data.method === 'trigger') {
                return;
            }
            var response = (_a = window.MSFTConsent)[e.data.method].apply(_a, __spreadArray([], __read(e.data.params), false));
            if (e.data.responseId) {
                (_b = e.source) === null || _b === void 0 ? void 0 : _b.postMessage(__assign(__assign({}, e.data), { response: response }), { targetOrigin: '*' });
            }
        }
    };
    window.__MSFT_SDK.EventBus.on(PublicEvents.AnchorTagClicked, function (_a) {
        var attributes = _a.attributes;
        var aTag = document.createElement('a');
        Object.keys(attributes).forEach(function (attrName) {
            aTag.setAttribute(attrName, attributes[attrName]);
        });
        aTag.click();
    });
    new TemplateHandler();

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJlc2VudGF0aW9uLm1pbi5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIi4uLy4uLy4uLy4uLy4uL1NESy9zcmMvY29yZS9jb25zdGFudHMvZW51bXMudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL2NvcmUvdXRpbHMvT2JqZWN0VXRpbHMudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL2NvcmUvZGVwZW5kZW5jeU1hbmFnZXIvZW51bS9tb2R1bGVzLnRzIiwiLi4vLi4vLi4vLi4vLi4vU0RLL3NyYy9jb3JlL3N0b3JlL1N0YXRlLnRzIiwiLi4vLi4vLi4vLi4vLi4vU0RLL3NyYy9jb3JlL3N0b3JlL0dldHRlcnMudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL2NvcmUvc3RvcmUvUmVkdWNlcnMudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL2NvcmUvc3RvcmUvaW5kZXgudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL2NvcmUvbG9nZ2VyL2VudW0udHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL2NvcmUvbG9nZ2VyL3BsdWdpbnMvQ29uc29sZUxvZ2dlci50cyIsIi4uLy4uLy4uLy4uLy4uL1NESy9zcmMvY29yZS9sb2dnZXIvaW5kZXgudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3ByZXNlbnRhdGlvbi9UZW1wbGF0ZUhhbmRsZXIudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3ByZXNlbnRhdGlvbi9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcclxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcclxuICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XHJcbiAgICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkgX19jcmVhdGVCaW5kaW5nKG8sIG0sIHApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tLCBwYWNrKSB7XHJcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcclxuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcclxuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XHJcbn0pIDogZnVuY3Rpb24obywgdikge1xyXG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XHJcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgZ2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZFNldChyZWNlaXZlciwgc3RhdGUsIHZhbHVlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJtXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIG1ldGhvZCBpcyBub3Qgd3JpdGFibGVcIik7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB3cml0ZSBwcml2YXRlIG1lbWJlciB0byBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIChraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlciwgdmFsdWUpIDogZiA/IGYudmFsdWUgPSB2YWx1ZSA6IHN0YXRlLnNldChyZWNlaXZlciwgdmFsdWUpKSwgdmFsdWU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkSW4oc3RhdGUsIHJlY2VpdmVyKSB7XHJcbiAgICBpZiAocmVjZWl2ZXIgPT09IG51bGwgfHwgKHR5cGVvZiByZWNlaXZlciAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcmVjZWl2ZXIgIT09IFwiZnVuY3Rpb25cIikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgdXNlICdpbicgb3BlcmF0b3Igb24gbm9uLW9iamVjdFwiKTtcclxuICAgIHJldHVybiB0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyID09PSBzdGF0ZSA6IHN0YXRlLmhhcyhyZWNlaXZlcik7XHJcbn1cclxuIiwiZXhwb3J0IGVudW0gQ29uc2VudE1vZGVsVHlwZSB7XHJcbiAgRXhwbGljaXQgPSAnRXhwbGljaXQnLFxyXG4gIEltcGxpY2l0ID0gJ0ltcGxpY2l0JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUHVibGljRXZlbnRzIHtcclxuICBDb25zZW50Q2hhbmdlZCA9ICdDb25zZW50Q2hhbmdlZCcsXHJcbiAgU2hvd0NvbnNlbnROb3RpY2UgPSAnU2hvd0NvbnNlbnROb3RpY2UnLFxyXG4gIFNob3dGaXJzdFBhZ2UgPSAnU2hvd0ZpcnN0UGFnZScsXHJcbiAgQ2xvc2VDb25zZW50Tm90aWNlID0gJ0Nsb3NlQ29uc2VudE5vdGljZScsXHJcbiAgQWNjZXB0QWxsID0gJ0FjY2VwdEFsbCcsXHJcbiAgUmVqZWN0QWxsID0gJ1JlamVjdEFsbCcsXHJcbiAgU2hvd1RlbXBsYXRlID0gJ1Nob3dUZW1wbGF0ZScsXHJcbiAgQ2xvc2VUZW1wbGF0ZSA9ICdDbG9zZVRlbXBsYXRlJyxcclxuICBVcGRhdGVDb25zZW50ID0gJ1VwZGF0ZUNvbnNlbnQnLFxyXG4gIEFuY2hvclRhZ0NsaWNrZWQgPSAnQW5jaG9yVGFnQ2xpY2tlZCcsXHJcbiAgRmV0Y2hDb25maWcgPSAnRmV0Y2hDb25maWcnLFxyXG4gIFF1ZXN0aW9uc0Zvcm1TdWJtaXRXaXRob3V0TWV0YURhdGEgPSAnUXVlc3Rpb25zRm9ybVN1Ym1pdFdpdGhvdXRNZXRhRGF0YScsXHJcbiAgUXVlc3Rpb25zRm9ybVN1Ym1pdCA9ICdRdWVzdGlvbnNGb3JtU3VibWl0JyxcclxuICBTaG93UHJlZmVyZW5jZXMgPSAnU2hvd1ByZWZlcmVuY2VzJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gRXZlbnRzIHtcclxuICBJbml0ID0gJ0luaXQnLFxyXG4gIENvcmVDb25zZW50TW9kZWxTZWxlY3RlZCA9ICdDb3JlQ29uc2VudE1vZGVsU2VsZWN0ZWQnLFxyXG4gIENvbmZpZ1JlYWR5ID0gJ0NvbmZpZ1JlYWR5JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gU0RLTW9kZSB7XHJcbiAgRGVmYXVsdCA9ICdEZWZhdWx0JyxcclxuICBIZWFkTGVzcyA9ICdIZWFkTGVzcycsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFN0eWxlVHlwZSB7XHJcbiAgVXJsID0gJ1VybCcsXHJcbiAgVGV4dCA9ICdUZXh0JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUHJlZmVyZW5jZSB7XHJcbiAgT0ZGID0gJzAnLFxyXG4gIE9OID0gJzEnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBDb29raWUge1xyXG4gIENvbnNlbnQgPSAnbXNmdC1jb25zZW50JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUmVnaXN0ZXJlZERpdlR5cGUge1xyXG4gIFNjcmlwdCA9ICdzY3JpcHQnLFxyXG4gIElGcmFtZSA9ICdpZnJhbWUnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBOb3RpY2VUeXBlIHtcclxuICBUcmFja2VyQ2F0ZWdvcnkgPSAndHJhY2tlckNhdGVnb3J5JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gRXJyb3JTdHJpbmdzIHtcclxuICBUZW1wbGF0ZUVycm9yID0gJzxiPlRoZXJlIGlzIHNvbWV0aGluZyB3cm9uZyB3aXRoIHRlbXBsYXRlLiBQbGVhc2UgY2hlY2sgbG9ncy48L2I+JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gSW50ZXJ2YWxVbml0cyB7XHJcbiAgZGF5ID0gJ2RheScsXHJcbiAgd2VlayA9ICd3ZWVrJyxcclxuICBtb250aCA9ICdtb250aCcsXHJcbiAgeWVhciA9ICd5ZWFyJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUXVlc3Rpb25UeXBlIHtcclxuICBUZXh0ID0gJ1RleHQnLFxyXG4gIEVtYWlsID0gJ0VtYWlsJyxcclxuICBSYWRpbyA9ICdSYWRpbycsXHJcbiAgTXVsdGlTZWxlY3QgPSAnTXVsdGlTZWxlY3QnLFxyXG4gIFNlbGVjdCA9ICdTZWxlY3QnLFxyXG4gIERhdGUgPSAnRGF0ZScsXHJcbiAgUGhvbmVOdW1iZXIgPSAnUGhvbmVOdW1iZXInLFxyXG4gIENyZWRpdENhcmQgPSAnQ3JlZGl0Q2FyZCcsXHJcbiAgTnVtYmVyID0gJ051bWJlcicsXHJcbiAgTXVsdGlMaW5lVGV4dCA9ICdtdWx0aUxpbmVUZXh0JyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUXVlc3Rpb25WYWxpZGF0aW9uIHtcclxuICBSZXF1aXJlZCA9ICdyZXF1aXJlZCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFF1ZXN0aW9uRmllbGQge1xyXG4gIFF1ZXN0aW9uID0gJ3F1ZXN0aW9uJyxcclxuICBQbGFjZWhvbGRlciA9ICdwbGFjZWhvbGRlcicsXHJcbiAgT3B0aW9ucyA9ICdvcHRpb25zJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gTW9kZWxLaW5kIHtcclxuICBXZWJDb25zZW50TW9kZWwgPSAnV2ViQ29uc2VudE1vZGVsJyxcclxuICBRdWVzdGlvbk1vZGVsID0gJ0RTUlN1Ym1pc3Npb25Nb2RlbCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFRlbXBsYXRlIHtcclxuICBQcmVmZXJlbmNlcyA9ICdQcmVmZXJlbmNlcycsXHJcbn1cclxuIiwiY2xhc3MgT2JqZWN0VXRpbHMge1xyXG4gIHB1YmxpYyBzdGF0aWMgaXNPYmplY3QoaXRlbTogYW55KSB7XHJcbiAgICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkoaXRlbSk7XHJcbiAgfVxyXG4gIHB1YmxpYyBzdGF0aWMgbWVyZ2VEZWVwKHRhcmdldDogYW55LCAuLi5zb3VyY2VzOiBhbnkpOiBhbnkge1xyXG4gICAgaWYgKCFzb3VyY2VzLmxlbmd0aCkgcmV0dXJuIHRhcmdldDtcclxuICAgIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuc2hpZnQoKTtcclxuXHJcbiAgICBpZiAodGhpcy5pc09iamVjdCh0YXJnZXQpICYmIHRoaXMuaXNPYmplY3Qoc291cmNlKSkge1xyXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBzb3VyY2UpIHtcclxuICAgICAgICBpZiAodGhpcy5pc09iamVjdChzb3VyY2Vba2V5XSkpIHtcclxuICAgICAgICAgIGlmICghdGFyZ2V0W2tleV0pIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7IFtrZXldOiB7fSB9KTtcclxuICAgICAgICAgIHRoaXMubWVyZ2VEZWVwKHRhcmdldFtrZXldLCBzb3VyY2Vba2V5XSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7IFtrZXldOiBzb3VyY2Vba2V5XSB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLm1lcmdlRGVlcCh0YXJnZXQsIC4uLnNvdXJjZXMpO1xyXG4gIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBPYmplY3RVdGlscztcclxuIiwiZXhwb3J0IGVudW0gU0RLTW9kdWxlcyB7XHJcbiAgUFJFU0VOVEFUSU9OID0gJ3ByZXNlbnRhdGlvbicsXHJcbiAgUFJFVklFVyA9ICdwcmV2aWV3JyxcclxuICBDT05GSUcgPSAnY29uZmlnJyxcclxuICBIQU5ETEVCQVIgPSAnaGFuZGxlYmFyJyxcclxuICBQUk9YWSA9ICdwcm94eScsXHJcbiAgRFNSID0gJ2RzcicsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFNES01vZHVsZXNQYXRoIHtcclxuICBQUkVTRU5UQVRJT04gPSAnJGpzUm9vdFBhdGgvbXNmdC1wcml2YWN5L2pzL3ByZXNlbnRhdGlvbi5taW4uanMnLFxyXG4gIFBSRVZJRVcgPSAnJGpzUm9vdFBhdGgvbXNmdC1wcml2YWN5L2pzL3ByZXZpZXcubWluLmpzJyxcclxuICBIQU5ETEVCQVIgPSAnJGpzUm9vdFBhdGgvbXNmdC1wcml2YWN5L2pzL3ZlbmRvci9oYW5kbGViYXJzLm1pbi5qcycsXHJcbiAgUFJPWFkgPSAnJGpzUm9vdFBhdGgvbXNmdC1wcml2YWN5L2pzL3Byb3h5Lm1pbi5qcycsXHJcbiAgRFNSID0gJyRqc1Jvb3RQYXRoL21zZnQtcHJpdmFjeS9qcy9kc3IubWluLmpzJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gU0RLTW9kdWxlc1NvdXJjZVZhcmlhYmxlIHtcclxuICBQUkVTRU5UQVRJT04gPSAnbXNmdC1wcmVzZW50YXRpb24uanMnLFxyXG4gIEhBTkRMRUJBUiA9ICdtc2Z0LWhhbmRsZWJhcnMuanMnLFxyXG4gIFBST1hZID0gJ21zZnQtcHJveHkuanMnLFxyXG4gIERTUiA9ICdkc3IuanMnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBNb2R1bGVTb3VyY2VUeXBlIHtcclxuICBQQVRIID0gJ3BhdGgnLFxyXG4gIFZBUklBQkxFID0gJ3ZhcmlhYmxlJyxcclxufVxyXG4iLCJpbXBvcnQgeyBJU3RhdGUgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmNsYXNzIFN0YXRlIHtcclxuICBwdWJsaWMgc3RhdGU6IElTdGF0ZTtcclxuXHJcbiAgY29uc3RydWN0b3Ioc3RhdGU/OiBJU3RhdGUpIHtcclxuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZSB8fCB7XHJcbiAgICAgIGNvbmZpZzoge30sXHJcbiAgICAgIGRlYnVnOiB7XHJcbiAgICAgICAgbG9nczogW10sXHJcbiAgICAgICAgZXZlbnRzOiBbXSxcclxuICAgICAgfSxcclxuICAgICAgY3VzdG9tOiB7fSxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFN0YXRlO1xyXG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzICovXHJcbmltcG9ydCB7IFNES01vZHVsZXNTb3VyY2VWYXJpYWJsZSB9IGZyb20gJ2NvcmUvZGVwZW5kZW5jeU1hbmFnZXIvZW51bS9tb2R1bGVzJztcclxuaW1wb3J0IFN0YXRlIGZyb20gJy4vU3RhdGUnO1xyXG5pbXBvcnQgeyBJQ29uZmlnU3RhdGUsIElEZWJ1Z1N0YXRlLCBJU3RhdGUgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbmludGVyZmFjZSBHZXR0ZXJzIGV4dGVuZHMgSVN0b3JlLklHZXR0ZXIge1xyXG4gIFt4OiBzdHJpbmddOiBhbnk7XHJcbn1cclxuY2xhc3MgR2V0dGVycyBleHRlbmRzIFN0YXRlIHtcclxuICBjb25zdHJ1Y3RvcihzdGF0ZTogSVN0YXRlKSB7XHJcbiAgICBzdXBlcihzdGF0ZSk7XHJcbiAgfVxyXG4gIGdldCBkZWJ1Z0luZm8oKTogSURlYnVnU3RhdGUge1xyXG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuZGVidWc7XHJcbiAgfVxyXG5cclxuICBnZXQgY29uZmlnKCk6IElDb25maWdTdGF0ZSB7XHJcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5jb25maWc7XHJcbiAgfVxyXG4gIGdldCB1c2VyQ29uc2VudCgpOiBJVXNlckNvbnNlbnQge1xyXG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuY3VzdG9tLnVzZXJDb25zZW50O1xyXG4gIH1cclxuXHJcbiAgLy8gVE9ETzogSW1wbGVtZW50IGJlbG93IGdldHRlcnNcclxuICBnZXQgaXNIZWFkbGVzcygpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIGdldCBpc1ByZXZpZXdNb2RlKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuY29uZmlnLmluaXRDb25maWc/LnByZXZpZXcgfHwgZmFsc2U7XHJcbiAgfVxyXG5cclxuICBnZXQgaXNBY3Rpb25EaXNhYmxlZCgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLnN0YXRlLmNvbmZpZy5pbml0Q29uZmlnPy5kaXNhYmxlQWN0aW9ucyB8fCBmYWxzZTtcclxuICB9XHJcblxyXG4gIGdldCBpc0xpdmVQcmV2aWV3TW9kZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB3aW5kb3cucGFyZW50Py5uYW1lID09PSAnQ29uc2VudExpdmVQcmV2aWV3JztcclxuICB9XHJcblxyXG4gIGdldCBwcmVzZW50YXRpb25WYXJpYWJsZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIFNES01vZHVsZXNTb3VyY2VWYXJpYWJsZS5QUkVTRU5UQVRJT047XHJcbiAgfVxyXG5cclxuICBnZXQgaGFuZGxlYmFyVmFyaWFibGUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBTREtNb2R1bGVzU291cmNlVmFyaWFibGUuSEFORExFQkFSO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHByb3h5VmFyaWFibGUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBTREtNb2R1bGVzU291cmNlVmFyaWFibGUuUFJPWFk7XHJcbiAgfVxyXG5cclxuICBnZXQgZHNyVmFyaWFibGUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBTREtNb2R1bGVzU291cmNlVmFyaWFibGUuRFNSO1xyXG4gIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBHZXR0ZXJzO1xyXG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzICovXHJcbmltcG9ydCBTdGF0ZSBmcm9tICcuL1N0YXRlJztcclxuaW1wb3J0IHsgSVN0YXRlIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG5pbnRlcmZhY2UgUmVkdWNlcnMgZXh0ZW5kcyBJU3RvcmUuSVJlZHVjZXIge1xyXG4gIFt4OiBzdHJpbmddOiBhbnk7XHJcbn1cclxuY2xhc3MgUmVkdWNlcnMgZXh0ZW5kcyBTdGF0ZSB7XHJcbiAgY29uc3RydWN0b3Ioc3RhdGU6IElTdGF0ZSkge1xyXG4gICAgc3VwZXIoc3RhdGUpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNhdmVEZWJ1Z0luZm8oeyBldmVudCwgbG9nIH06IHsgZXZlbnQ/OiBzdHJpbmc7IGxvZz86IHN0cmluZyB9KSB7XHJcbiAgICBpZiAoZXZlbnQpIHtcclxuICAgICAgdGhpcy5zdGF0ZS5kZWJ1Zy5ldmVudHMucHVzaChldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGxvZykge1xyXG4gICAgICB0aGlzLnN0YXRlLmRlYnVnLmxvZ3MucHVzaChsb2cpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldFVzZXJDb25zZW50KGNvbnNlbnQ6IElVc2VyQ29uc2VudCkge1xyXG4gICAgdGhpcy5zdGF0ZS5jdXN0b20udXNlckNvbnNlbnQgPSBjb25zZW50O1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldEluaXRDb25maWcoaW5pdENvbmZpZzogSUluaXRDb25maWcpIHtcclxuICAgIHRoaXMuc3RhdGUuY29uZmlnLmluaXRDb25maWcgPSBpbml0Q29uZmlnO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVkdWNlcnM7XHJcbiIsImltcG9ydCBPYmplY3RVdGlscyBmcm9tICcuLi91dGlscy9PYmplY3RVdGlscyc7XHJcbmltcG9ydCBHZXR0ZXJzIGZyb20gJy4vR2V0dGVycyc7XHJcbmltcG9ydCBSZWR1Y2VycyBmcm9tICcuL1JlZHVjZXJzJztcclxuaW1wb3J0IFN0YXRlIGZyb20gJy4vU3RhdGUnO1xyXG5cclxuY29uc3QgeyBzdGF0ZSB9ID0gbmV3IFN0YXRlKCk7XHJcbmNvbnN0IGdldHRlciA9IG5ldyBHZXR0ZXJzKHN0YXRlKTtcclxuY29uc3QgcmVkdWNlciA9IG5ldyBSZWR1Y2VycyhzdGF0ZSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgZ2V0dGVyczogZ2V0dGVyLFxyXG4gIHJlZHVjZXJzOiByZWR1Y2VyLFxyXG4gIGFkZFJlZHVjZXJzOiBmdW5jdGlvbiAocmVkdWNlcnM6IGFueSkge1xyXG4gICAgdGhpcy5yZWR1Y2VycyA9IE9iamVjdFV0aWxzLm1lcmdlRGVlcCh0aGlzLnJlZHVjZXJzLCByZWR1Y2Vycyk7XHJcbiAgfSxcclxuICBhZGRHZXR0ZXJzOiBmdW5jdGlvbiAoZ2V0dGVyczogYW55KSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhcclxuICAgICAgdGhpcy5nZXR0ZXJzLFxyXG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhnZXR0ZXJzLnByb3RvdHlwZSksXHJcbiAgICApO1xyXG4gIH0sXHJcbn07XHJcbiIsImV4cG9ydCBlbnVtIExvZ0xldmVscyB7XHJcbiAgSU5GTyxcclxuICBXQVJOLFxyXG4gIEVSUk9SLFxyXG59XHJcbiIsImltcG9ydCB7IExvZ0xldmVscyB9IGZyb20gJy4uL2VudW0nO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uc29sZUxvZ2dlciB7XHJcbiAgLyoqXHJcbiAgICogQnJvd3NlcidzIGNvbnNvbGUgbG9nZ2VyIHBsdWdpbi5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7TG9nTGV2ZWxzfSBsZXZlbCBMb2cgbGV2ZWxcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBMb2cgbWVzc2FnZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgbG9nKGxldmVsOiBMb2dMZXZlbHMsIG1lc3NhZ2U6IHN0cmluZykge1xyXG4gICAgc3dpdGNoIChsZXZlbCkge1xyXG4gICAgICBjYXNlIExvZ0xldmVscy5XQVJOOlxyXG4gICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBMb2dMZXZlbHMuRVJST1I6XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFN0b3JlIGZyb20gJy4uL3N0b3JlJztcclxuaW1wb3J0IHsgTG9nTGV2ZWxzIH0gZnJvbSAnLi9lbnVtJztcclxuaW1wb3J0IENvbnNvbGVMb2dnZXIgZnJvbSAnLi9wbHVnaW5zL0NvbnNvbGVMb2dnZXInO1xyXG5cclxuLyoqXHJcbiAqIEB0eXBlZGVmIHtpbXBvcnQoXCJjb3JlL3R5cGVzL2ludGVyZmFjZXNcIikuSUdlbmVyaWNPYmplY3R9IElHZW5lcmljT2JqZWN0XHJcbiAqL1xyXG5jbGFzcyBMb2dnZXIge1xyXG4gIC8qKlxyXG4gICAqIEluZm8gbG9nc1xyXG4gICAqXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgTG9nZ2VyIG1lc3NhZ2VcclxuICAgKiBAcGFyYW0ge0lHZW5lcmljT2JqZWN0fSBkYXRhIEFkZGl0aW9uYWwgZGV0YWlscyB0byBsb2dcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGluZm8obWVzc2FnZTogc3RyaW5nLCBkYXRhPzogSUdlbmVyaWNPYmplY3QpIHtcclxuICAgIExvZ2dlci5sb2coTG9nTGV2ZWxzLklORk8sIG1lc3NhZ2UsIGRhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2FybmluZyBsb2dzXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBMb2dnZXIgbWVzc2FnZVxyXG4gICAqIEBwYXJhbSB7SUdlbmVyaWNPYmplY3R9IGRhdGEgQWRkaXRpb25hbCBkZXRhaWxzIHRvIGxvZ1xyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgd2FybihtZXNzYWdlOiBzdHJpbmcsIGRhdGE/OiBJR2VuZXJpY09iamVjdCkge1xyXG4gICAgTG9nZ2VyLmxvZyhMb2dMZXZlbHMuV0FSTiwgbWVzc2FnZSwgZGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFcnJvciBsb2dzXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBMb2dnZXIgbWVzc2FnZVxyXG4gICAqIEBwYXJhbSB7SUdlbmVyaWNPYmplY3R9IGRhdGEgQWRkaXRpb25hbCBkZXRhaWxzIHRvIGxvZ1xyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZXJyb3IobWVzc2FnZTogc3RyaW5nLCBkYXRhPzogSUdlbmVyaWNPYmplY3QpIHtcclxuICAgIExvZ2dlci5sb2coTG9nTGV2ZWxzLkVSUk9SLCBtZXNzYWdlLCBkYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvZ3MgdGhlIG1lc3NhZ2UgdXNpbmcgdGhlIHBsdWdpbiBiYXNlZCBpbiBsZXZlbC5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7TG9nTGV2ZWxzfSBsb2dMZXZlbCBMb2cgbGV2ZWxcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBMb2dnZXIgbWVzc2FnZVxyXG4gICAqIEBwYXJhbSB7SUdlbmVyaWNPYmplY3R9IGRhdGEgQWRkaXRpb25hbCBkZXRhaWxzIHRvIGxvZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGxvZyhcclxuICAgIGxvZ0xldmVsOiBMb2dMZXZlbHMsXHJcbiAgICBtZXNzYWdlOiBzdHJpbmcsXHJcbiAgICBkYXRhPzogSUdlbmVyaWNPYmplY3QsXHJcbiAgKSB7XHJcbiAgICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlID0gTG9nZ2VyLmZvcm1hdExvZ01lc3NhZ2UobG9nTGV2ZWwsIG1lc3NhZ2UsIGRhdGEpO1xyXG5cclxuICAgIFN0b3JlLnJlZHVjZXJzLnNhdmVEZWJ1Z0luZm8oeyBsb2c6IGZvcm1hdHRlZE1lc3NhZ2UgfSk7XHJcbiAgICBDb25zb2xlTG9nZ2VyLmxvZyhsb2dMZXZlbCwgZm9ybWF0dGVkTWVzc2FnZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGb3JtYXRzIHRoZSBsb2dnZXIgbWVzc2FnZS5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7TG9nTGV2ZWxzfSBsb2dMZXZlbCBMb2cgbGV2ZWxcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBMb2dnZXIgbWVzc2FnZVxyXG4gICAqIEBwYXJhbSB7SUdlbmVyaWNPYmplY3R9IGRhdGEgQWRkaXRpb25hbCBkZXRhaWxzIHRvIGxvZ1xyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IEZvcm1hdHRlZCBsb2dnZXIgbWVzc2FnZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGZvcm1hdExvZ01lc3NhZ2UoXHJcbiAgICBsb2dMZXZlbDogTG9nTGV2ZWxzLFxyXG4gICAgbWVzc2FnZTogc3RyaW5nLFxyXG4gICAgZGF0YT86IElHZW5lcmljT2JqZWN0LFxyXG4gICk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBzdHJpbmdpZmllZERhdGEgPSBkYXRhID8gYHwgJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gIDogJyc7XHJcbiAgICByZXR1cm4gYFske0xvZ0xldmVsc1tsb2dMZXZlbF19XSAke21lc3NhZ2V9ICR7c3RyaW5naWZpZWREYXRhfWA7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IExvZ2dlcjtcclxuIiwiaW1wb3J0IExvZ2dlciBmcm9tICdjb3JlL2xvZ2dlcic7XHJcbmltcG9ydCB7XHJcbiAgRXJyb3JTdHJpbmdzLFxyXG4gIE1vZGVsS2luZCxcclxuICBOb3RpY2VUeXBlLFxyXG4gIFN0eWxlVHlwZSxcclxuICBUZW1wbGF0ZSxcclxufSBmcm9tICdjb3JlL2NvbnN0YW50cy9lbnVtcyc7XHJcblxyXG5jbGFzcyBUZW1wbGF0ZUhhbmRsZXIge1xyXG4gIHByaXZhdGUgc3RhdGljIGluaXRpYWxpemVkID0gZmFsc2U7XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcclxuICAgIFRlbXBsYXRlSGFuZGxlci5yZWdpc3RlclNob3dUZW1wbGF0ZUhhbmRsZXJzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdpc3RlciBldmVudCBoYW5kbGVycyB0byBvcGVuL2Nsb3NlIGRpZmZlcmVudCB0ZW1wbGF0ZXNcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyByZWdpc3RlclNob3dUZW1wbGF0ZUhhbmRsZXJzKCkge1xyXG4gICAgd2luZG93Ll9fTVNGVF9TREsuRXZlbnRCdXMub24oXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLlB1YmxpY0V2ZW50cy5TaG93Q29uc2VudE5vdGljZSxcclxuICAgICAgVGVtcGxhdGVIYW5kbGVyLnNob3dGaXJzdFBhZ2UsXHJcbiAgICApO1xyXG4gICAgd2luZG93Ll9fTVNGVF9TREsuRXZlbnRCdXMub24oXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLlB1YmxpY0V2ZW50cy5DbG9zZUNvbnNlbnROb3RpY2UsXHJcbiAgICAgIFRlbXBsYXRlSGFuZGxlci5oaWRlQ29uc2VudE5vdGljZSxcclxuICAgICk7XHJcbiAgICB3aW5kb3cuX19NU0ZUX1NESy5FdmVudEJ1cy5vbihcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuZW51bXMuRXZlbnRzLkluaXQsXHJcbiAgICAgIFRlbXBsYXRlSGFuZGxlci5zYXZlU3R5bGVzT25Jbml0LFxyXG4gICAgKTtcclxuICAgIHdpbmRvdy5fX01TRlRfU0RLLkV2ZW50QnVzLm9uKFxyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5lbnVtcy5QdWJsaWNFdmVudHMuU2hvd1RlbXBsYXRlLFxyXG4gICAgICBUZW1wbGF0ZUhhbmRsZXIuc2hvd1RlbXBsYXRlLFxyXG4gICAgKTtcclxuICAgIHdpbmRvdy5fX01TRlRfU0RLLkV2ZW50QnVzLm9uKFxyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5lbnVtcy5QdWJsaWNFdmVudHMuQ2xvc2VUZW1wbGF0ZSxcclxuICAgICAgVGVtcGxhdGVIYW5kbGVyLmNsb3NlVGVtcGxhdGUsXHJcbiAgICApO1xyXG4gICAgd2luZG93Ll9fTVNGVF9TREsuRXZlbnRCdXMub24oXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLkV2ZW50cy5Db25maWdSZWFkeSxcclxuICAgICAgVGVtcGxhdGVIYW5kbGVyLmluaXQsXHJcbiAgICApO1xyXG4gICAgd2luZG93Ll9fTVNGVF9TREsuRXZlbnRCdXMub24oXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLlB1YmxpY0V2ZW50cy5TaG93UHJlZmVyZW5jZXMsXHJcbiAgICAgIFRlbXBsYXRlSGFuZGxlci5zaG93UHJlZmVyZW5jZXMsXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc2hvd1ByZWZlcmVuY2VzKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgVGVtcGxhdGVIYW5kbGVyLnNob3dUZW1wbGF0ZSh7IHRlbXBsYXRlSWQ6IFRlbXBsYXRlLlByZWZlcmVuY2VzIH0pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBUZW1wbGF0ZUhhbmRsZXIuc2hvd0ZpcnN0UGFnZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2hvdyB0ZW1wbGF0ZVxyXG4gICAqXHJcbiAgICogQHBhcmFtICB7aW1wb3J0KFwiY29yZS90eXBlcy9pbnRlcmZhY2VzXCIpLklHZW5lcmljT2JqZWN0fSBwYXlsb2FkIHBheWxvYWQgZGF0YVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIHNob3dUZW1wbGF0ZSh7IHRlbXBsYXRlSWQgfTogSUdlbmVyaWNPYmplY3QpOiB2b2lkIHtcclxuICAgIGlmIChcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5jb21wb25lbnRzICYmXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMuY29tcG9uZW50c1t0ZW1wbGF0ZUlkXVxyXG4gICAgKSB7XHJcbiAgICAgIGNvbnN0IGNvbnNlbnRNb2RlbCA9IHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMuY3VycmVudE1vZGVsO1xyXG4gICAgICBUZW1wbGF0ZUhhbmRsZXIuc2hvd1RlbXBsYXRlSW5JRnJhbWUoXHJcbiAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5jb21wb25lbnRzW3RlbXBsYXRlSWRdLFxyXG4gICAgICAgIHRlbXBsYXRlSWQsXHJcbiAgICAgICAgW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICB0eXBlOiBTdHlsZVR5cGUuVGV4dCxcclxuICAgICAgICAgICAgdmFsdWU6IGNvbnNlbnRNb2RlbD8ubGF5b3V0c1swXS5jc3MgfHwgJycsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgVGVtcGxhdGVIYW5kbGVyLmdldFBhcmVudEVsZW1lbnQodGVtcGxhdGVJZCksXHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFRlbXBsYXRlIDogJHt0ZW1wbGF0ZUlkfSBub3QgZm91bmQuYCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIaWRlIHRlbXBsYXRlXHJcbiAgICpcclxuICAgKiBAcGFyYW0gIHtpbXBvcnQoXCJjb3JlL3R5cGVzL2ludGVyZmFjZXNcIikuSUdlbmVyaWNPYmplY3R9IHBheWxvYWQgcGF5bG9hZCBkYXRhXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgY2xvc2VUZW1wbGF0ZSh7IHRlbXBsYXRlSWQgfTogSUdlbmVyaWNPYmplY3QpOiB2b2lkIHtcclxuICAgIFRlbXBsYXRlSGFuZGxlci5jbG9zZUlGcmFtZSh0ZW1wbGF0ZUlkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNhdmUgc3R5bGVzIHBhc3NlZCBieSB1c2VyIGluIHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlXHJcbiAgICpcclxuICAgKiBAcGFyYW0gIHtpbXBvcnQoXCJjb3JlL3R5cGVzL2ludGVyZmFjZXNcIikuSUluaXRDb25maWd9IGNvbmZpZyBpbml0IGNvbmZpZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIHNhdmVTdHlsZXNPbkluaXQoY29uZmlnOiBhbnkpIHtcclxuICAgIGlmIChjb25maWcuc3R5bGVzKSB7XHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLkxvZ2dlci5pbmZvKFxyXG4gICAgICAgICd1c2VyIHByb3ZpZGVkIHN0eWxlcyBwZXJzaXN0ZWQgdG8gd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuJyxcclxuICAgICAgKTtcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUucmVkdWNlcnMuc2V0U3R5bGVzKGNvbmZpZy5zdHlsZXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0VGVtcGxhdGVEYXRhKGNvbnNlbnRNb2RlbDogSU1vZGVsKSB7XHJcbiAgICBjb25zdCBncm91cGVkVHJhbnNsYXRpb25zID0gd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy50cmFuc2xhdGlvbnM7XHJcbiAgICBjb25zdCB7IG5hbWU6IG1vZGVsTmFtZSB9ID0gY29uc2VudE1vZGVsO1xyXG4gICAgbGV0IGRhdGE6IGFueSA9IHt9O1xyXG4gICAgZGF0YVtOb3RpY2VUeXBlLlRyYWNrZXJDYXRlZ29yeV0gPSBbXTtcclxuICAgIGNvbnN0IHRyYWNrZXJDYXRlZ29yaWVzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICBjb25zdCBhZGRUcmFja2VyQ2F0ZWdvcmllcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG4gICAgaWYgKGNvbnNlbnRNb2RlbC5raW5kID09PSBNb2RlbEtpbmQuV2ViQ29uc2VudE1vZGVsKSB7XHJcbiAgICAgIChjb25zZW50TW9kZWwgYXMgSUNvbnNlbnRNb2RlbCkudHJhY2tlckNhdGVnb3JpZXMuZm9yRWFjaChjYXRlZ29yeSA9PiB7XHJcbiAgICAgICAgdHJhY2tlckNhdGVnb3JpZXMuYWRkKGNhdGVnb3J5LmNhdGVnb3J5TmFtZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmIChjb25zZW50TW9kZWwua2luZCA9PT0gTW9kZWxLaW5kLlF1ZXN0aW9uTW9kZWwpIHtcclxuICAgICAgZGF0YS5jYXB0Y2hhID0gKGNvbnNlbnRNb2RlbCBhcyBJUXVlc3Rpb25Nb2RlbCkuY2FwdGNoYTtcclxuICAgIH1cclxuICAgIGdyb3VwZWRUcmFuc2xhdGlvbnMuZm9yRWFjaChncm91cGVkVHJhbnNsYXRpb24gPT5cclxuICAgICAgT2JqZWN0LmtleXMoZ3JvdXBlZFRyYW5zbGF0aW9uKS5mb3JFYWNoKG5hbWVzcGFjZSA9PiB7XHJcbiAgICAgICAgaWYgKG5hbWVzcGFjZSA9PT0gbW9kZWxOYW1lKSB7XHJcbiAgICAgICAgICBkYXRhID0geyAuLi5kYXRhLCAuLi5ncm91cGVkVHJhbnNsYXRpb25bbmFtZXNwYWNlXSB9O1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY29uc2VudE1vZGVsLmtpbmQgPT09IE1vZGVsS2luZC5RdWVzdGlvbk1vZGVsKSB7XHJcbiAgICAgICAgICBkYXRhID0geyAuLi5kYXRhLCBbbmFtZXNwYWNlXTogZ3JvdXBlZFRyYW5zbGF0aW9uW25hbWVzcGFjZV0gfTtcclxuICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgdHJhY2tlckNhdGVnb3JpZXMuaGFzKG5hbWVzcGFjZSkgJiZcclxuICAgICAgICAgICFhZGRUcmFja2VyQ2F0ZWdvcmllcy5oYXMobmFtZXNwYWNlKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgY29uc3QgY2F0ZWdvcnlUcmFuc2xhdGlvbiA9IHtcclxuICAgICAgICAgICAgLi4uZ3JvdXBlZFRyYW5zbGF0aW9uW25hbWVzcGFjZV0sXHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWVzcGFjZSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBkYXRhW05vdGljZVR5cGUuVHJhY2tlckNhdGVnb3J5XS5wdXNoKGNhdGVnb3J5VHJhbnNsYXRpb24pO1xyXG4gICAgICAgICAgYWRkVHJhY2tlckNhdGVnb3JpZXMuYWRkKG5hbWVzcGFjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICk7XHJcbiAgICBkYXRhWydtc2Z0LXNjcmlwdC1vcGVuJ10gPSAnPHNjcmlwdD4nO1xyXG4gICAgZGF0YVsnbXNmdC1zY3JpcHQtY2xvc2UnXSA9ICc8L3NjcmlwdD4nO1xyXG4gICAgTG9nZ2VyLmluZm8oJ2dldFRlbXBsYXRlIGRhdGEgaW52b2tlZCcsIHsgY29uc2VudE1vZGVsLCBkYXRhIH0pO1xyXG4gICAgcmV0dXJuIHsgLi4uZGF0YSwgLi4ud2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy50ZW1wbGF0ZURhdGEgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBlcmZvcm0gYWxsIG5lY2Vzc2FyeSBzdGVwcyBsaWtlIHJlcGxhY2luZyBwbGFjZWhvbGRlcnMgaW5cclxuICAgKiB0ZW1wbGF0ZXMgZHVyaW5nIGluaXQuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5pdCgpIHtcclxuICAgIGlmIChcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5jdXJyZW50TW9kZWwgPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLnRlbXBsYXRlID09PSB1bmRlZmluZWRcclxuICAgICkge1xyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIud2FybignQ2Fubm90IGNhbGwgaW5pdCBiZWZvcmUgY29uZmlnIGlzIHJlYWR5LicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29uc2VudE1vZGVsID0gd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5jdXJyZW50TW9kZWw7XHJcbiAgICBjb25zdCB0ZW1wbGF0ZSA9IHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMudGVtcGxhdGU7XHJcblxyXG4gICAgY29uc3QgZGF0YSA9IFRlbXBsYXRlSGFuZGxlci5nZXRUZW1wbGF0ZURhdGEoY29uc2VudE1vZGVsKTtcclxuICAgIHRlbXBsYXRlLnBhZ2VzLmZvckVhY2gocGFnZSA9PiB7XHJcbiAgICAgIGxldCB0ZW1wbGF0ZVN0cmluZzogc3RyaW5nO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gd2luZG93LkhhbmRsZWJhcnMuY29tcGlsZShcclxuICAgICAgICAgIHBhZ2UuY29udGVudC5yZXBsYWNlQWxsKCd7e3txdWVzdGlvbnN9fX0nLCBkYXRhLnF1ZXN0aW9ucyksXHJcbiAgICAgICAgKTtcclxuICAgICAgICB0ZW1wbGF0ZVN0cmluZyA9IHRlbXBsYXRlKGRhdGEpO1xyXG4gICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuZXJyb3IoZS5tZXNzYWdlLCBlKTtcclxuICAgICAgICB0ZW1wbGF0ZVN0cmluZyA9IEVycm9yU3RyaW5ncy5UZW1wbGF0ZUVycm9yO1xyXG4gICAgICB9XHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLnJlZHVjZXJzLnNldENvbXBvbmVudHMoe1xyXG4gICAgICAgIC4uLndpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMuY29tcG9uZW50cyxcclxuICAgICAgICBbcGFnZS5uYW1lXTogdGVtcGxhdGVTdHJpbmcsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIuaW5mbygnQ29tcG9uZW50cyB1cGRhdGVkJyk7XHJcbiAgICBUZW1wbGF0ZUhhbmRsZXIuaW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG4gICAgd2luZG93Ll9fTVNGVF9TREsuRXZlbnRCdXMub24oXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLlB1YmxpY0V2ZW50cy5TaG93Rmlyc3RQYWdlLFxyXG4gICAgICBUZW1wbGF0ZUhhbmRsZXIuc2hvd0ZpcnN0UGFnZSxcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTaG93IENvbnNlbnQgbm90aWNlIHRlbXBsYXRlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc2hvd0ZpcnN0UGFnZSgpIHtcclxuICAgIGlmICghVGVtcGxhdGVIYW5kbGVyLmluaXRpYWxpemVkKSB7XHJcbiAgICAgIFRlbXBsYXRlSGFuZGxlci5pbml0KCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb25zZW50TW9kZWwgPSB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLmN1cnJlbnRNb2RlbDtcclxuICAgIGlmIChjb25zZW50TW9kZWwgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5Mb2dnZXIud2FybihcclxuICAgICAgICAnQ2Fubm90IGNhbGwgaW5pdCBiZWZvcmUgY29uc2VudCBtb2RlbCBpcyBzZWxlY3RlZC4nLFxyXG4gICAgICApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbW9kZSA9IGNvbnNlbnRNb2RlbC5sYXlvdXRzWzBdLm1vZGU7XHJcbiAgICBjb25zdCBpbml0Q29tcG9uZW50ID0gd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy50ZW1wbGF0ZT8ubW9kZXMuZmluZChcclxuICAgICAgbSA9PiBtLm5hbWUgPT09IG1vZGUsXHJcbiAgICApPy5pbml0UGFnZTtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMuY29tcG9uZW50cyA9PT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgIGluaXRDb21wb25lbnQgPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLmNvbXBvbmVudHNbaW5pdENvbXBvbmVudF0gPT09IHVuZGVmaW5lZFxyXG4gICAgKSB7XHJcbiAgICAgIHdpbmRvdy5fX01TRlRfU0RLLkxvZ2dlci5lcnJvcignTm90aWNlIHRlbXBsYXRlIG5vdCBmb3VuZC4nKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdGVtcGxhdGUgPSB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLmNvbXBvbmVudHNbaW5pdENvbXBvbmVudF07XHJcblxyXG4gICAgVGVtcGxhdGVIYW5kbGVyLnNob3dUZW1wbGF0ZUluSUZyYW1lKFxyXG4gICAgICB0ZW1wbGF0ZSxcclxuICAgICAgaW5pdENvbXBvbmVudCxcclxuICAgICAgW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHR5cGU6IFN0eWxlVHlwZS5UZXh0LFxyXG4gICAgICAgICAgdmFsdWU6IGNvbnNlbnRNb2RlbC5sYXlvdXRzWzBdLmNzcyB8fCAnJyxcclxuICAgICAgICB9LFxyXG4gICAgICBdLFxyXG4gICAgICBUZW1wbGF0ZUhhbmRsZXIuZ2V0UGFyZW50RWxlbWVudChpbml0Q29tcG9uZW50KSxcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyBnZXRQYXJlbnRFbGVtZW50KHRlbXBsYXRlSWQ6IHN0cmluZyk6IEhUTUxFbGVtZW50IHwgbnVsbCB7XHJcbiAgICBjb25zdCBwYXJlbnRFbGVtZW50SWQgPSAod2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5jb25maWcuaW5pdENvbmZpZ1xyXG4gICAgICA/LmNvbXBvbmVudFBhcmVudE1hcCB8fFxyXG4gICAgICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLnRlbXBsYXRlUGFyZW50TWFwKVt0ZW1wbGF0ZUlkXTtcclxuICAgIGlmIChwYXJlbnRFbGVtZW50SWQpIHtcclxuICAgICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBhcmVudEVsZW1lbnRJZCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZHMgdGVtcGxhdGUgdG8gaWZyYW1lIGFuZCBhcHBlbmQgaXQgdG8gZG9tXHJcbiAgICpcclxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IHRlbXBsYXRlIHRlbXBsYXRlIHRvIGFkZFxyXG4gICAqIEBwYXJhbSAge3N0cmluZ30gaWZyYW1lSWQgaWZyYW1lIGlkXHJcbiAgICogQHBhcmFtICB7SVN0eWxlW119IHN0eWxlcyBzdHlsZXNcclxuICAgKiBAcGFyYW0gIHtIVE1MRWxlbWVudHxudWxsfSBwYXJlbnRFbGVtZW50IGlmIGlmcmFtZSBzaG91bGQgYmUgYWRkZWQgdG8gYSBzcGVjaWZpYyBlbGVtZW50IGluc3RlYWQgb2YgYm9keVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIHNob3dUZW1wbGF0ZUluSUZyYW1lKFxyXG4gICAgdGVtcGxhdGU6IHN0cmluZyxcclxuICAgIGlmcmFtZUlkOiBzdHJpbmcsXHJcbiAgICBzdHlsZXM6IElTdHlsZVtdID0gW10sXHJcbiAgICBwYXJlbnRFbGVtZW50PzogSFRNTEVsZW1lbnQgfCBudWxsLFxyXG4gICkge1xyXG4gICAgY29uc3QgaWZyYW1lRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlmcmFtZUlkKTtcclxuICAgIGlmIChpZnJhbWVFbGVtZW50KSB7XHJcbiAgICAgIExvZ2dlci5pbmZvKGBUZW1wbGF0ZTogJHtpZnJhbWVJZH0gaXMgYWxyZWFkeSBvcGVuLmApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIHRlbXBsYXRlID09PSBFcnJvclN0cmluZ3MuVGVtcGxhdGVFcnJvciAmJlxyXG4gICAgICAgICghd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5pc0xpdmVQcmV2aWV3TW9kZSB8fFxyXG4gICAgICAgICAgIXdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMuaXNQcmV2aWV3TW9kZSlcclxuICAgICAgKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGRhdGEgPSB7XHJcbiAgICAgICAgb3JpZ2luOiB3aW5kb3cub3JpZ2luLFxyXG4gICAgICB9O1xyXG4gICAgICB0ZW1wbGF0ZSA9XHJcbiAgICAgICAgYDxzY3JpcHQ+dmFyIG1zZnREYXRhID0gJHtKU09OLnN0cmluZ2lmeShkYXRhKX08L3NjcmlwdD5gICtcclxuICAgICAgICBgPHNjcmlwdD4ke3dpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMucHJveHlKU308L3NjcmlwdD5gICtcclxuICAgICAgICB0ZW1wbGF0ZTtcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuVXRpbHMuSUZyYW1lVXRpbHMuY3JlYXRlSUZyYW1lKFxyXG4gICAgICAgIHRlbXBsYXRlLFxyXG4gICAgICAgIGlmcmFtZUlkLFxyXG4gICAgICAgIHBhcmVudEVsZW1lbnQsXHJcbiAgICAgICAgWy4uLnN0eWxlcywgLi4uKHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMuc3R5bGVzIHx8IFtdKV0sXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIaWRlIGNvbnNlbnQgbm90aWNlIGlmcmFtZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIGhpZGVDb25zZW50Tm90aWNlKCkge1xyXG4gICAgY29uc3QgY29uc2VudE1vZGVsID0gd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5jdXJyZW50TW9kZWw7XHJcbiAgICBpZiAoY29uc2VudE1vZGVsID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLndhcm4oXHJcbiAgICAgICAgJ0Nhbm5vdCBjYWxsIGhpZGVDb25zZW50Tm90aWNlIGJlZm9yZSBjb25zZW50IG1vZGVsIGlzIHNlbGVjdGVkLicsXHJcbiAgICAgICk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtb2RlID0gY29uc2VudE1vZGVsLmxheW91dHNbMF0ubW9kZTtcclxuICAgIGNvbnN0IGluaXRDb21wb25lbnQgPSB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLnRlbXBsYXRlPy5tb2Rlcy5maW5kKFxyXG4gICAgICBtID0+IG0ubmFtZSA9PT0gbW9kZSxcclxuICAgICk/LmluaXRQYWdlO1xyXG5cclxuICAgIGluaXRDb21wb25lbnQgJiYgVGVtcGxhdGVIYW5kbGVyLmNsb3NlSUZyYW1lKGluaXRDb21wb25lbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IGlmcmFtZSBkaXNwbGF5IHRvIG5vbmVcclxuICAgKlxyXG4gICAqIEBwYXJhbSAge3N0cmluZ30gaWZyYW1lSWQgaWQgb2YgaWZyYW1lIGVsZW1lbnRcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXRpYyBjbG9zZUlGcmFtZShpZnJhbWVJZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBpZnJhbWVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWZyYW1lSWQpO1xyXG4gICAgaWZyYW1lRWxlbWVudD8ucGFyZW50RWxlbWVudD8ucmVtb3ZlQ2hpbGQoaWZyYW1lRWxlbWVudCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUZW1wbGF0ZUhhbmRsZXI7XHJcbiIsImltcG9ydCB7IFB1YmxpY0V2ZW50cyB9IGZyb20gJ2NvcmUvY29uc3RhbnRzL2VudW1zJztcclxuaW1wb3J0IFRlbXBsYXRlSGFuZGxlciBmcm9tICcuL1RlbXBsYXRlSGFuZGxlcic7XHJcblxyXG53aW5kb3cub25tZXNzYWdlID0gZSA9PiB7XHJcbiAgaWYgKGUub3JpZ2luID09PSAnbnVsbCcpIHtcclxuICAgIGlmIChcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5pc0FjdGlvbkRpc2FibGVkICYmXHJcbiAgICAgIGUuZGF0YS5tZXRob2QgPT09ICd0cmlnZ2VyJ1xyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gKHdpbmRvdy5NU0ZUQ29uc2VudCBhcyBhbnkpW2UuZGF0YS5tZXRob2RdKFxyXG4gICAgICAuLi5lLmRhdGEucGFyYW1zLFxyXG4gICAgKTtcclxuICAgIGlmIChlLmRhdGEucmVzcG9uc2VJZCkge1xyXG4gICAgICBlLnNvdXJjZT8ucG9zdE1lc3NhZ2UoeyAuLi5lLmRhdGEsIHJlc3BvbnNlIH0sIHsgdGFyZ2V0T3JpZ2luOiAnKicgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxud2luZG93Ll9fTVNGVF9TREsuRXZlbnRCdXMub24oXHJcbiAgUHVibGljRXZlbnRzLkFuY2hvclRhZ0NsaWNrZWQsXHJcbiAgKHsgYXR0cmlidXRlcyB9KSA9PiB7XHJcbiAgICBjb25zdCBhVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChhdHRyTmFtZSA9PiB7XHJcbiAgICAgIGFUYWcuc2V0QXR0cmlidXRlKGF0dHJOYW1lLCBhdHRyaWJ1dGVzW2F0dHJOYW1lXSk7XHJcbiAgICB9KTtcclxuICAgIGFUYWcuY2xpY2soKTtcclxuICB9LFxyXG4pO1xyXG5cclxubmV3IFRlbXBsYXRlSGFuZGxlcigpO1xyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0lBQUE7SUFDQTtBQUNBO0lBQ0E7SUFDQTtBQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0FBQ0E7SUFDQSxJQUFJLGFBQWEsR0FBRyxTQUFTLENBQUMsRUFBRSxDQUFDLEVBQUU7SUFDbkMsSUFBSSxhQUFhLEdBQUcsTUFBTSxDQUFDLGNBQWM7SUFDekMsU0FBUyxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsWUFBWSxLQUFLLElBQUksVUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQ3BGLFFBQVEsVUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQzFHLElBQUksT0FBTyxhQUFhLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQy9CLENBQUMsQ0FBQztBQUNGO0lBQ08sU0FBUyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRTtJQUNoQyxJQUFJLElBQUksT0FBTyxDQUFDLEtBQUssVUFBVSxJQUFJLENBQUMsS0FBSyxJQUFJO0lBQzdDLFFBQVEsTUFBTSxJQUFJLFNBQVMsQ0FBQyxzQkFBc0IsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsK0JBQStCLENBQUMsQ0FBQztJQUNsRyxJQUFJLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDeEIsSUFBSSxTQUFTLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDM0MsSUFBSSxDQUFDLENBQUMsU0FBUyxHQUFHLENBQUMsS0FBSyxJQUFJLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3pGLENBQUM7QUFDRDtJQUNPLElBQUksUUFBUSxHQUFHLFdBQVc7SUFDakMsSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFDLE1BQU0sSUFBSSxTQUFTLFFBQVEsQ0FBQyxDQUFDLEVBQUU7SUFDckQsUUFBUSxLQUFLLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtJQUM3RCxZQUFZLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0IsWUFBWSxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN6RixTQUFTO0lBQ1QsUUFBUSxPQUFPLENBQUMsQ0FBQztJQUNqQixNQUFLO0lBQ0wsSUFBSSxPQUFPLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQzNDLEVBQUM7QUE4RkQ7SUFDTyxTQUFTLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFO0lBQzdCLElBQUksSUFBSSxDQUFDLEdBQUcsT0FBTyxNQUFNLEtBQUssVUFBVSxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDL0QsSUFBSSxJQUFJLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3JCLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDckMsSUFBSSxJQUFJO0lBQ1IsUUFBUSxPQUFPLENBQUMsQ0FBQyxLQUFLLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDbkYsS0FBSztJQUNMLElBQUksT0FBTyxLQUFLLEVBQUUsRUFBRSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRTtJQUMzQyxZQUFZO0lBQ1osUUFBUSxJQUFJO0lBQ1osWUFBWSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0QsU0FBUztJQUNULGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFO0lBQ3pDLEtBQUs7SUFDTCxJQUFJLE9BQU8sRUFBRSxDQUFDO0lBQ2QsQ0FBQztBQWlCRDtJQUNPLFNBQVMsYUFBYSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO0lBQzlDLElBQUksSUFBSSxJQUFJLElBQUksU0FBUyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7SUFDekYsUUFBUSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBRTtJQUNoQyxZQUFZLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2pFLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1QixTQUFTO0lBQ1QsS0FBSztJQUNMLElBQUksT0FBTyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxLQUFLLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUM3RDs7SUNoTEEsSUFBWSxnQkFHWDtJQUhELFdBQVksZ0JBQWdCO1FBQzFCLHlDQUFxQixDQUFBO1FBQ3JCLHlDQUFxQixDQUFBO0lBQ3ZCLENBQUMsRUFIVyxnQkFBZ0IsS0FBaEIsZ0JBQWdCLFFBRzNCO0lBRUQsSUFBWSxZQWVYO0lBZkQsV0FBWSxZQUFZO1FBQ3RCLGlEQUFpQyxDQUFBO1FBQ2pDLHVEQUF1QyxDQUFBO1FBQ3ZDLCtDQUErQixDQUFBO1FBQy9CLHlEQUF5QyxDQUFBO1FBQ3pDLHVDQUF1QixDQUFBO1FBQ3ZCLHVDQUF1QixDQUFBO1FBQ3ZCLDZDQUE2QixDQUFBO1FBQzdCLCtDQUErQixDQUFBO1FBQy9CLCtDQUErQixDQUFBO1FBQy9CLHFEQUFxQyxDQUFBO1FBQ3JDLDJDQUEyQixDQUFBO1FBQzNCLHlGQUF5RSxDQUFBO1FBQ3pFLDJEQUEyQyxDQUFBO1FBQzNDLG1EQUFtQyxDQUFBO0lBQ3JDLENBQUMsRUFmVyxZQUFZLEtBQVosWUFBWSxRQWV2QjtJQUVELElBQVksTUFJWDtJQUpELFdBQVksTUFBTTtRQUNoQix1QkFBYSxDQUFBO1FBQ2IsK0RBQXFELENBQUE7UUFDckQscUNBQTJCLENBQUE7SUFDN0IsQ0FBQyxFQUpXLE1BQU0sS0FBTixNQUFNLFFBSWpCO0lBRUQsSUFBWSxPQUdYO0lBSEQsV0FBWSxPQUFPO1FBQ2pCLDhCQUFtQixDQUFBO1FBQ25CLGdDQUFxQixDQUFBO0lBQ3ZCLENBQUMsRUFIVyxPQUFPLEtBQVAsT0FBTyxRQUdsQjtJQUVELElBQVksU0FHWDtJQUhELFdBQVksU0FBUztRQUNuQix3QkFBVyxDQUFBO1FBQ1gsMEJBQWEsQ0FBQTtJQUNmLENBQUMsRUFIVyxTQUFTLEtBQVQsU0FBUyxRQUdwQjtJQUVELElBQVksVUFHWDtJQUhELFdBQVksVUFBVTtRQUNwQix1QkFBUyxDQUFBO1FBQ1Qsc0JBQVEsQ0FBQTtJQUNWLENBQUMsRUFIVyxVQUFVLEtBQVYsVUFBVSxRQUdyQjtJQUVELElBQVksTUFFWDtJQUZELFdBQVksTUFBTTtRQUNoQixrQ0FBd0IsQ0FBQTtJQUMxQixDQUFDLEVBRlcsTUFBTSxLQUFOLE1BQU0sUUFFakI7SUFFRCxJQUFZLGlCQUdYO0lBSEQsV0FBWSxpQkFBaUI7UUFDM0Isc0NBQWlCLENBQUE7UUFDakIsc0NBQWlCLENBQUE7SUFDbkIsQ0FBQyxFQUhXLGlCQUFpQixLQUFqQixpQkFBaUIsUUFHNUI7SUFFRCxJQUFZLFVBRVg7SUFGRCxXQUFZLFVBQVU7UUFDcEIsaURBQW1DLENBQUE7SUFDckMsQ0FBQyxFQUZXLFVBQVUsS0FBVixVQUFVLFFBRXJCO0lBRUQsSUFBWSxZQUVYO0lBRkQsV0FBWSxZQUFZO1FBQ3RCLG1HQUFtRixDQUFBO0lBQ3JGLENBQUMsRUFGVyxZQUFZLEtBQVosWUFBWSxRQUV2QjtJQUVELElBQVksYUFLWDtJQUxELFdBQVksYUFBYTtRQUN2Qiw0QkFBVyxDQUFBO1FBQ1gsOEJBQWEsQ0FBQTtRQUNiLGdDQUFlLENBQUE7UUFDZiw4QkFBYSxDQUFBO0lBQ2YsQ0FBQyxFQUxXLGFBQWEsS0FBYixhQUFhLFFBS3hCO0lBRUQsSUFBWSxZQVdYO0lBWEQsV0FBWSxZQUFZO1FBQ3RCLDZCQUFhLENBQUE7UUFDYiwrQkFBZSxDQUFBO1FBQ2YsK0JBQWUsQ0FBQTtRQUNmLDJDQUEyQixDQUFBO1FBQzNCLGlDQUFpQixDQUFBO1FBQ2pCLDZCQUFhLENBQUE7UUFDYiwyQ0FBMkIsQ0FBQTtRQUMzQix5Q0FBeUIsQ0FBQTtRQUN6QixpQ0FBaUIsQ0FBQTtRQUNqQiwrQ0FBK0IsQ0FBQTtJQUNqQyxDQUFDLEVBWFcsWUFBWSxLQUFaLFlBQVksUUFXdkI7SUFFRCxJQUFZLGtCQUVYO0lBRkQsV0FBWSxrQkFBa0I7UUFDNUIsMkNBQXFCLENBQUE7SUFDdkIsQ0FBQyxFQUZXLGtCQUFrQixLQUFsQixrQkFBa0IsUUFFN0I7SUFFRCxJQUFZLGFBSVg7SUFKRCxXQUFZLGFBQWE7UUFDdkIsc0NBQXFCLENBQUE7UUFDckIsNENBQTJCLENBQUE7UUFDM0Isb0NBQW1CLENBQUE7SUFDckIsQ0FBQyxFQUpXLGFBQWEsS0FBYixhQUFhLFFBSXhCO0lBRUQsSUFBWSxTQUdYO0lBSEQsV0FBWSxTQUFTO1FBQ25CLGdEQUFtQyxDQUFBO1FBQ25DLGlEQUFvQyxDQUFBO0lBQ3RDLENBQUMsRUFIVyxTQUFTLEtBQVQsU0FBUyxRQUdwQjtJQUVELElBQVksUUFFWDtJQUZELFdBQVksUUFBUTtRQUNsQix1Q0FBMkIsQ0FBQTtJQUM3QixDQUFDLEVBRlcsUUFBUSxLQUFSLFFBQVE7O0lDL0ZwQjtRQUFBO1NBb0JDO1FBbkJlLG9CQUFRLEdBQXRCLFVBQXVCLElBQVM7WUFDOUIsT0FBTyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUNqRTtRQUNhLHFCQUFTLEdBQXZCLFVBQXdCLE1BQVc7O1lBQUUsaUJBQWU7aUJBQWYsVUFBZSxFQUFmLHFCQUFlLEVBQWYsSUFBZTtnQkFBZixnQ0FBZTs7WUFDbEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNO2dCQUFFLE9BQU8sTUFBTSxDQUFDO1lBQ25DLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUUvQixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtnQkFDbEQsS0FBSyxJQUFNLEdBQUcsSUFBSSxNQUFNLEVBQUU7b0JBQ3hCLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTt3QkFDOUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUM7NEJBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLFlBQUksR0FBQyxHQUFHLElBQUcsRUFBRSxNQUFHLENBQUM7d0JBQ3ZELElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO3FCQUMxQzt5QkFBTTt3QkFDTCxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sWUFBSSxHQUFDLEdBQUcsSUFBRyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQUcsQ0FBQztxQkFDL0M7aUJBQ0Y7YUFDRjtZQUNELE9BQU8sSUFBSSxDQUFDLFNBQVMsT0FBZCxJQUFJLGlCQUFXLE1BQU0sVUFBSyxPQUFPLFdBQUU7U0FDM0M7UUFDSCxrQkFBQztJQUFELENBQUM7O0lDcEJELElBQVksVUFPWDtJQVBELFdBQVksVUFBVTtRQUNwQiwyQ0FBNkIsQ0FBQTtRQUM3QixpQ0FBbUIsQ0FBQTtRQUNuQiwrQkFBaUIsQ0FBQTtRQUNqQixxQ0FBdUIsQ0FBQTtRQUN2Qiw2QkFBZSxDQUFBO1FBQ2YseUJBQVcsQ0FBQTtJQUNiLENBQUMsRUFQVyxVQUFVLEtBQVYsVUFBVSxRQU9yQjtJQUVELElBQVksY0FNWDtJQU5ELFdBQVksY0FBYztRQUN4QixrRkFBZ0UsQ0FBQTtRQUNoRSx3RUFBc0QsQ0FBQTtRQUN0RCxvRkFBa0UsQ0FBQTtRQUNsRSxvRUFBa0QsQ0FBQTtRQUNsRCxnRUFBOEMsQ0FBQTtJQUNoRCxDQUFDLEVBTlcsY0FBYyxLQUFkLGNBQWMsUUFNekI7SUFFRCxJQUFZLHdCQUtYO0lBTEQsV0FBWSx3QkFBd0I7UUFDbEMsaUVBQXFDLENBQUE7UUFDckMsNERBQWdDLENBQUE7UUFDaEMsbURBQXVCLENBQUE7UUFDdkIsMENBQWMsQ0FBQTtJQUNoQixDQUFDLEVBTFcsd0JBQXdCLEtBQXhCLHdCQUF3QixRQUtuQztJQUVELElBQVksZ0JBR1g7SUFIRCxXQUFZLGdCQUFnQjtRQUMxQixpQ0FBYSxDQUFBO1FBQ2IseUNBQXFCLENBQUE7SUFDdkIsQ0FBQyxFQUhXLGdCQUFnQixLQUFoQixnQkFBZ0I7O0lDdEI1QjtRQUdFLGVBQVksS0FBYztZQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssSUFBSTtnQkFDcEIsTUFBTSxFQUFFLEVBQUU7Z0JBQ1YsS0FBSyxFQUFFO29CQUNMLElBQUksRUFBRSxFQUFFO29CQUNSLE1BQU0sRUFBRSxFQUFFO2lCQUNYO2dCQUNELE1BQU0sRUFBRSxFQUFFO2FBQ1gsQ0FBQztTQUNIO1FBQ0gsWUFBQztJQUFELENBQUM7O0lDUEQ7UUFBc0IsMkJBQUs7UUFDekIsaUJBQVksS0FBYTttQkFDdkIsa0JBQU0sS0FBSyxDQUFDO1NBQ2I7UUFDRCxzQkFBSSw4QkFBUztpQkFBYjtnQkFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDO2FBQ3pCOzs7V0FBQTtRQUVELHNCQUFJLDJCQUFNO2lCQUFWO2dCQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7YUFDMUI7OztXQUFBO1FBQ0Qsc0JBQUksZ0NBQVc7aUJBQWY7Z0JBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUM7YUFDdEM7OztXQUFBO1FBR0Qsc0JBQUksK0JBQVU7O2lCQUFkO2dCQUNFLE9BQU8sS0FBSyxDQUFDO2FBQ2Q7OztXQUFBO1FBRUQsc0JBQUksa0NBQWE7aUJBQWpCOztnQkFDRSxPQUFPLENBQUEsTUFBQSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLDBDQUFFLE9BQU8sS0FBSSxLQUFLLENBQUM7YUFDdkQ7OztXQUFBO1FBRUQsc0JBQUkscUNBQWdCO2lCQUFwQjs7Z0JBQ0UsT0FBTyxDQUFBLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSwwQ0FBRSxjQUFjLEtBQUksS0FBSyxDQUFDO2FBQzlEOzs7V0FBQTtRQUVELHNCQUFJLHNDQUFpQjtpQkFBckI7O2dCQUNFLE9BQU8sQ0FBQSxNQUFBLE1BQU0sQ0FBQyxNQUFNLDBDQUFFLElBQUksTUFBSyxvQkFBb0IsQ0FBQzthQUNyRDs7O1dBQUE7UUFFRCxzQkFBSSx5Q0FBb0I7aUJBQXhCO2dCQUNFLE9BQU8sd0JBQXdCLENBQUMsWUFBWSxDQUFDO2FBQzlDOzs7V0FBQTtRQUVELHNCQUFJLHNDQUFpQjtpQkFBckI7Z0JBQ0UsT0FBTyx3QkFBd0IsQ0FBQyxTQUFTLENBQUM7YUFDM0M7OztXQUFBO1FBRUQsc0JBQUksa0NBQWE7aUJBQWpCO2dCQUNFLE9BQU8sd0JBQXdCLENBQUMsS0FBSyxDQUFDO2FBQ3ZDOzs7V0FBQTtRQUVELHNCQUFJLGdDQUFXO2lCQUFmO2dCQUNFLE9BQU8sd0JBQXdCLENBQUMsR0FBRyxDQUFDO2FBQ3JDOzs7V0FBQTtRQUNILGNBQUM7SUFBRCxDQS9DQSxDQUFzQixLQUFLOztJQ0QzQjtRQUF1Qiw0QkFBSztRQUMxQixrQkFBWSxLQUFhO21CQUN2QixrQkFBTSxLQUFLLENBQUM7U0FDYjtRQUVNLGdDQUFhLEdBQXBCLFVBQXFCLEVBQWdEO2dCQUE5QyxLQUFLLFdBQUEsRUFBRSxHQUFHLFNBQUE7WUFDL0IsSUFBSSxLQUFLLEVBQUU7Z0JBQ1QsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNyQztZQUVELElBQUksR0FBRyxFQUFFO2dCQUNQLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDakM7U0FDRjtRQUVNLGlDQUFjLEdBQXJCLFVBQXNCLE9BQXFCO1lBQ3pDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFdBQVcsR0FBRyxPQUFPLENBQUM7U0FDekM7UUFFTSxnQ0FBYSxHQUFwQixVQUFxQixVQUF1QjtZQUMxQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO1NBQzNDO1FBQ0gsZUFBQztJQUFELENBdEJBLENBQXVCLEtBQUs7O0lDRnBCLElBQUEsS0FBSyxHQUFLLElBQUksS0FBSyxFQUFFLE1BQWhCLENBQWlCO0lBQzlCLElBQU0sTUFBTSxHQUFHLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLElBQU0sT0FBTyxHQUFHLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBRXBDLGdCQUFlO1FBQ2IsT0FBTyxFQUFFLE1BQU07UUFDZixRQUFRLEVBQUUsT0FBTztRQUNqQixXQUFXLEVBQUUsVUFBVSxRQUFhO1lBQ2xDLElBQUksQ0FBQyxRQUFRLEdBQUcsV0FBVyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1NBQ2hFO1FBQ0QsVUFBVSxFQUFFLFVBQVUsT0FBWTtZQUNoQyxNQUFNLENBQUMsZ0JBQWdCLENBQ3JCLElBQUksQ0FBQyxPQUFPLEVBQ1osTUFBTSxDQUFDLHlCQUF5QixDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FDcEQsQ0FBQztTQUNIO0tBQ0Y7O0lDckJELElBQVksU0FJWDtJQUpELFdBQVksU0FBUztRQUNuQix5Q0FBSSxDQUFBO1FBQ0oseUNBQUksQ0FBQTtRQUNKLDJDQUFLLENBQUE7SUFDUCxDQUFDLEVBSlcsU0FBUyxLQUFULFNBQVM7O0lDRXJCO1FBQUE7U0FzQkM7Ozs7Ozs7UUFmZSxpQkFBRyxHQUFqQixVQUFrQixLQUFnQixFQUFFLE9BQWU7WUFDakQsUUFBUSxLQUFLO2dCQUNYLEtBQUssU0FBUyxDQUFDLElBQUk7b0JBQ2pCLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7b0JBQ3RCLE1BQU07Z0JBQ1IsS0FBSyxTQUFTLENBQUMsS0FBSztvQkFDbEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFDdkIsTUFBTTtnQkFDUjtvQkFDOEM7d0JBQzFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7cUJBQ3RCO29CQUNELE1BQU07YUFDVDtTQUNGO1FBQ0gsb0JBQUM7SUFBRCxDQUFDOztJQ3BCRDs7O0lBR0E7UUFBQTtTQWlFQzs7Ozs7OztRQTFEZSxXQUFJLEdBQWxCLFVBQW1CLE9BQWUsRUFBRSxJQUFxQjtZQUN2RCxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQzNDOzs7Ozs7O1FBUWEsV0FBSSxHQUFsQixVQUFtQixPQUFlLEVBQUUsSUFBcUI7WUFDdkQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztTQUMzQzs7Ozs7OztRQVFhLFlBQUssR0FBbkIsVUFBb0IsT0FBZSxFQUFFLElBQXFCO1lBQ3hELE1BQU0sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDNUM7Ozs7Ozs7O1FBU2MsVUFBRyxHQUFsQixVQUNFLFFBQW1CLEVBQ25CLE9BQWUsRUFDZixJQUFxQjtZQUVyQixJQUFNLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBRTFFLEtBQUssQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixFQUFFLENBQUMsQ0FBQztZQUN4RCxhQUFhLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1NBQy9DOzs7Ozs7Ozs7UUFVYyx1QkFBZ0IsR0FBL0IsVUFDRSxRQUFtQixFQUNuQixPQUFlLEVBQ2YsSUFBcUI7WUFFckIsSUFBTSxlQUFlLEdBQUcsSUFBSSxHQUFHLFlBQUssSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBRSxHQUFHLEVBQUUsQ0FBQztZQUNoRSxPQUFPLFdBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxlQUFLLE9BQU8sY0FBSSxlQUFlLENBQUUsQ0FBQztTQUNqRTtRQUNILGFBQUM7SUFBRCxDQUFDOztJQy9ERDtRQUdFO1lBQ0UsZUFBZSxDQUFDLDRCQUE0QixFQUFFLENBQUM7U0FDaEQ7Ozs7UUFLYyw0Q0FBNEIsR0FBM0M7WUFDRSxNQUFNLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQzNCLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxpQkFBaUIsRUFDdEQsZUFBZSxDQUFDLGFBQWEsQ0FDOUIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FDM0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLGtCQUFrQixFQUN2RCxlQUFlLENBQUMsaUJBQWlCLENBQ2xDLENBQUM7WUFDRixNQUFNLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQzNCLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQ25DLGVBQWUsQ0FBQyxnQkFBZ0IsQ0FDakMsQ0FBQztZQUNGLE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FDM0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLFlBQVksRUFDakQsZUFBZSxDQUFDLFlBQVksQ0FDN0IsQ0FBQztZQUNGLE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FDM0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLGFBQWEsRUFDbEQsZUFBZSxDQUFDLGFBQWEsQ0FDOUIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FDM0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFDMUMsZUFBZSxDQUFDLElBQUksQ0FDckIsQ0FBQztZQUNGLE1BQU0sQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FDM0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLGVBQWUsRUFDcEQsZUFBZSxDQUFDLGVBQWUsQ0FDaEMsQ0FBQztTQUNIO1FBRWMsK0JBQWUsR0FBOUI7WUFDRSxJQUFJO2dCQUNGLGVBQWUsQ0FBQyxZQUFZLENBQUMsRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7YUFDcEU7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDVixlQUFlLENBQUMsYUFBYSxFQUFFLENBQUM7YUFDakM7U0FDRjs7Ozs7O1FBT2MsNEJBQVksR0FBM0IsVUFBNEIsRUFBOEI7Z0JBQTVCLFVBQVUsZ0JBQUE7WUFDdEMsSUFDRSxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVTtnQkFDMUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFDdEQ7Z0JBQ0EsSUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQztnQkFDbEUsZUFBZSxDQUFDLG9CQUFvQixDQUNsQyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUN0RCxVQUFVLEVBQ1Y7b0JBQ0U7d0JBQ0UsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJO3dCQUNwQixLQUFLLEVBQUUsQ0FBQSxZQUFZLGFBQVosWUFBWSx1QkFBWixZQUFZLENBQUUsT0FBTyxDQUFDLENBQUMsRUFBRSxHQUFHLEtBQUksRUFBRTtxQkFDMUM7aUJBQ0YsRUFDRCxlQUFlLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLENBQzdDLENBQUM7YUFDSDtpQkFBTTtnQkFDTCxNQUFNLElBQUksS0FBSyxDQUFDLHFCQUFjLFVBQVUsZ0JBQWEsQ0FBQyxDQUFDO2FBQ3hEO1NBQ0Y7Ozs7OztRQU9jLDZCQUFhLEdBQTVCLFVBQTZCLEVBQThCO2dCQUE1QixVQUFVLGdCQUFBO1lBQ3ZDLGVBQWUsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDekM7Ozs7OztRQU9jLGdDQUFnQixHQUEvQixVQUFnQyxNQUFXO1lBQ3pDLElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRTtnQkFDakIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUMzQiw0REFBNEQsQ0FDN0QsQ0FBQztnQkFDRixNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQzthQUMzRDtTQUNGO1FBRWMsK0JBQWUsR0FBOUIsVUFBK0IsWUFBb0I7WUFDakQsSUFBTSxtQkFBbUIsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDO1lBQ2pFLElBQU0sU0FBUyxHQUFLLFlBQVksS0FBakIsQ0FBa0I7WUFDekMsSUFBSSxJQUFJLEdBQVEsRUFBRSxDQUFDO1lBQ25CLElBQUksQ0FBQyxVQUFVLENBQUMsZUFBZSxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ3RDLElBQU0saUJBQWlCLEdBQUcsSUFBSSxHQUFHLEVBQVUsQ0FBQztZQUM1QyxJQUFNLG9CQUFvQixHQUFHLElBQUksR0FBRyxFQUFVLENBQUM7WUFDL0MsSUFBSSxZQUFZLENBQUMsSUFBSSxLQUFLLFNBQVMsQ0FBQyxlQUFlLEVBQUU7Z0JBQ2xELFlBQThCLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLFVBQUEsUUFBUTtvQkFDaEUsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQztpQkFDOUMsQ0FBQyxDQUFDO2FBQ0o7aUJBQU0sSUFBSSxZQUFZLENBQUMsSUFBSSxLQUFLLFNBQVMsQ0FBQyxhQUFhLEVBQUU7Z0JBQ3hELElBQUksQ0FBQyxPQUFPLEdBQUksWUFBK0IsQ0FBQyxPQUFPLENBQUM7YUFDekQ7WUFDRCxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsVUFBQSxrQkFBa0I7Z0JBQzVDLE9BQUEsTUFBTSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFBLFNBQVM7O29CQUMvQyxJQUFJLFNBQVMsS0FBSyxTQUFTLEVBQUU7d0JBQzNCLElBQUkseUJBQVEsSUFBSSxHQUFLLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFFLENBQUM7cUJBQ3REO3lCQUFNLElBQUksWUFBWSxDQUFDLElBQUksS0FBSyxTQUFTLENBQUMsYUFBYSxFQUFFO3dCQUN4RCxJQUFJLHlCQUFRLElBQUksZ0JBQUcsU0FBUyxJQUFHLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxNQUFFLENBQUM7cUJBQ2hFO3lCQUFNLElBQ0wsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQzt3QkFDaEMsQ0FBQyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEVBQ3BDO3dCQUNBLElBQU0sbUJBQW1CLHlCQUNwQixrQkFBa0IsQ0FBQyxTQUFTLENBQUMsS0FDaEMsSUFBSSxFQUFFLFNBQVMsR0FDaEIsQ0FBQzt3QkFDRixJQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO3dCQUMzRCxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7cUJBQ3JDO2lCQUNGLENBQUM7YUFBQSxDQUNILENBQUM7WUFDRixJQUFJLENBQUMsa0JBQWtCLENBQUMsR0FBRyxVQUFVLENBQUM7WUFDdEMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsV0FBVyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsRUFBRSxZQUFZLGNBQUEsRUFBRSxJQUFJLE1BQUEsRUFBRSxDQUFDLENBQUM7WUFDaEUsNkJBQVksSUFBSSxHQUFLLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUc7U0FDckU7Ozs7O1FBTWMsb0JBQUksR0FBbkI7WUFDRSxJQUNFLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEtBQUssU0FBUztnQkFDMUQsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsS0FBSyxTQUFTLEVBQ3REO2dCQUNBLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQywwQ0FBMEMsQ0FBQyxDQUFDO2dCQUMxRSxPQUFPO2FBQ1I7WUFFRCxJQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDO1lBQ2xFLElBQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUM7WUFFMUQsSUFBTSxJQUFJLEdBQUcsZUFBZSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUMzRCxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFBLElBQUk7O2dCQUN6QixJQUFJLGNBQXNCLENBQUM7Z0JBQzNCLElBQUk7b0JBQ0YsSUFBTSxVQUFRLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQ3hDLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLGlCQUFpQixFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FDM0QsQ0FBQztvQkFDRixjQUFjLEdBQUcsVUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUNqQztnQkFBQyxPQUFPLENBQU0sRUFBRTtvQkFDZixNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztvQkFDN0MsY0FBYyxHQUFHLFlBQVksQ0FBQyxhQUFhLENBQUM7aUJBQzdDO2dCQUNELE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxhQUFhLHVCQUN6QyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxnQkFDNUMsSUFBSSxDQUFDLElBQUksSUFBRyxjQUFjLE9BQzNCLENBQUM7YUFDSixDQUFDLENBQUM7WUFDSCxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUNwRCxlQUFlLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztZQUNuQyxNQUFNLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQzNCLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxhQUFhLEVBQ2xELGVBQWUsQ0FBQyxhQUFhLENBQzlCLENBQUM7U0FDSDs7OztRQUtjLDZCQUFhLEdBQTVCOztZQUNFLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxFQUFFO2dCQUNoQyxlQUFlLENBQUMsSUFBSSxFQUFFLENBQUM7YUFDeEI7WUFDRCxJQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDO1lBQ2xFLElBQUksWUFBWSxLQUFLLFNBQVMsRUFBRTtnQkFDOUIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUMzQixvREFBb0QsQ0FDckQsQ0FBQztnQkFDRixPQUFPO2FBQ1I7WUFFRCxJQUFNLElBQUksR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUMxQyxJQUFNLGFBQWEsR0FBRyxNQUFBLE1BQUEsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsMENBQUUsS0FBSyxDQUFDLElBQUksQ0FDeEUsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsSUFBSSxLQUFLLElBQUksR0FBQSxDQUNyQiwwQ0FBRSxRQUFRLENBQUM7WUFFWixJQUNFLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEtBQUssU0FBUztnQkFDeEQsYUFBYSxLQUFLLFNBQVM7Z0JBQzNCLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLEtBQUssU0FBUyxFQUN2RTtnQkFDQSxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsNEJBQTRCLENBQUMsQ0FBQztnQkFDN0QsT0FBTzthQUNSO1lBQ0QsSUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUUzRSxlQUFlLENBQUMsb0JBQW9CLENBQ2xDLFFBQVEsRUFDUixhQUFhLEVBQ2I7Z0JBQ0U7b0JBQ0UsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJO29CQUNwQixLQUFLLEVBQUUsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksRUFBRTtpQkFDekM7YUFDRixFQUNELGVBQWUsQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsQ0FDaEQsQ0FBQztTQUNIO1FBRWMsZ0NBQWdCLEdBQS9CLFVBQWdDLFVBQWtCOztZQUNoRCxJQUFNLGVBQWUsR0FBRyxDQUFDLENBQUEsTUFBQSxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsMENBQ3RFLGtCQUFrQjtnQkFDcEIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLGlCQUFpQixFQUFFLFVBQVUsQ0FBQyxDQUFDO1lBQ2pFLElBQUksZUFBZSxFQUFFO2dCQUNuQixPQUFPLFFBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7YUFDakQ7WUFDRCxPQUFPLElBQUksQ0FBQztTQUNiOzs7Ozs7Ozs7UUFVYyxvQ0FBb0IsR0FBbkMsVUFDRSxRQUFnQixFQUNoQixRQUFnQixFQUNoQixNQUFxQixFQUNyQixhQUFrQztZQURsQyx1QkFBQSxFQUFBLFdBQXFCO1lBR3JCLElBQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDeEQsSUFBSSxhQUFhLEVBQUU7Z0JBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQWEsUUFBUSxzQkFBbUIsQ0FBQyxDQUFDO2FBQ3ZEO2lCQUFNO2dCQUNMLElBQ0UsUUFBUSxLQUFLLFlBQVksQ0FBQyxhQUFhO3FCQUN0QyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUI7d0JBQ2pELENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUNqRDtvQkFDQSxPQUFPO2lCQUNSO2dCQUNELElBQU0sSUFBSSxHQUFHO29CQUNYLE1BQU0sRUFBRSxNQUFNLENBQUMsTUFBTTtpQkFDdEIsQ0FBQztnQkFDRixRQUFRO29CQUNOLGlDQUEwQixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxjQUFXO3dCQUN6RCxrQkFBVyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxjQUFXO3dCQUM3RCxRQUFRLENBQUM7Z0JBQ1gsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FDOUMsUUFBUSxFQUNSLFFBQVEsRUFDUixhQUFhLHlDQUNULE1BQU0sbUJBQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sSUFBSSxFQUFFLFdBQzdELENBQUM7YUFDSDtTQUNGOzs7O1FBS2MsaUNBQWlCLEdBQWhDOztZQUNFLElBQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUM7WUFDbEUsSUFBSSxZQUFZLEtBQUssU0FBUyxFQUFFO2dCQUM5QixNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQzNCLGlFQUFpRSxDQUNsRSxDQUFDO2dCQUNGLE9BQU87YUFDUjtZQUVELElBQU0sSUFBSSxHQUFHLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQzFDLElBQU0sYUFBYSxHQUFHLE1BQUEsTUFBQSxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSwwQ0FBRSxLQUFLLENBQUMsSUFBSSxDQUN4RSxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxHQUFBLENBQ3JCLDBDQUFFLFFBQVEsQ0FBQztZQUVaLGFBQWEsSUFBSSxlQUFlLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1NBQzdEOzs7Ozs7UUFPYywyQkFBVyxHQUExQixVQUEyQixRQUFnQjs7WUFDekMsSUFBTSxhQUFhLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN4RCxNQUFBLGFBQWEsYUFBYixhQUFhLHVCQUFiLGFBQWEsQ0FBRSxhQUFhLDBDQUFFLFdBQVcsQ0FBQyxhQUFhLENBQUMsQ0FBQztTQUMxRDtRQTVTYywyQkFBVyxHQUFHLEtBQUssQ0FBQztRQTZTckMsc0JBQUM7S0E5U0Q7O0lDTkEsTUFBTSxDQUFDLFNBQVMsR0FBRyxVQUFBLENBQUM7OztRQUNsQixJQUFJLENBQUMsQ0FBQyxNQUFNLEtBQUssTUFBTSxFQUFFO1lBQ3ZCLElBQ0UsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLGdCQUFnQjtnQkFDaEQsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLEtBQUssU0FBUyxFQUMzQjtnQkFDQSxPQUFPO2FBQ1I7WUFDRCxJQUFNLFFBQVEsR0FBRyxDQUFBLEtBQUMsTUFBTSxDQUFDLFdBQW1CLEVBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsb0NBQ3RELENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxVQUNqQixDQUFDO1lBQ0YsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTtnQkFDckIsTUFBQSxDQUFDLENBQUMsTUFBTSwwQ0FBRSxXQUFXLHVCQUFNLENBQUMsQ0FBQyxJQUFJLEtBQUUsUUFBUSxVQUFBLEtBQUksRUFBRSxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQzthQUN2RTtTQUNGO0lBQ0gsQ0FBQyxDQUFDO0lBRUYsTUFBTSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUMzQixZQUFZLENBQUMsZ0JBQWdCLEVBQzdCLFVBQUMsRUFBYztZQUFaLFVBQVUsZ0JBQUE7UUFDWCxJQUFNLElBQUksR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUEsUUFBUTtZQUN0QyxJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztTQUNuRCxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDZixDQUFDLENBQ0YsQ0FBQztJQUVGLElBQUksZUFBZSxFQUFFOzs7Ozs7In0=
