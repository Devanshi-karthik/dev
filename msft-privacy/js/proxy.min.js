!function(){"use strict";function a(e){var n={};return e.forEach(function(e,t){Reflect.has(n,t)?(Array.isArray(n[t])||(n[t]=[n[t]]),n[t].push(e)):n[t]=e}),n}function t(e){e.preventDefault(),e=new FormData(e.target),e=a(e),window.MSFTConsent.trigger("QuestionsFormSubmitWithoutMetaData",{data:e})}function e(){var e,o=null!=(e=null==(e=window.msftData)?void 0:e.executionContexts)&&e.length?window.msftData.executionContexts:[];r.forEach(function(e){var t=e.selector,n=e.handler;document.querySelectorAll(t).forEach(function(e){if(0<o.length){var t=e.getAttributeNames();if(o.some(function(e){return t.includes("".concat(e,"-disabled"))}))return}n(e)})}),o.forEach(function(e){document.querySelectorAll("[".concat(e,"-hidden]")).forEach(function(e){e.remove()})})}function n(e){if(e.target&&"a"===e.target.nodeName.toLowerCase()){var t={},n=e.target.getAttributeNames();e.preventDefault(),e.stopPropagation();for(var o=0;o<n.length;o++){var r=n[o];t[r]=e.target.getAttribute(r)||""}window.MSFTConsent.trigger(i.AnchorTagClicked,{attributes:t})}}var i,o,r=[{selector:"[msft-consent-accept-all]",handler:function(e){e.addEventListener("click",function(){window.MSFTConsent.trigger("AcceptAll"),window.MSFTConsent.trigger("CloseConsentNotice")})}},{selector:"[msft-consent-open-preferences]",handler:function(e){e.addEventListener("click",function(){window.MSFTConsent.trigger("ShowTemplate",{templateId:"Preferences"}),window.MSFTConsent.trigger("CloseConsentNotice")})}},{selector:"[msft-consent-decline-all]",handler:function(e){e.addEventListener("click",function(){window.MSFTConsent.trigger("RejectAll"),window.MSFTConsent.trigger("CloseConsentNotice")})}},{selector:"[msft-consent-save-preferences]",handler:function(e){e.addEventListener("click",function(){var e=document.querySelectorAll("[msft-consent-tracker-category]"),t={preferences:{}};e.forEach(function(e){t.preferences[e.getElementsByTagName("input")[0].id]=e.getElementsByTagName("input")[0].checked?"1":"0"}),window.MSFTConsent.trigger("UpdateConsent",{consent:t}),window.MSFTConsent.trigger("CloseTemplate",{templateId:"Preferences"}),window.MSFTConsent.trigger("CloseConsentNotice")})}},{selector:"[msft-consent-close-preferences]",handler:function(e){e.addEventListener("click",function(){window.MSFTConsent.trigger("CloseTemplate",{templateId:"Preferences"}),window.MSFTConsent.trigger("ShowConsentNotice")})}},{selector:"[msft-questionnaire-form]",handler:function(e){e.addEventListener("submit",t)}},{selector:"[msft-consent-open-page]",handler:function(e){var t=e.getAttribute("msft-consent-open-page");null!==t&&e.addEventListener("click",function(){window.MSFTConsent.trigger("ShowTemplate",{templateId:t})})}},{selector:"[msft-consent-close-page]",handler:function(e){var t=e.getAttribute("msft-consent-close-page");null!==t&&e.addEventListener("click",function(){window.MSFTConsent.trigger("CloseTemplate",{templateId:t})})}},{selector:"[msft-consent-trigger-event]",handler:function(e){var t,n,o,r,i=e.getAttribute("msft-consent-trigger-event");null!==i&&(t=e.getAttribute("msft-payload-data"),n=e.getAttribute("msft-payload-form-id"),o=e.getAttribute("msft-payload-input-ids"),(r=null)!==t?r=function(e){try{return JSON.parse(e)}catch(e){return null}}(t):null!==n?r=function(e){try{var t=document.getElementById(e);if(!t)return null;var n=new FormData(t);return a(n)}catch(e){return null}}(n):null!==o&&(r=function(e){try{var t=e.split(","),n={};return t.forEach(function(e){var t=document.getElementById(e);t&&(n[e]=t.value)}),n}catch(e){return null}}(o)),e.addEventListener("click",function(){window.MSFTConsent.trigger(i,r)}))}}],s=(window.disableQuestionFormSubmit=function(){document.querySelectorAll("[msft-questionnaire-form-submit]").forEach(function(e){e.setAttribute("disabled","")})},window.enableQuestionFormSubmit=function(){document.querySelectorAll("[msft-questionnaire-form-submit]").forEach(function(e){e.removeAttribute("disabled")})},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",function(){e()}),null!=(o=window.msftData)&&o.renderTemplateWithoutIframe||(Promise.resolve().then(function(){return s}),Promise.resolve().then(function(){return f}).then(function(e){var o=e.callMethod,r=e.sendMessage;window.MSFTConsent={};["trigger","showChangeSettingsModal"].forEach(function(n){window.MSFTConsent[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r(n,e)}}),["getConsent","getTrackerCategories"].forEach(function(n){window.MSFTConsent[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o(n,e)}})})),(o=i=i||{}).ConsentChanged="ConsentChanged",o.ShowConsentNotice="ShowConsentNotice",o.ShowFirstPage="ShowFirstPage",o.CloseConsentNotice="CloseConsentNotice",o.AcceptAll="AcceptAll",o.RejectAll="RejectAll",o.ShowTemplate="ShowTemplate",o.CloseTemplate="CloseTemplate",o.UpdateConsent="UpdateConsent",o.AnchorTagClicked="AnchorTagClicked",o.FetchConfig="FetchConfig",o.QuestionsFormSubmitWithoutMetaData="QuestionsFormSubmitWithoutMetaData",o.QuestionsFormSubmit="QuestionsFormSubmit",o.ShowPreferences="ShowPreferences",o.ConsentPreference="MSFTConsentPreference",new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"a"===e.nodeName.toLowerCase()&&e.addEventListener("click",{handleEvent:n})})})}).observe(document.documentElement,{childList:!0,subtree:!0}),Object.freeze({__proto__:null}));function c(){}c.deferred=function(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n};function l(e,t,n){parent&&parent.postMessage({method:e,params:Object.values(t),responseId:n},msftData.origin)}var u=c,d={},f=(window.onmessage=function(e){var t;e.origin===msftData.origin&&null!=(t=null==e?void 0:e.data)&&t.responseId&&(e.data.error?d[e.data.responseId].reject(e.data.error):d[e.data.responseId].resolve(e.data.response))},Object.freeze({__proto__:null,sendMessage:l,callMethod:function(e,t){var n="".concat(e,"-").concat((new Date).getTime()),o=u.deferred();return d[n]=o,l(e,t,n),o.promise}}))}();
