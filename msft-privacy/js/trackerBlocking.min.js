(function () {
    'use strict';

    var ConsentModelType;
    (function (ConsentModelType) {
        ConsentModelType["Explicit"] = "Explicit";
        ConsentModelType["Implicit"] = "Implicit";
    })(ConsentModelType || (ConsentModelType = {}));
    var PublicEvents;
    (function (PublicEvents) {
        PublicEvents["ConsentChanged"] = "ConsentChanged";
        PublicEvents["ShowConsentNotice"] = "ShowConsentNotice";
        PublicEvents["ShowFirstPage"] = "ShowFirstPage";
        PublicEvents["CloseConsentNotice"] = "CloseConsentNotice";
        PublicEvents["AcceptAll"] = "AcceptAll";
        PublicEvents["RejectAll"] = "RejectAll";
        PublicEvents["ShowTemplate"] = "ShowTemplate";
        PublicEvents["CloseTemplate"] = "CloseTemplate";
        PublicEvents["UpdateConsent"] = "UpdateConsent";
        PublicEvents["AnchorTagClicked"] = "AnchorTagClicked";
        PublicEvents["FetchConfig"] = "FetchConfig";
        PublicEvents["QuestionsFormSubmitWithoutMetaData"] = "QuestionsFormSubmitWithoutMetaData";
        PublicEvents["QuestionsFormSubmit"] = "QuestionsFormSubmit";
        PublicEvents["ShowPreferences"] = "ShowPreferences";
        PublicEvents["ConsentPreference"] = "MSFTConsentPreference";
    })(PublicEvents || (PublicEvents = {}));
    var Events;
    (function (Events) {
        Events["Init"] = "Init";
        Events["CoreConsentModelSelected"] = "CoreConsentModelSelected";
        Events["ConfigReady"] = "ConfigReady";
    })(Events || (Events = {}));
    var SDKMode;
    (function (SDKMode) {
        SDKMode["Default"] = "Default";
        SDKMode["HeadLess"] = "HeadLess";
    })(SDKMode || (SDKMode = {}));
    var StyleType;
    (function (StyleType) {
        StyleType["Url"] = "Url";
        StyleType["Text"] = "Text";
    })(StyleType || (StyleType = {}));
    var Preference;
    (function (Preference) {
        Preference["OFF"] = "0";
        Preference["ON"] = "1";
    })(Preference || (Preference = {}));
    var Cookie;
    (function (Cookie) {
        Cookie["Consent"] = "msft-consent";
    })(Cookie || (Cookie = {}));
    var RegisteredDivType;
    (function (RegisteredDivType) {
        RegisteredDivType["Script"] = "script";
        RegisteredDivType["IFrame"] = "iframe";
    })(RegisteredDivType || (RegisteredDivType = {}));
    var NoticeType;
    (function (NoticeType) {
        NoticeType["TrackerCategory"] = "trackerCategory";
        NoticeType["Questions"] = "Questions";
    })(NoticeType || (NoticeType = {}));
    var ErrorStrings;
    (function (ErrorStrings) {
        ErrorStrings["TemplateError"] = "<b>There is something wrong with template. Please check logs.</b>";
    })(ErrorStrings || (ErrorStrings = {}));
    var IntervalUnits;
    (function (IntervalUnits) {
        IntervalUnits["day"] = "day";
        IntervalUnits["week"] = "week";
        IntervalUnits["month"] = "month";
        IntervalUnits["year"] = "year";
    })(IntervalUnits || (IntervalUnits = {}));
    var QuestionType;
    (function (QuestionType) {
        QuestionType["Text"] = "Text";
        QuestionType["Email"] = "Email";
        QuestionType["Radio"] = "Radio";
        QuestionType["MultiSelect"] = "MultiSelect";
        QuestionType["Select"] = "Select";
        QuestionType["Date"] = "Date";
        QuestionType["PhoneNumber"] = "PhoneNumber";
        QuestionType["CreditCard"] = "CreditCard";
        QuestionType["Number"] = "Number";
        QuestionType["MultiLineText"] = "multiLineText";
    })(QuestionType || (QuestionType = {}));
    var QuestionValidation;
    (function (QuestionValidation) {
        QuestionValidation["Required"] = "Required";
    })(QuestionValidation || (QuestionValidation = {}));
    var QuestionField;
    (function (QuestionField) {
        QuestionField["Question"] = "question";
        QuestionField["Placeholder"] = "placeholder";
        QuestionField["Options"] = "options";
    })(QuestionField || (QuestionField = {}));
    var ModelKind;
    (function (ModelKind) {
        ModelKind["WebConsentModel"] = "WebConsentModel";
        ModelKind["QuestionModel"] = "DSRSubmissionModel";
    })(ModelKind || (ModelKind = {}));
    var PackageKind;
    (function (PackageKind) {
        PackageKind["WebConsentPackage"] = " WebConsentPackage";
        PackageKind["FIDESPackage"] = "FIDESPackage";
        PackageKind["DSRSubmissionPackage"] = "DSRSubmissionPackage";
    })(PackageKind || (PackageKind = {}));
    var Template;
    (function (Template) {
        Template["Preferences"] = "Preferences";
    })(Template || (Template = {}));

    var BlockingServiceUtil = /** @class */ (function () {
        function BlockingServiceUtil() {
        }
        BlockingServiceUtil.shouldScriptConsented = function (categories) {
            if (categories !== null && categories.split(',').length > 0) {
                return this.consentCategoriesPending(categories);
            }
            return false;
        };
        BlockingServiceUtil.shouldIFrameConsented = function (categories) {
            if (categories !== null && categories.split(',').length > 0) {
                return this.consentCategoriesPending(categories);
            }
            return false;
        };
        BlockingServiceUtil.consentCategoriesPending = function (categories) {
            if (categories != null) {
                var pendingConsent = categories
                    .split(',')
                    .filter(function (x) {
                    var _a;
                    return !(((_a = window.__MSFT_SDK.Store.getters.userConsent) === null || _a === void 0 ? void 0 : _a.preferences[x]) ===
                        Preference.ON);
                });
                return pendingConsent != null && pendingConsent.length > 0;
            }
            return false;
        };
        BlockingServiceUtil.shouldbeUnblocked = function (msftConsentCategories) {
            if (msftConsentCategories != null) {
                var pendingConsent = msftConsentCategories
                    .split(',')
                    .filter(function (x) {
                    var _a;
                    return !(((_a = window.__MSFT_SDK.Store.getters.userConsent) === null || _a === void 0 ? void 0 : _a.preferences[x]) ===
                        Preference.ON);
                });
                return pendingConsent == null || pendingConsent.length == 0;
            }
            return true;
        };
        BlockingServiceUtil.shouldScriptUnblocked = function (type, msftConsentCategories) {
            if (type !== null && type === this.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE) {
                return this.shouldbeUnblocked(msftConsentCategories);
            }
            return false;
        };
        BlockingServiceUtil.shouldIFrameUnblocked = function (dataSrc, msftConsentCategories) {
            if (dataSrc !== null) {
                return this.shouldbeUnblocked(msftConsentCategories);
            }
            return false;
        };
        BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE = 'text/blocked';
        BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE = 'msft-consent-categories';
        BlockingServiceUtil.SRC_ATTRIBUTE = 'src';
        BlockingServiceUtil.DATASET_SRC_ATTRIBUTE = 'data-src';
        BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE = 'type';
        BlockingServiceUtil.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE = 'msft-post-consent-type';
        BlockingServiceUtil.MSFT_CONSENT_IGNORE_ATTRIBUTE = 'msft-ignore-consent';
        return BlockingServiceUtil;
    }());

    var BlockingService = /** @class */ (function () {
        function BlockingService() {
            this.domObserver = null;
        }
        BlockingService.mutationCallback = function (mutationRecords) {
            mutationRecords.forEach(function (mutationRecord) {
                mutationRecord.addedNodes.forEach(function (addedNode) {
                    try {
                        if (addedNode.nodeType === 1 &&
                            addedNode.hasAttribute(BlockingServiceUtil.MSFT_CONSENT_IGNORE_ATTRIBUTE) === false) {
                            if (addedNode.nodeName.toLowerCase() ===
                                window.__MSFT_SDK.enums.RegisteredDivType.Script) {
                                BlockingService.scriptMutationObserver(addedNode);
                            }
                            else if (addedNode.nodeName.toLowerCase() ===
                                window.__MSFT_SDK.enums.RegisteredDivType.IFrame) {
                                BlockingService.iframeMutationObserver(addedNode);
                            }
                        }
                    }
                    catch (error) {
                        console.warn('Failed to block the node ', addedNode.nodeName, 'with error ', error);
                        window.__MSFT_SDK.Logger.warn('Failed to block tag ' + addedNode.nodeName);
                    }
                });
            });
        };
        BlockingService.scriptMutationObserver = function (scriptNode) {
            var type = scriptNode.type;
            var msftConsentCategories = scriptNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
            if (BlockingServiceUtil.shouldScriptConsented(msftConsentCategories)) {
                scriptNode.setAttribute(BlockingServiceUtil.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE, type);
                scriptNode.setAttribute(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE, BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE);
            }
            // Firefox has this additional event which prevents scripts from being executed
            var beforeScriptExecuteListener = function (event) {
                // Prevent only marked scripts from executing
                if (scriptNode.getAttribute(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE) ===
                    BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE)
                    event.preventDefault();
                scriptNode.removeEventListener('beforescriptexecute', beforeScriptExecuteListener);
            };
            scriptNode.addEventListener('beforescriptexecute', beforeScriptExecuteListener);
        };
        BlockingService.iframeMutationObserver = function (iframeNode) {
            var src = iframeNode.src;
            var msftConsentCategories = iframeNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
            if (BlockingServiceUtil.shouldIFrameConsented(msftConsentCategories)) {
                iframeNode.removeAttribute(BlockingServiceUtil.SRC_ATTRIBUTE);
                iframeNode.setAttribute(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE, src);
            }
        };
        BlockingService.unblock = function () {
            window.__MSFT_SDK.Logger.info('Tracker Blocking unblock is started');
            BlockingService.unblockScripts();
            BlockingService.unblockIFrames();
        };
        BlockingService.unblockScripts = function () {
            document
                .querySelectorAll("script[".concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "][").concat(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE, "=\"").concat(BlockingServiceUtil.SCRIPT_BLOCKING_TYPE_ATTRIBUTE_VALUE, "\"]:not([").concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "=\"\"])"))
                .forEach(function (blockedNode) {
                var scriptNode = blockedNode;
                try {
                    var consentCategories = scriptNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
                    var notConsentedCategories = consentCategories === null || consentCategories === void 0 ? void 0 : consentCategories.split(',').filter(function (x) {
                        var _a;
                        return !(((_a = window.__MSFT_SDK.Store.getters.userConsent) === null || _a === void 0 ? void 0 : _a.preferences[x]) === Preference.ON);
                    });
                    if (notConsentedCategories == null ||
                        notConsentedCategories.length === 0) {
                        var typeValue = scriptNode.getAttribute(BlockingServiceUtil.MSFT_POST_CONSENT_SCRIPT_TYPE_ATTRIBUTE);
                        typeValue =
                            typeValue != null ? typeValue : 'application/javascript';
                        var parentNode = scriptNode.parentNode;
                        parentNode === null || parentNode === void 0 ? void 0 : parentNode.removeChild(scriptNode);
                        var newNode = document.createElement('script');
                        for (var i = 0; i < scriptNode.attributes.length; i++) {
                            var attribute = scriptNode.attributes[i];
                            if (attribute.name !== 'type') {
                                newNode.setAttribute(attribute.name, scriptNode.attributes[i].value);
                            }
                            else {
                                newNode.setAttribute(BlockingServiceUtil.SCRIPT_TYPE_ATTRIBUTE, typeValue);
                            }
                        }
                        newNode.appendChild(document.createTextNode(scriptNode.innerHTML));
                        parentNode == null
                            ? document.head.appendChild(newNode)
                            : parentNode.appendChild(newNode);
                    }
                    else {
                        window.__MSFT_SDK.Logger.info('Failed to unblock script ' +
                            scriptNode.src +
                            'not consented for categories ' +
                            (notConsentedCategories === null || notConsentedCategories === void 0 ? void 0 : notConsentedCategories.toString()));
                    }
                }
                catch (error) {
                    // eslint-disable-next-line
                    console.warn('Failed to unblock the script ', scriptNode.src, 'with error ', error);
                    window.__MSFT_SDK.Logger.error('Failed to unblock script ' + scriptNode.src);
                }
            });
        };
        BlockingService.unblockIFrames = function () {
            document
                .querySelectorAll("iframe[".concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "][").concat(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE, "]:not([").concat(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE, "=\"\"][").concat(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE, "=\"\"])"))
                .forEach(function (blockedNode) {
                var iframeNode = blockedNode;
                try {
                    var consentCategories = iframeNode.getAttribute(BlockingServiceUtil.MSFT_CONSENT_CATEGORIES_ATTRIBUTE);
                    var notConsentedCategories = consentCategories === null || consentCategories === void 0 ? void 0 : consentCategories.split(',').filter(function (x) {
                        var _a;
                        return !(((_a = window.__MSFT_SDK.Store.getters.userConsent) === null || _a === void 0 ? void 0 : _a.preferences[x]) === Preference.ON);
                    });
                    if (notConsentedCategories == null ||
                        notConsentedCategories.length === 0) {
                        var parentNode = iframeNode.parentNode;
                        parentNode === null || parentNode === void 0 ? void 0 : parentNode.removeChild(iframeNode);
                        var newNode = iframeNode.cloneNode(true);
                        var datasrc = newNode.getAttribute(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE);
                        datasrc = datasrc !== null ? datasrc : '';
                        newNode.setAttribute(BlockingServiceUtil.SRC_ATTRIBUTE, datasrc);
                        newNode.removeAttribute(BlockingServiceUtil.DATASET_SRC_ATTRIBUTE);
                        parentNode == null
                            ? document.head.appendChild(newNode)
                            : parentNode.appendChild(newNode);
                    }
                    else {
                        window.__MSFT_SDK.Logger.info('Failed to unblock iframe ' +
                            iframeNode.src +
                            'not consented for categories ' +
                            (notConsentedCategories === null || notConsentedCategories === void 0 ? void 0 : notConsentedCategories.toString()));
                    }
                }
                catch (error) {
                    // eslint-disable-next-line
                    console.warn('Failed to unblock the iframe ', iframeNode.src, 'with error ', error);
                    window.__MSFT_SDK.Logger.error('Failed to unblock iFrame ' + iframeNode.src);
                }
            });
        };
        BlockingService.prototype.start = function (enableMutationObserver) {
            window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ConsentChanged, BlockingService.unblock);
            this.domObserver = null;
            if (enableMutationObserver) {
                this.domObserver = new MutationObserver(function (mutationRecords) {
                    return BlockingService.mutationCallback(mutationRecords);
                });
                this.domObserver.observe(document.documentElement, {
                    childList: true,
                    subtree: true,
                });
                window.__MSFT_SDK.Logger.info('Started tracker blocking service');
            }
        };
        return BlockingService;
    }());
    var BlockingServiceInstance = new BlockingService();

    var PublicAPI = /** @class */ (function () {
        function PublicAPI() {
        }
        PublicAPI.getBlockingService = function () {
            return BlockingServiceInstance;
        };
        return PublicAPI;
    }());

    var _a;
    window.__MSFT_SDK.Helpers.AddPublicApis(PublicAPI);
    window.__MSFT_SDK.Helpers.exposeApis();
    if ((_a = window.__MSFT_SDK.Store.getters.packageConfigurations
        .isTrackerBlockingEnabled) !== null && _a !== void 0 ? _a : true) {
        PublicAPI.getBlockingService().start(true);
    }

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhY2tlckJsb2NraW5nLm1pbi5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vU0RLL3NyYy9jb3JlL2NvbnN0YW50cy9lbnVtcy50cyIsIi4uLy4uLy4uLy4uLy4uL1NESy9zcmMvdHJhY2tlckJsb2NraW5nL0Jsb2NraW5nU2VydmljZVV0aWwudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3RyYWNrZXJCbG9ja2luZy9CbG9ja2luZ1NlcnZpY2UudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3RyYWNrZXJCbG9ja2luZy9wdWJsaWNBcGkvaW5kZXgudHMiLCIuLi8uLi8uLi8uLi8uLi9TREsvc3JjL3RyYWNrZXJCbG9ja2luZy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZW51bSBDb25zZW50TW9kZWxUeXBlIHtcclxuICBFeHBsaWNpdCA9ICdFeHBsaWNpdCcsXHJcbiAgSW1wbGljaXQgPSAnSW1wbGljaXQnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBQdWJsaWNFdmVudHMge1xyXG4gIENvbnNlbnRDaGFuZ2VkID0gJ0NvbnNlbnRDaGFuZ2VkJyxcclxuICBTaG93Q29uc2VudE5vdGljZSA9ICdTaG93Q29uc2VudE5vdGljZScsXHJcbiAgU2hvd0ZpcnN0UGFnZSA9ICdTaG93Rmlyc3RQYWdlJyxcclxuICBDbG9zZUNvbnNlbnROb3RpY2UgPSAnQ2xvc2VDb25zZW50Tm90aWNlJyxcclxuICBBY2NlcHRBbGwgPSAnQWNjZXB0QWxsJyxcclxuICBSZWplY3RBbGwgPSAnUmVqZWN0QWxsJyxcclxuICBTaG93VGVtcGxhdGUgPSAnU2hvd1RlbXBsYXRlJyxcclxuICBDbG9zZVRlbXBsYXRlID0gJ0Nsb3NlVGVtcGxhdGUnLFxyXG4gIFVwZGF0ZUNvbnNlbnQgPSAnVXBkYXRlQ29uc2VudCcsXHJcbiAgQW5jaG9yVGFnQ2xpY2tlZCA9ICdBbmNob3JUYWdDbGlja2VkJyxcclxuICBGZXRjaENvbmZpZyA9ICdGZXRjaENvbmZpZycsXHJcbiAgUXVlc3Rpb25zRm9ybVN1Ym1pdFdpdGhvdXRNZXRhRGF0YSA9ICdRdWVzdGlvbnNGb3JtU3VibWl0V2l0aG91dE1ldGFEYXRhJyxcclxuICBRdWVzdGlvbnNGb3JtU3VibWl0ID0gJ1F1ZXN0aW9uc0Zvcm1TdWJtaXQnLFxyXG4gIFNob3dQcmVmZXJlbmNlcyA9ICdTaG93UHJlZmVyZW5jZXMnLFxyXG4gIENvbnNlbnRQcmVmZXJlbmNlID0gJ01TRlRDb25zZW50UHJlZmVyZW5jZScsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEV2ZW50cyB7XHJcbiAgSW5pdCA9ICdJbml0JyxcclxuICBDb3JlQ29uc2VudE1vZGVsU2VsZWN0ZWQgPSAnQ29yZUNvbnNlbnRNb2RlbFNlbGVjdGVkJyxcclxuICBDb25maWdSZWFkeSA9ICdDb25maWdSZWFkeScsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFNES01vZGUge1xyXG4gIERlZmF1bHQgPSAnRGVmYXVsdCcsXHJcbiAgSGVhZExlc3MgPSAnSGVhZExlc3MnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBTdHlsZVR5cGUge1xyXG4gIFVybCA9ICdVcmwnLFxyXG4gIFRleHQgPSAnVGV4dCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFByZWZlcmVuY2Uge1xyXG4gIE9GRiA9ICcwJyxcclxuICBPTiA9ICcxJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gQ29va2llIHtcclxuICBDb25zZW50ID0gJ21zZnQtY29uc2VudCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFJlZ2lzdGVyZWREaXZUeXBlIHtcclxuICBTY3JpcHQgPSAnc2NyaXB0JyxcclxuICBJRnJhbWUgPSAnaWZyYW1lJyxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gTm90aWNlVHlwZSB7XHJcbiAgVHJhY2tlckNhdGVnb3J5ID0gJ3RyYWNrZXJDYXRlZ29yeScsXHJcbiAgUXVlc3Rpb25zID0gJ1F1ZXN0aW9ucycsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEVycm9yU3RyaW5ncyB7XHJcbiAgVGVtcGxhdGVFcnJvciA9ICc8Yj5UaGVyZSBpcyBzb21ldGhpbmcgd3Jvbmcgd2l0aCB0ZW1wbGF0ZS4gUGxlYXNlIGNoZWNrIGxvZ3MuPC9iPicsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEludGVydmFsVW5pdHMge1xyXG4gIGRheSA9ICdkYXknLFxyXG4gIHdlZWsgPSAnd2VlaycsXHJcbiAgbW9udGggPSAnbW9udGgnLFxyXG4gIHllYXIgPSAneWVhcicsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFF1ZXN0aW9uVHlwZSB7XHJcbiAgVGV4dCA9ICdUZXh0JyxcclxuICBFbWFpbCA9ICdFbWFpbCcsXHJcbiAgUmFkaW8gPSAnUmFkaW8nLFxyXG4gIE11bHRpU2VsZWN0ID0gJ011bHRpU2VsZWN0JyxcclxuICBTZWxlY3QgPSAnU2VsZWN0JyxcclxuICBEYXRlID0gJ0RhdGUnLFxyXG4gIFBob25lTnVtYmVyID0gJ1Bob25lTnVtYmVyJyxcclxuICBDcmVkaXRDYXJkID0gJ0NyZWRpdENhcmQnLFxyXG4gIE51bWJlciA9ICdOdW1iZXInLFxyXG4gIE11bHRpTGluZVRleHQgPSAnbXVsdGlMaW5lVGV4dCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFF1ZXN0aW9uVmFsaWRhdGlvbiB7XHJcbiAgUmVxdWlyZWQgPSAnUmVxdWlyZWQnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBRdWVzdGlvbkZpZWxkIHtcclxuICBRdWVzdGlvbiA9ICdxdWVzdGlvbicsXHJcbiAgUGxhY2Vob2xkZXIgPSAncGxhY2Vob2xkZXInLFxyXG4gIE9wdGlvbnMgPSAnb3B0aW9ucycsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIE1vZGVsS2luZCB7XHJcbiAgV2ViQ29uc2VudE1vZGVsID0gJ1dlYkNvbnNlbnRNb2RlbCcsXHJcbiAgUXVlc3Rpb25Nb2RlbCA9ICdEU1JTdWJtaXNzaW9uTW9kZWwnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBQYWNrYWdlS2luZCB7XHJcbiAgV2ViQ29uc2VudFBhY2thZ2UgPSAnIFdlYkNvbnNlbnRQYWNrYWdlJyxcclxuICBGSURFU1BhY2thZ2UgPSAnRklERVNQYWNrYWdlJyxcclxuICBEU1JTdWJtaXNzaW9uUGFja2FnZSA9ICdEU1JTdWJtaXNzaW9uUGFja2FnZScsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFRlbXBsYXRlIHtcclxuICBQcmVmZXJlbmNlcyA9ICdQcmVmZXJlbmNlcycsXHJcbn1cclxuIiwiaW1wb3J0IHsgUHJlZmVyZW5jZSB9IGZyb20gJ2NvcmUvY29uc3RhbnRzL2VudW1zJztcclxuXHJcbmV4cG9ydCBjbGFzcyBCbG9ja2luZ1NlcnZpY2VVdGlsIHtcclxuICBzdGF0aWMgU0NSSVBUX0JMT0NLSU5HX1RZUEVfQVRUUklCVVRFX1ZBTFVFID0gJ3RleHQvYmxvY2tlZCc7XHJcbiAgc3RhdGljIE1TRlRfQ09OU0VOVF9DQVRFR09SSUVTX0FUVFJJQlVURSA9ICdtc2Z0LWNvbnNlbnQtY2F0ZWdvcmllcyc7XHJcbiAgc3RhdGljIFNSQ19BVFRSSUJVVEUgPSAnc3JjJztcclxuICBzdGF0aWMgREFUQVNFVF9TUkNfQVRUUklCVVRFID0gJ2RhdGEtc3JjJztcclxuICBzdGF0aWMgU0NSSVBUX1RZUEVfQVRUUklCVVRFID0gJ3R5cGUnO1xyXG4gIHN0YXRpYyBNU0ZUX1BPU1RfQ09OU0VOVF9TQ1JJUFRfVFlQRV9BVFRSSUJVVEUgPSAnbXNmdC1wb3N0LWNvbnNlbnQtdHlwZSc7XHJcbiAgc3RhdGljIE1TRlRfQ09OU0VOVF9JR05PUkVfQVRUUklCVVRFID0gJ21zZnQtaWdub3JlLWNvbnNlbnQnO1xyXG5cclxuICBzdGF0aWMgc2hvdWxkU2NyaXB0Q29uc2VudGVkKGNhdGVnb3JpZXM6IHN0cmluZyB8IG51bGwpOiBib29sZWFuIHtcclxuICAgIGlmIChjYXRlZ29yaWVzICE9PSBudWxsICYmIGNhdGVnb3JpZXMuc3BsaXQoJywnKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNvbnNlbnRDYXRlZ29yaWVzUGVuZGluZyhjYXRlZ29yaWVzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBzaG91bGRJRnJhbWVDb25zZW50ZWQoY2F0ZWdvcmllczogc3RyaW5nIHwgbnVsbCk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKGNhdGVnb3JpZXMgIT09IG51bGwgJiYgY2F0ZWdvcmllcy5zcGxpdCgnLCcpLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY29uc2VudENhdGVnb3JpZXNQZW5kaW5nKGNhdGVnb3JpZXMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGNvbnNlbnRDYXRlZ29yaWVzUGVuZGluZyhjYXRlZ29yaWVzOiBzdHJpbmcgfCBudWxsKTogYm9vbGVhbiB7XHJcbiAgICBpZiAoY2F0ZWdvcmllcyAhPSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHBlbmRpbmdDb25zZW50ID0gY2F0ZWdvcmllc1xyXG4gICAgICAgIC5zcGxpdCgnLCcpXHJcbiAgICAgICAgLmZpbHRlcihcclxuICAgICAgICAgIHggPT5cclxuICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLnVzZXJDb25zZW50Py5wcmVmZXJlbmNlc1t4XSA9PT1cclxuICAgICAgICAgICAgICBQcmVmZXJlbmNlLk9OXHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgKTtcclxuICAgICAgcmV0dXJuIHBlbmRpbmdDb25zZW50ICE9IG51bGwgJiYgcGVuZGluZ0NvbnNlbnQubGVuZ3RoID4gMDtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBzaG91bGRiZVVuYmxvY2tlZChtc2Z0Q29uc2VudENhdGVnb3JpZXM6IHN0cmluZyB8IG51bGwpIHtcclxuICAgIGlmIChtc2Z0Q29uc2VudENhdGVnb3JpZXMgIT0gbnVsbCkge1xyXG4gICAgICBjb25zdCBwZW5kaW5nQ29uc2VudCA9IG1zZnRDb25zZW50Q2F0ZWdvcmllc1xyXG4gICAgICAgIC5zcGxpdCgnLCcpXHJcbiAgICAgICAgLmZpbHRlcihcclxuICAgICAgICAgIHggPT5cclxuICAgICAgICAgICAgIShcclxuICAgICAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5TdG9yZS5nZXR0ZXJzLnVzZXJDb25zZW50Py5wcmVmZXJlbmNlc1t4XSA9PT1cclxuICAgICAgICAgICAgICBQcmVmZXJlbmNlLk9OXHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgKTtcclxuICAgICAgcmV0dXJuIHBlbmRpbmdDb25zZW50ID09IG51bGwgfHwgcGVuZGluZ0NvbnNlbnQubGVuZ3RoID09IDA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBzaG91bGRTY3JpcHRVbmJsb2NrZWQoXHJcbiAgICB0eXBlOiBzdHJpbmcgfCBudWxsLFxyXG4gICAgbXNmdENvbnNlbnRDYXRlZ29yaWVzOiBzdHJpbmcgfCBudWxsLFxyXG4gICk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKHR5cGUgIT09IG51bGwgJiYgdHlwZSA9PT0gdGhpcy5TQ1JJUFRfQkxPQ0tJTkdfVFlQRV9BVFRSSUJVVEVfVkFMVUUpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc2hvdWxkYmVVbmJsb2NrZWQobXNmdENvbnNlbnRDYXRlZ29yaWVzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBzaG91bGRJRnJhbWVVbmJsb2NrZWQoXHJcbiAgICBkYXRhU3JjOiBzdHJpbmcgfCBudWxsLFxyXG4gICAgbXNmdENvbnNlbnRDYXRlZ29yaWVzOiBzdHJpbmcgfCBudWxsLFxyXG4gICk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKGRhdGFTcmMgIT09IG51bGwpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc2hvdWxkYmVVbmJsb2NrZWQobXNmdENvbnNlbnRDYXRlZ29yaWVzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJlZmVyZW5jZSB9IGZyb20gJ2NvcmUvY29uc3RhbnRzL2VudW1zJztcclxuaW1wb3J0IHsgQmxvY2tpbmdTZXJ2aWNlVXRpbCB9IGZyb20gJy4vQmxvY2tpbmdTZXJ2aWNlVXRpbCc7XHJcblxyXG5leHBvcnQgY2xhc3MgQmxvY2tpbmdTZXJ2aWNlIHtcclxuICBwcml2YXRlIGRvbU9ic2VydmVyOiBNdXRhdGlvbk9ic2VydmVyIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIG11dGF0aW9uQ2FsbGJhY2sobXV0YXRpb25SZWNvcmRzOiBNdXRhdGlvblJlY29yZFtdKTogdm9pZCB7XHJcbiAgICBtdXRhdGlvblJlY29yZHMuZm9yRWFjaChtdXRhdGlvblJlY29yZCA9PiB7XHJcbiAgICAgIG11dGF0aW9uUmVjb3JkLmFkZGVkTm9kZXMuZm9yRWFjaChhZGRlZE5vZGUgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGFkZGVkTm9kZS5ub2RlVHlwZSA9PT0gMSAmJlxyXG4gICAgICAgICAgICAoPEhUTUxFbGVtZW50PmFkZGVkTm9kZSkuaGFzQXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuTVNGVF9DT05TRU5UX0lHTk9SRV9BVFRSSUJVVEUsXHJcbiAgICAgICAgICAgICkgPT09IGZhbHNlXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgIGFkZGVkTm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PVxyXG4gICAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLmVudW1zLlJlZ2lzdGVyZWREaXZUeXBlLlNjcmlwdFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICBCbG9ja2luZ1NlcnZpY2Uuc2NyaXB0TXV0YXRpb25PYnNlcnZlcihcclxuICAgICAgICAgICAgICAgIDxIVE1MU2NyaXB0RWxlbWVudD5hZGRlZE5vZGUsXHJcbiAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChcclxuICAgICAgICAgICAgICBhZGRlZE5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT1cclxuICAgICAgICAgICAgICB3aW5kb3cuX19NU0ZUX1NESy5lbnVtcy5SZWdpc3RlcmVkRGl2VHlwZS5JRnJhbWVcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlLmlmcmFtZU11dGF0aW9uT2JzZXJ2ZXIoXHJcbiAgICAgICAgICAgICAgICA8SFRNTElGcmFtZUVsZW1lbnQ+YWRkZWROb2RlLFxyXG4gICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKFxyXG4gICAgICAgICAgICAnRmFpbGVkIHRvIGJsb2NrIHRoZSBub2RlICcsXHJcbiAgICAgICAgICAgIGFkZGVkTm9kZS5ub2RlTmFtZSxcclxuICAgICAgICAgICAgJ3dpdGggZXJyb3IgJyxcclxuICAgICAgICAgICAgZXJyb3IsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLndhcm4oXHJcbiAgICAgICAgICAgICdGYWlsZWQgdG8gYmxvY2sgdGFnICcgKyBhZGRlZE5vZGUubm9kZU5hbWUsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIHNjcmlwdE11dGF0aW9uT2JzZXJ2ZXIoc2NyaXB0Tm9kZTogSFRNTFNjcmlwdEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHR5cGUgPSBzY3JpcHROb2RlLnR5cGU7XHJcbiAgICBjb25zdCBtc2Z0Q29uc2VudENhdGVnb3JpZXMgPSBzY3JpcHROb2RlLmdldEF0dHJpYnV0ZShcclxuICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEUsXHJcbiAgICApO1xyXG4gICAgaWYgKEJsb2NraW5nU2VydmljZVV0aWwuc2hvdWxkU2NyaXB0Q29uc2VudGVkKG1zZnRDb25zZW50Q2F0ZWdvcmllcykpIHtcclxuICAgICAgc2NyaXB0Tm9kZS5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX1BPU1RfQ09OU0VOVF9TQ1JJUFRfVFlQRV9BVFRSSUJVVEUsXHJcbiAgICAgICAgdHlwZSxcclxuICAgICAgKTtcclxuICAgICAgc2NyaXB0Tm9kZS5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfVFlQRV9BVFRSSUJVVEUsXHJcbiAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfQkxPQ0tJTkdfVFlQRV9BVFRSSUJVVEVfVkFMVUUsXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmlyZWZveCBoYXMgdGhpcyBhZGRpdGlvbmFsIGV2ZW50IHdoaWNoIHByZXZlbnRzIHNjcmlwdHMgZnJvbSBiZWluZyBleGVjdXRlZFxyXG4gICAgY29uc3QgYmVmb3JlU2NyaXB0RXhlY3V0ZUxpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50OiBhbnkpIHtcclxuICAgICAgLy8gUHJldmVudCBvbmx5IG1hcmtlZCBzY3JpcHRzIGZyb20gZXhlY3V0aW5nXHJcbiAgICAgIGlmIChcclxuICAgICAgICBzY3JpcHROb2RlLmdldEF0dHJpYnV0ZShCbG9ja2luZ1NlcnZpY2VVdGlsLlNDUklQVF9UWVBFX0FUVFJJQlVURSkgPT09XHJcbiAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfQkxPQ0tJTkdfVFlQRV9BVFRSSUJVVEVfVkFMVUVcclxuICAgICAgKVxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHNjcmlwdE5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAnYmVmb3Jlc2NyaXB0ZXhlY3V0ZScsXHJcbiAgICAgICAgYmVmb3JlU2NyaXB0RXhlY3V0ZUxpc3RlbmVyLFxyXG4gICAgICApO1xyXG4gICAgfTtcclxuICAgIHNjcmlwdE5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgJ2JlZm9yZXNjcmlwdGV4ZWN1dGUnLFxyXG4gICAgICBiZWZvcmVTY3JpcHRFeGVjdXRlTGlzdGVuZXIsXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgaWZyYW1lTXV0YXRpb25PYnNlcnZlcihpZnJhbWVOb2RlOiBIVE1MSUZyYW1lRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3JjID0gaWZyYW1lTm9kZS5zcmM7XHJcbiAgICBjb25zdCBtc2Z0Q29uc2VudENhdGVnb3JpZXMgPSBpZnJhbWVOb2RlLmdldEF0dHJpYnV0ZShcclxuICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEUsXHJcbiAgICApO1xyXG4gICAgaWYgKEJsb2NraW5nU2VydmljZVV0aWwuc2hvdWxkSUZyYW1lQ29uc2VudGVkKG1zZnRDb25zZW50Q2F0ZWdvcmllcykpIHtcclxuICAgICAgaWZyYW1lTm9kZS5yZW1vdmVBdHRyaWJ1dGUoQmxvY2tpbmdTZXJ2aWNlVXRpbC5TUkNfQVRUUklCVVRFKTtcclxuICAgICAgaWZyYW1lTm9kZS5zZXRBdHRyaWJ1dGUoQmxvY2tpbmdTZXJ2aWNlVXRpbC5EQVRBU0VUX1NSQ19BVFRSSUJVVEUsIHNyYyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHN0YXRpYyB1bmJsb2NrKCk6IHZvaWQge1xyXG4gICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLmluZm8oJ1RyYWNrZXIgQmxvY2tpbmcgdW5ibG9jayBpcyBzdGFydGVkJyk7XHJcbiAgICBCbG9ja2luZ1NlcnZpY2UudW5ibG9ja1NjcmlwdHMoKTtcclxuICAgIEJsb2NraW5nU2VydmljZS51bmJsb2NrSUZyYW1lcygpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgdW5ibG9ja1NjcmlwdHMoKTogdm9pZCB7XHJcbiAgICBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgICBgc2NyaXB0WyR7QmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEV9XVske0Jsb2NraW5nU2VydmljZVV0aWwuU0NSSVBUX1RZUEVfQVRUUklCVVRFfT1cIiR7QmxvY2tpbmdTZXJ2aWNlVXRpbC5TQ1JJUFRfQkxPQ0tJTkdfVFlQRV9BVFRSSUJVVEVfVkFMVUV9XCJdOm5vdChbJHtCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfQ09OU0VOVF9DQVRFR09SSUVTX0FUVFJJQlVURX09XCJcIl0pYCxcclxuICAgICAgKVxyXG4gICAgICAuZm9yRWFjaChibG9ja2VkTm9kZSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc2NyaXB0Tm9kZSA9IDxIVE1MU2NyaXB0RWxlbWVudD5ibG9ja2VkTm9kZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgY29uc2VudENhdGVnb3JpZXMgPSBzY3JpcHROb2RlLmdldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEUsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29uc3Qgbm90Q29uc2VudGVkQ2F0ZWdvcmllcyA9IGNvbnNlbnRDYXRlZ29yaWVzXHJcbiAgICAgICAgICAgID8uc3BsaXQoJywnKVxyXG4gICAgICAgICAgICAuZmlsdGVyKFxyXG4gICAgICAgICAgICAgIHggPT5cclxuICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMudXNlckNvbnNlbnQ/LnByZWZlcmVuY2VzW1xyXG4gICAgICAgICAgICAgICAgICAgIHhcclxuICAgICAgICAgICAgICAgICAgXSA9PT0gUHJlZmVyZW5jZS5PTlxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgbm90Q29uc2VudGVkQ2F0ZWdvcmllcyA9PSBudWxsIHx8XHJcbiAgICAgICAgICAgIG5vdENvbnNlbnRlZENhdGVnb3JpZXMubGVuZ3RoID09PSAwXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgbGV0IHR5cGVWYWx1ZSA9IHNjcmlwdE5vZGUuZ2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuTVNGVF9QT1NUX0NPTlNFTlRfU0NSSVBUX1RZUEVfQVRUUklCVVRFLFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0eXBlVmFsdWUgPVxyXG4gICAgICAgICAgICAgIHR5cGVWYWx1ZSAhPSBudWxsID8gdHlwZVZhbHVlIDogJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnO1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlID0gc2NyaXB0Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICBwYXJlbnROb2RlPy5yZW1vdmVDaGlsZChzY3JpcHROb2RlKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY3JpcHROb2RlLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBzY3JpcHROb2RlLmF0dHJpYnV0ZXNbaV07XHJcbiAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lICE9PSAndHlwZScpIHtcclxuICAgICAgICAgICAgICAgIG5ld05vZGUuc2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUubmFtZSxcclxuICAgICAgICAgICAgICAgICAgc2NyaXB0Tm9kZS5hdHRyaWJ1dGVzW2ldLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3Tm9kZS5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgICAgICAgICAgIEJsb2NraW5nU2VydmljZVV0aWwuU0NSSVBUX1RZUEVfQVRUUklCVVRFLFxyXG4gICAgICAgICAgICAgICAgICB0eXBlVmFsdWUsXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBuZXdOb2RlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHNjcmlwdE5vZGUuaW5uZXJIVE1MKSk7XHJcbiAgICAgICAgICAgIHBhcmVudE5vZGUgPT0gbnVsbFxyXG4gICAgICAgICAgICAgID8gZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChuZXdOb2RlKVxyXG4gICAgICAgICAgICAgIDogcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLkxvZ2dlci5pbmZvKFxyXG4gICAgICAgICAgICAgICdGYWlsZWQgdG8gdW5ibG9jayBzY3JpcHQgJyArXHJcbiAgICAgICAgICAgICAgICBzY3JpcHROb2RlLnNyYyArXHJcbiAgICAgICAgICAgICAgICAnbm90IGNvbnNlbnRlZCBmb3IgY2F0ZWdvcmllcyAnICtcclxuICAgICAgICAgICAgICAgIG5vdENvbnNlbnRlZENhdGVnb3JpZXM/LnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxyXG4gICAgICAgICAgY29uc29sZS53YXJuKFxyXG4gICAgICAgICAgICAnRmFpbGVkIHRvIHVuYmxvY2sgdGhlIHNjcmlwdCAnLFxyXG4gICAgICAgICAgICBzY3JpcHROb2RlLnNyYyxcclxuICAgICAgICAgICAgJ3dpdGggZXJyb3IgJyxcclxuICAgICAgICAgICAgZXJyb3IsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLmVycm9yKFxyXG4gICAgICAgICAgICAnRmFpbGVkIHRvIHVuYmxvY2sgc2NyaXB0ICcgKyBzY3JpcHROb2RlLnNyYyxcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIHVuYmxvY2tJRnJhbWVzKCk6IHZvaWQge1xyXG4gICAgZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgICAgYGlmcmFtZVske0Jsb2NraW5nU2VydmljZVV0aWwuTVNGVF9DT05TRU5UX0NBVEVHT1JJRVNfQVRUUklCVVRFfV1bJHtCbG9ja2luZ1NlcnZpY2VVdGlsLkRBVEFTRVRfU1JDX0FUVFJJQlVURX1dOm5vdChbJHtCbG9ja2luZ1NlcnZpY2VVdGlsLk1TRlRfQ09OU0VOVF9DQVRFR09SSUVTX0FUVFJJQlVURX09XCJcIl1bJHtCbG9ja2luZ1NlcnZpY2VVdGlsLkRBVEFTRVRfU1JDX0FUVFJJQlVURX09XCJcIl0pYCxcclxuICAgICAgKVxyXG4gICAgICAuZm9yRWFjaChibG9ja2VkTm9kZSA9PiB7XHJcbiAgICAgICAgY29uc3QgaWZyYW1lTm9kZSA9IDxIVE1MSUZyYW1lRWxlbWVudD5ibG9ja2VkTm9kZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgY29uc2VudENhdGVnb3JpZXMgPSBpZnJhbWVOb2RlLmdldEF0dHJpYnV0ZShcclxuICAgICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5NU0ZUX0NPTlNFTlRfQ0FURUdPUklFU19BVFRSSUJVVEUsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29uc3Qgbm90Q29uc2VudGVkQ2F0ZWdvcmllcyA9IGNvbnNlbnRDYXRlZ29yaWVzXHJcbiAgICAgICAgICAgID8uc3BsaXQoJywnKVxyXG4gICAgICAgICAgICAuZmlsdGVyKFxyXG4gICAgICAgICAgICAgIHggPT5cclxuICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLlN0b3JlLmdldHRlcnMudXNlckNvbnNlbnQ/LnByZWZlcmVuY2VzW1xyXG4gICAgICAgICAgICAgICAgICAgIHhcclxuICAgICAgICAgICAgICAgICAgXSA9PT0gUHJlZmVyZW5jZS5PTlxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgbm90Q29uc2VudGVkQ2F0ZWdvcmllcyA9PSBudWxsIHx8XHJcbiAgICAgICAgICAgIG5vdENvbnNlbnRlZENhdGVnb3JpZXMubGVuZ3RoID09PSAwXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGlmcmFtZU5vZGUucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgcGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoaWZyYW1lTm9kZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSA8SFRNTElGcmFtZUVsZW1lbnQ+aWZyYW1lTm9kZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGxldCBkYXRhc3JjID0gbmV3Tm9kZS5nZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlVXRpbC5EQVRBU0VUX1NSQ19BVFRSSUJVVEUsXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGRhdGFzcmMgPSBkYXRhc3JjICE9PSBudWxsID8gZGF0YXNyYyA6ICcnO1xyXG4gICAgICAgICAgICBuZXdOb2RlLnNldEF0dHJpYnV0ZShCbG9ja2luZ1NlcnZpY2VVdGlsLlNSQ19BVFRSSUJVVEUsIGRhdGFzcmMpO1xyXG4gICAgICAgICAgICBuZXdOb2RlLnJlbW92ZUF0dHJpYnV0ZShCbG9ja2luZ1NlcnZpY2VVdGlsLkRBVEFTRVRfU1JDX0FUVFJJQlVURSk7XHJcbiAgICAgICAgICAgIHBhcmVudE5vZGUgPT0gbnVsbFxyXG4gICAgICAgICAgICAgID8gZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChuZXdOb2RlKVxyXG4gICAgICAgICAgICAgIDogcGFyZW50Tm9kZS5hcHBlbmRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5fX01TRlRfU0RLLkxvZ2dlci5pbmZvKFxyXG4gICAgICAgICAgICAgICdGYWlsZWQgdG8gdW5ibG9jayBpZnJhbWUgJyArXHJcbiAgICAgICAgICAgICAgICBpZnJhbWVOb2RlLnNyYyArXHJcbiAgICAgICAgICAgICAgICAnbm90IGNvbnNlbnRlZCBmb3IgY2F0ZWdvcmllcyAnICtcclxuICAgICAgICAgICAgICAgIG5vdENvbnNlbnRlZENhdGVnb3JpZXM/LnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxyXG4gICAgICAgICAgY29uc29sZS53YXJuKFxyXG4gICAgICAgICAgICAnRmFpbGVkIHRvIHVuYmxvY2sgdGhlIGlmcmFtZSAnLFxyXG4gICAgICAgICAgICBpZnJhbWVOb2RlLnNyYyxcclxuICAgICAgICAgICAgJ3dpdGggZXJyb3IgJyxcclxuICAgICAgICAgICAgZXJyb3IsXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLmVycm9yKFxyXG4gICAgICAgICAgICAnRmFpbGVkIHRvIHVuYmxvY2sgaUZyYW1lICcgKyBpZnJhbWVOb2RlLnNyYyxcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGFydChlbmFibGVNdXRhdGlvbk9ic2VydmVyOiBib29sZWFuKSB7XHJcbiAgICB3aW5kb3cuX19NU0ZUX1NESy5FdmVudEJ1cy5vbihcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuZW51bXMuUHVibGljRXZlbnRzLkNvbnNlbnRDaGFuZ2VkLFxyXG4gICAgICBCbG9ja2luZ1NlcnZpY2UudW5ibG9jayxcclxuICAgICk7XHJcbiAgICB0aGlzLmRvbU9ic2VydmVyID0gbnVsbDtcclxuICAgIGlmIChlbmFibGVNdXRhdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgIHRoaXMuZG9tT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihcclxuICAgICAgICAobXV0YXRpb25SZWNvcmRzOiBNdXRhdGlvblJlY29yZFtdKSA9PlxyXG4gICAgICAgICAgQmxvY2tpbmdTZXJ2aWNlLm11dGF0aW9uQ2FsbGJhY2sobXV0YXRpb25SZWNvcmRzKSxcclxuICAgICAgKTtcclxuICAgICAgdGhpcy5kb21PYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwge1xyXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgICBzdWJ0cmVlOiB0cnVlLFxyXG4gICAgICB9KTtcclxuICAgICAgd2luZG93Ll9fTVNGVF9TREsuTG9nZ2VyLmluZm8oJ1N0YXJ0ZWQgdHJhY2tlciBibG9ja2luZyBzZXJ2aWNlJyk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQmxvY2tpbmdTZXJ2aWNlSW5zdGFuY2UgPSBuZXcgQmxvY2tpbmdTZXJ2aWNlKCk7XHJcbiIsImltcG9ydCB7IEJsb2NraW5nU2VydmljZUluc3RhbmNlLCBCbG9ja2luZ1NlcnZpY2UgfSBmcm9tICcuLi9CbG9ja2luZ1NlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFB1YmxpY0FQSSB7XHJcbiAgcHVibGljIHN0YXRpYyBnZXRCbG9ja2luZ1NlcnZpY2UoKTogQmxvY2tpbmdTZXJ2aWNlIHtcclxuICAgIHJldHVybiBCbG9ja2luZ1NlcnZpY2VJbnN0YW5jZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHVibGljQVBJIH0gZnJvbSAnLi9wdWJsaWNBcGknO1xyXG53aW5kb3cuX19NU0ZUX1NESy5IZWxwZXJzLkFkZFB1YmxpY0FwaXMoUHVibGljQVBJKTtcclxud2luZG93Ll9fTVNGVF9TREsuSGVscGVycy5leHBvc2VBcGlzKCk7XHJcblxyXG5pZiAoXHJcbiAgd2luZG93Ll9fTVNGVF9TREsuU3RvcmUuZ2V0dGVycy5wYWNrYWdlQ29uZmlndXJhdGlvbnNcclxuICAgIC5pc1RyYWNrZXJCbG9ja2luZ0VuYWJsZWQgPz9cclxuICB0cnVlXHJcbikge1xyXG4gIFB1YmxpY0FQSS5nZXRCbG9ja2luZ1NlcnZpY2UoKS5zdGFydCh0cnVlKTtcclxufVxyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0lBQUEsSUFBWSxnQkFHWDtJQUhELFdBQVksZ0JBQWdCO1FBQzFCLHlDQUFxQixDQUFBO1FBQ3JCLHlDQUFxQixDQUFBO0lBQ3ZCLENBQUMsRUFIVyxnQkFBZ0IsS0FBaEIsZ0JBQWdCLFFBRzNCO0lBRUQsSUFBWSxZQWdCWDtJQWhCRCxXQUFZLFlBQVk7UUFDdEIsaURBQWlDLENBQUE7UUFDakMsdURBQXVDLENBQUE7UUFDdkMsK0NBQStCLENBQUE7UUFDL0IseURBQXlDLENBQUE7UUFDekMsdUNBQXVCLENBQUE7UUFDdkIsdUNBQXVCLENBQUE7UUFDdkIsNkNBQTZCLENBQUE7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
