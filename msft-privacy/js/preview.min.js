!function(){"use strict";(i=n=n||{}).INIT_CONFIG="initConfig",i.DISCONNECT="disconnect",(e=e||{}).CONNECTED="connected",t.prototype.send=function(n){var e;null!=(e=this.source)&&e.postMessage(n,{targetOrigin:this.origin})},t.prototype.listen=function(){var e=this;window.addEventListener("message",function(n){e.onMessageReceived(n)})},t.prototype.onMessageReceived=function(n){this.regExp.test(n.origin)?(this.source=this.source||n.source,this.origin=n.origin,this.callback(n.data)):window.__MSFT_SDK.Logger.warn("Received invalid origin '".concat(n.origin,"'. Skipping execution."))};var n,e,i=t;function t(n){this.source=null,this.origin="",this.regExp=new RegExp("^https://privacy.(ci|ms).ext.web.purview.azure(-test){0,1}.com$"),this.callback=n,this.listen()}c.send=function(n){c.messengerPlugin.send(n)},c.listen=function(n,e){c.callbacksMap[n]=c.callbacksMap[n]||[],c.callbacksMap[n].push(e)},c.getMessengerPlugin=function(){return c.messengerPlugin},c.onMessage=function(n){var e=n.event,i=n.value;null!=(n=c.callbacksMap[e])&&n.forEach(function(n){return n(i)})},c.callbacksMap={},c.messengerPlugin=new i(c.onMessage);var s=c;function c(){}(i={})[e.CONNECTED]=function(){s.send({event:e.CONNECTED})};var o=i,a=((i={})[n.INIT_CONFIG]=function(n){window.__MSFT_SDK.initConsent(n),o.connected()},i[n.DISCONNECT]=function(){window.close()},i);Object.keys(a).forEach(function(n){s.listen(n,a[n])})}();
