!function(){"use strict";(i=n=n||{}).INIT_CONFIG="initConfig",i.DISCONNECT="disconnect",(i=e=e||{}).CONNECTED="connected",i.CLOSED="closed",t.prototype.send=function(n){var e;null!=(e=this.source)&&e.postMessage(n,{targetOrigin:this.origin})},t.prototype.onMessageReceived=function(n){this.regExp.test(n.origin)?(this.source=this.source||n.source,this.origin=this.origin||n.origin,this.callback(n.data)):window.__MSFT_SDK.Logger.warn("Received invalid origin '".concat(n.origin,"'. Skipping execution."))},t.prototype.listen=function(){var e=this;window.addEventListener("message",function(n){e.onMessageReceived(n)})};var n,e,i=t;function t(n){this.source=null,this.origin="",this.regExp=new RegExp("^https://privacy.(ci|ms|canary).ext.web.purview.azure(-test){0,1}.com$"),this.callback=n,this.listen()}o.send=function(n){o.messengerPlugin.send(n)},o.listen=function(n,e){o.callbacksMap[n]=o.callbacksMap[n]||[],o.callbacksMap[n].push(e)},o.getMessengerPlugin=function(){return o.messengerPlugin},o.onMessage=function(n){var e=n.event,i=n.value;null!=(n=o.callbacksMap[e])&&n.forEach(function(n){return n(i)})},o.callbacksMap={},o.messengerPlugin=new i(o.onMessage);var s=o;function o(){}(i={})[e.CONNECTED]=function(){s.send({event:e.CONNECTED})},i[e.CLOSED]=function(){s.send({event:e.CLOSED})};var c=i,a=((i={})[n.INIT_CONFIG]=function(n){window.__MSFT_SDK.initConsent(n),c.connected()},i[n.DISCONNECT]=function(){window.close()},i);Object.keys(a).forEach(function(n){s.listen(n,a[n])});window.addEventListener("beforeunload",function(){c.closed()},!1)}();
