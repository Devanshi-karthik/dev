!function(){"use strict";var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,s=n.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(o=s.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}function c(e,t,n){if(n||2===arguments.length)for(var o,r=0,s=t.length;r<s;r++)!o&&r in t||((o=o||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var t=(l.flatten=function(e){var t={};return l.flattenRecursively(e,t,""),t},l.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},l.mergeDeep=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(!n.length)return e;var r=n.shift();if(this.isObject(e)&&this.isObject(r))for(var s in r)this.isObject(r[s])?(e[s]||Object.assign(e,((t={})[s]={},t)),this.mergeDeep(e[s],r[s])):Object.assign(e,((t={})[s]=r[s],t));return this.mergeDeep.apply(this,c([e],i(n),!1))},l.flattenRecursively=function(e,t,n){if(void 0===n&&(n=""),"string"==typeof e)t[n]=e;else if(Array.isArray(e))for(var o=0;o<e.length;o++){var r=e[o],s=n;l.flattenRecursively(r,t,s+="["+o+"]")}else if("object"==typeof e)for(o=0;o<Object.keys(e).length;o++){var i=Object.keys(e)[o];""!==(s=n).trim()&&(s+="."),s+=i,l.flattenRecursively(e[i],t,s)}},l);function l(){}var n,r=function(e){this.state=e||{config:{},debug:{logs:[],events:[]},custom:{}}},s=(e(u,n=r),Object.defineProperty(u.prototype,"debugInfo",{get:function(){return this.state.debug},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"config",{get:function(){return this.state.config},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"userConsent",{get:function(){return this.state.custom.userConsent},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isHeadless",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isPreviewMode",{get:function(){return window.location.href.includes("debug=true")},enumerable:!1,configurable:!0}),u);function u(e){return n.call(this,e)||this}var _,S=(e(g,_=r),g.prototype.saveDebugInfo=function(e){var t=e.event,e=e.log;t&&this.state.debug.events.push(t),e&&this.state.debug.logs.push(e)},g.prototype.setUserConsent=function(e){this.state.custom.userConsent=e},g);function g(e){return _.call(this,e)||this}var d,r=(new r).state,f={getters:new s(r),reducers:new S(r),addReducers:function(e){this.reducers=t.mergeDeep(this.reducers,e)},addGetters:function(e){Object.defineProperties(this.getters,Object.getOwnPropertyDescriptors(e.prototype))}};(r=d=d||{})[r.INFO=0]="INFO",r[r.WARN=1]="WARN",r[r.ERROR=2]="ERROR";var w=(m.log=function(e,t){switch(e){case d.WARN:console.warn(t);break;case d.ERROR:console.error(t)}},m);function m(){}var p=(v.info=function(e,t){v.log(d.INFO,e,t)},v.warn=function(e,t){v.log(d.WARN,e,t)},v.error=function(e,t){v.log(d.ERROR,e,t)},v.log=function(e,t,n){n=v.formatLogMessage(e,t,n);f.reducers.saveDebugInfo({log:n}),w.log(e,n)},v.formatLogMessage=function(e,t,n){n=n?"| "+JSON.stringify(n):"";return"["+d[e]+"] "+t+" "+n},v);function v(){}var T=(M.registerConsentNoticeEventHandlers=function(n){Object.keys(M.consentNoticeAttributesMap).forEach(function(e){var t=n.document.querySelector("["+e+"]");t&&(t.onclick=function(){return n.__MSFT_SDK.EventBus.trigger(M.consentNoticeAttributesMap[e])})}),M.addCustomClickEventHandler(n)},M.registerChangeSettingsModalEventHandlers=function(e){var t=e.document.querySelector("["+M.AttrChangeSettingsClose+"]");t&&(t.onclick=function(){return e.__MSFT_SDK.EventBus.trigger(e.__MSFT_SDK.enums.PublicEvents.CloseChangeSettingsModal)});t=e.document.querySelector("["+M.AttrChangeSettingsSave+"]");t&&(t.onclick=function(){M.onTrackerCategorySettingsSave(e)}),M.addCustomClickEventHandler(e)},M.addCustomClickEventHandler=function(t){t.document.querySelectorAll("["+M.AttrClick+"]").forEach(function(e){e.onclick=function(){try{M.onCustomElementClick(e)}catch(e){t.__MSFT_SDK.Logger.error("Error in click handler",e)}}})},M.onTrackerCategorySettingsSave=function(n){var e;try{var t=n.document.querySelectorAll("["+M.AttrTrackerCategory+"]"),o={preferences:{}};null!==(e=n.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.trackerCategories.forEach(function(e){o.preferences[e.name]=e.isEssential?n.__MSFT_SDK.enums.Preference.ON:n.__MSFT_SDK.enums.Preference.OFF}),t.forEach(function(e){var t=null===(t=e.attributes.getNamedItem(M.AttrTrackerCategory))||void 0===t?void 0:t.value;t&&o.preferences[t]!==n.__MSFT_SDK.enums.Preference.ON&&(e=e.checked?n.__MSFT_SDK.enums.Preference.ON:n.__MSFT_SDK.enums.Preference.OFF,o.preferences[t]=e)}),n.__MSFT_SDK.EventBus.trigger(n.__MSFT_SDK.enums.PublicEvents.UpdateConsent,{consent:o}),n.__MSFT_SDK.EventBus.trigger(n.__MSFT_SDK.enums.PublicEvents.CloseChangeSettingsModal)}catch(e){n.__MSFT_SDK.Logger.error("Error while saving user window.__MSFT_SDK.enums.Preference",e)}},M.onCustomElementClick=function(e){var t,n=e.getAttribute(M.AttrClick);n&&(t=e.getAttribute(M.AttrData),e=e.getAttribute(M.AttrFormId),t?window.__MSFT_SDK.EventBus.trigger(n,JSON.parse(t)):e?(e=window.document.getElementById(e))&&(e=new FormData(e),e=Object.fromEntries(e.entries()),window.__MSFT_SDK.EventBus.trigger(n,e)):window.__MSFT_SDK.EventBus.trigger(n))},M.AttrTrackerCategory="msft-tracker-category",M.consentNoticeAttributesMap={"msft-consent-accept":window.__MSFT_SDK.enums.PublicEvents.AcceptAll,"msft-consent-reject":window.__MSFT_SDK.enums.PublicEvents.RejectAll,"msft-consent-settings-open":window.__MSFT_SDK.enums.PublicEvents.ShowChangeSettingsModal},M.AttrChangeSettingsClose="msft-consent-settings-close",M.AttrChangeSettingsSave="msft-consent-settings-save",M.AttrClick="msft-click",M.AttrData="msft-data",M.AttrFormId="msft-form-id",M);function M(){}function h(){h.registerShowTemplateHandlers()}new(h.registerShowTemplateHandlers=function(){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowChangeSettingsModal,h.showChangeSettingsModal),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowConsentNotice,h.showConsentNotice),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseChangeSettingsModal,h.hideChangeSettingsModal),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice,h.hideConsentNotice),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.ConsentModelSelected,h.init),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.Init,h.saveStylesOnInit),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.ShowTemplate,h.showTemplate),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.CloseTemplate,h.closeTemplate)},h.showTemplate=function(e){e=e.templateId;if(!window.__MSFT_SDK.Store.getters.templates||!window.__MSFT_SDK.Store.getters.templates[e])throw new Error("Template : "+e+" not found.");h.showTemplateInIFrame(window.__MSFT_SDK.Store.getters.templates[e],e)},h.closeTemplate=function(e){e=e.templateId;h.closeIFrame(e)},h.saveStylesOnInit=function(e){e.styles&&(window.__MSFT_SDK.Logger.info("user provided styles persisted to window.__MSFT_SDK.Store."),window.__MSFT_SDK.Store.reducers.setStyles(e.styles))},h.init=function(){var e,o,t,n,r,s,i;void 0!==window.__MSFT_SDK.Store.getters.currentConsentModel?(e=(t=window.__MSFT_SDK.Store.getters.currentConsentModel).translations,o=t.templates,s=t.defaultLCID,t=window.__MSFT_SDK.Store.getters.languages,s=h.selectLanguageCode(t,e,s),n=window.__MSFT_SDK.Utils.ObjectUtils.flatten(e[s]),r={},Object.keys(n).forEach(function(e){r["{{"+e+"}}"]=n[e]}),0<(s=Object.keys(r)).length&&(i=new RegExp(s.map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/gi,"\\$&")}).join("|"),"gi"),Object.keys(o).forEach(function(e){var t,n=o[e].replaceAll(i,function(e){return r[e]});window.__MSFT_SDK.Store.reducers.setTemplates(a(a({},window.__MSFT_SDK.Store.getters.templates),((t={})[e]=n,t)))}),window.__MSFT_SDK.Logger.info("Templates updated"))):window.__MSFT_SDK.Logger.warn("Cannot call init before consent model is selected.")},h.selectLanguageCode=function(e,t,n){for(var o=Object.keys(t[n]).length,r=0;r<e.length;r++)if(t[e[r]]&&Object.keys(t[e[r]]===o))return e[r];return n},h.showConsentNotice=function(){var e;void 0!==window.__MSFT_SDK.Store.getters.currentConsentModel?void 0!==window.__MSFT_SDK.Store.getters.templates&&void 0!==window.__MSFT_SDK.Store.getters.templates[window.__MSFT_SDK.enums.TemplateType.ConsentNotice]?(e=window.__MSFT_SDK.Store.getters.templates[window.__MSFT_SDK.enums.TemplateType.ConsentNotice],h.showTemplateInIFrame(e,window.__MSFT_SDK.enums.TemplateType.ConsentNotice)):window.__MSFT_SDK.Logger.error("Notice template not found."):window.__MSFT_SDK.Logger.warn("Cannot call init before consent model is selected.")},h.showChangeSettingsModal=function(){var e;void 0!==window.__MSFT_SDK.Store.getters.templates&&void 0!==window.__MSFT_SDK.Store.getters.templates[window.__MSFT_SDK.enums.TemplateType.ChangeSettingsModal]?(window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice),e=window.__MSFT_SDK.Store.getters.templates[window.__MSFT_SDK.enums.TemplateType.ChangeSettingsModal],h.showTemplateInIFrame(e,window.__MSFT_SDK.enums.TemplateType.ChangeSettingsModal)):window.__MSFT_SDK.Logger.error("Preference center template not found.")},h.changeSettingsTemplatePostProcessing=function(o){var e,t=o.document.querySelectorAll("["+T.AttrTrackerCategory+"]"),r={};null!==(e=o.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.trackerCategories.forEach(function(e){r[e.name]=e}),t.forEach(function(e){var t,n=null===(t=e.attributes.getNamedItem(T.AttrTrackerCategory))||void 0===t?void 0:t.value;void 0!==n&&(r[n].isEssential?(e.checked=!0,e.disabled=!0):null!==(t=o.__MSFT_SDK.Store.getters.userConsent)&&void 0!==t&&t.preferences[n]&&(e.checked=(null===(e=o.__MSFT_SDK.Store.getters.userConsent)||void 0===e?void 0:e.preferences[n])===o.__MSFT_SDK.enums.Preference.ON))}),T.registerChangeSettingsModalEventHandlers(o)},h.showTemplateInIFrame=function(e,t,n){var o;document.getElementById(t)?p.info("Template: "+t+" is already open."):(o={userConsent:window.MSFTConsent.getConsent(),trackerCategories:(null===(o=window.__MSFT_SDK.Store.getters.currentConsentModel)||void 0===o?void 0:o.trackerCategories)||[],origin:window.origin},e="<script>var msftData = "+JSON.stringify(o)+'<\/script><script>var MSFTConsent={sendMessage:function(e,t){top&&top.postMessage({method:e,params:Object.values(t)},msftData.origin)},trigger:function(){this.sendMessage("trigger",arguments)},showChangeSettingsModal:function(){this.sendMessage("showChangeSettingsModal",arguments)},getConsent:function(){return msftData.userConsent},getTrackerCategories:function(){return msftData.trackerCategories}}<\/script>'+e,window.__MSFT_SDK.Utils.IFrameUtils.createIFrame(e,t,n,window.__MSFT_SDK.Store.getters.styles))},h.hideConsentNotice=function(){h.closeIFrame(window.__MSFT_SDK.enums.TemplateType.ConsentNotice)},h.hideChangeSettingsModal=function(){h.closeIFrame(window.__MSFT_SDK.enums.TemplateType.ChangeSettingsModal)},h.closeIFrame=function(e){var t=document.getElementById(e);null!==(e=null==t?void 0:t.parentElement)&&void 0!==e&&e.removeChild(t)},h),window.onmessage=function(e){var t;(t=window.MSFTConsent)[e.data.method].apply(t,c([],i(e.data.params),!1))}}();
