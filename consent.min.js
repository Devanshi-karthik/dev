/* eslint-disable @microsoft/sdl/no-cookies */

!function(){"use strict";var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function r(e,s,c,a){return new(c=c||Promise)(function(n,t){function o(e){try{i(a.next(e))}catch(e){t(e)}}function r(e){try{i(a.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof c?t:new c(function(e){e(t)})).then(o,r)}i((a=a.apply(e,s||[])).next())})}function c(n,o){var r,i,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,i=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){c.label=t[1];break}if(6===t[0]&&c.label<s[1]){c.label=s[1],s=t;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(t);break}s[2]&&c.ops.pop(),c.trys.pop();continue}t=o.call(n,c)}catch(e){t=[6,e],i=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)s.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}function f(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||((o=o||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var t,n,i,p,s=(a.flatten=function(e){var t={};return a.flattenRecursively(e,t,""),t},a.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},a.mergeDeep=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(!n.length)return e;var r=n.shift();if(this.isObject(e)&&this.isObject(r))for(var i in r)this.isObject(r[i])?(e[i]||Object.assign(e,((t={})[i]={},t)),this.mergeDeep(e[i],r[i])):Object.assign(e,((t={})[i]=r[i],t));return this.mergeDeep.apply(this,f([e],d(n),!1))},a.flattenRecursively=function(e,t,n){if(void 0===n&&(n=""),"string"==typeof e)t[n]=e;else if(Array.isArray(e))for(var o=0;o<e.length;o++){var r=e[o],i=n;a.flattenRecursively(r,t,i+="["+o+"]")}else if("object"==typeof e)for(o=0;o<Object.keys(e).length;o++){var s=Object.keys(e)[o];""!==(i=n).trim()&&(i+="."),i+=s,a.flattenRecursively(e[s],t,i)}},a);function a(){}(_=t=t||{}).PRESENTATION="presentation",_.PREVIEW="preview",_.CONFIG="config",_.HANDLEBAR="handlebar",_.PROXY="proxy",(m=n=n||{}).PRESENTATION="/presentation.min.js",m.PREVIEW="/preview.min.js",m.HANDLEBAR="/handlebars.min.js",m.PROXY="/proxy.min.js",(Z=i=i||{}).PRESENTATION="msft-presentation.js",Z.HANDLEBAR="msft-handlebars.js",(Q=p=p||{}).PATH="path",Q.VARIABLE="variable";var u,g=function(e){this.state=e||{config:{},debug:{logs:[],events:[]},custom:{}}},v=(e(h,u=g),Object.defineProperty(h.prototype,"debugInfo",{get:function(){return this.state.debug},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"config",{get:function(){return this.state.config},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"userConsent",{get:function(){return this.state.custom.userConsent},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isHeadless",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isPreviewMode",{get:function(){var e;return(null===(e=this.state.config.initConfig)||void 0===e?void 0:e.preview)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"isLivePreviewMode",{get:function(){var e;return"ConsentLivePreview"===(null===(e=window.parent)||void 0===e?void 0:e.name)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"presentationVariable",{get:function(){return i.PRESENTATION},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"handlebarVariable",{get:function(){return i.HANDLEBAR},enumerable:!1,configurable:!0}),h);function h(e){return u.call(this,e)||this}var S,_=(e(w,S=g),w.prototype.saveDebugInfo=function(e){var t=e.event,e=e.log;t&&this.state.debug.events.push(t),e&&this.state.debug.logs.push(e)},w.prototype.setUserConsent=function(e){this.state.custom.userConsent=e},w.prototype.setInitConfig=function(e){this.state.config.initConfig=e},w);function w(e){return S.call(this,e)||this}var y,m=(new g).state,b={getters:new v(m),reducers:new _(m),addReducers:function(e){this.reducers=s.mergeDeep(this.reducers,e)},addGetters:function(e){Object.defineProperties(this.getters,Object.getOwnPropertyDescriptors(e.prototype))}};(Z=y=y||{})[Z.INFO=0]="INFO",Z[Z.WARN=1]="WARN",Z[Z.ERROR=2]="ERROR";var C=(T.log=function(e,t){switch(e){case y.WARN:console.warn(t);break;case y.ERROR:console.error(t)}},T);function T(){}var M,E=(A.info=function(e,t){A.log(y.INFO,e,t)},A.warn=function(e,t){A.log(y.WARN,e,t)},A.error=function(e,t){A.log(y.ERROR,e,t)},A.log=function(e,t,n){n=A.formatLogMessage(e,t,n);b.reducers.saveDebugInfo({log:n}),C.log(e,n)},A.formatLogMessage=function(e,t,n){n=n?"| "+JSON.stringify(n):"";return"["+y[e]+"] "+t+" "+n},A);function A(){}function P(){this.strategy=M.REPLAY_ALL}(Q=M=M||{})[Q.REPLAY_ALL=0]="REPLAY_ALL",Q[Q.REPLAY_LATEST=1]="REPLAY_LATEST",Q[Q.SKIP=2]="SKIP";g=new(P.prototype.execute=function(t,e){e.forEach(function(e){return t(e)})},P);function D(){this.strategy=M.REPLAY_LATEST}v=new(D.prototype.execute=function(e,t){t.length&&e(t[t.length-1].payload)},D);function F(){this.strategy=M.SKIP}var _=new(F.prototype.execute=function(){},F),O=((m={})[M.REPLAY_ALL]=g,m[M.REPLAY_LATEST]=v,m[M.SKIP]=_,m),R=(N.record=function(e,t){this.eventsLogs[e]=this.eventsLogs[e]||[],this.eventsLogs[e].push({payload:t})},N.replay=function(e,t,n){void 0===n&&(n=this.DEFAULT_STRATEGY),O[n].execute(t,this.eventsLogs[e]||[])},N.eventsLogs={},N.DEFAULT_STRATEGY=M.REPLAY_LATEST,N);function N(){}function K(){this.events={},this.eventIdCounter=0}var I,j,L,k,x,B,H,V,U,Y,W,X=new(K.getDefaultEventDetails=function(){return{executionCount:0,callbacks:[]}},K.prototype.on=function(e,t,n){var o=void 0===n?{}:n,n=o.sync,n=void 0!==n&&n,o=o.replayStrategy;this.eventIdCounter+=this.eventIdCounter;n={id:this.eventIdCounter,fn:t,sync:n};return this.events[e]=this.events[e]||K.getDefaultEventDetails(),this.events[e].callbacks.push(n),R.replay(e,t,o),this.eventIdCounter},K.prototype.trigger=function(e,n){var o=this;void 0===n&&(n={});var t=(null===(t=this.events[e])||void 0===t?void 0:t.callbacks)||[];E.info("Started executing '"+t.length+"' callbacks for event '"+e+"'",n),b.reducers.saveDebugInfo({event:e}),t.forEach(function(t){return r(o,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return t.sync?[3,2]:[4,Promise.resolve()];case 1:e.sent(),e.label=2;case 2:return t.fn(n),[2]}})})}),R.record(e,n),E.info("Completed executing '"+t.length+"' callbacks for event '"+e+"'",n),this.events[e]&&this.events[e].executionCount++},K.prototype.off=function(e,t){var n=null===(n=this.events[e])||void 0===n?void 0:n.callbacks.findIndex(function(e){return e.id!==t&&e.fn!==t});"number"==typeof n&&~n?(E.info("Removing event listener '"+this.events[e].callbacks[n].id+"' of '"+e+"' event"),this.events[e].callbacks.splice(n,1)):E.error("Unable to remove event listener for event '"+e+"'. No matching event id or callback found.")},K);(Z=I=I||{}).Explicit="Explicit",Z.Implicit="Implicit",(Q=j=j||{}).ConsentChanged="ConsentChanged",Q.ShowChangeSettingsModal="ShowChangeSettingsModal",Q.ShowConsentNotice="ConsentNotice",Q.CloseChangeSettingsModal="CloseChangeSettingsModal",Q.CloseConsentNotice="CloseConsentNotice",Q.AcceptAll="AcceptAll",Q.RejectAll="RejectAll",Q.ShowTemplate="ShowTemplate",Q.CloseTemplate="CloseTemplate",Q.UpdateConsent="UpdateConsent",(g=L=L||{}).Init="Init",g.CoreConsentModelSelected="CoreConsentModelSelected",g.ConfigReady="ConfigReady",(v=k=k||{}).Default="Default",v.HeadLess="HeadLess",(_=x=x||{}).Url="Url",_.Text="Text",(m=B=B||{}).ConsentNotice="consentNotice",m.ChangeSettingsModal="preferenceCenter",(Z=H=H||{}).OFF="0",Z.ON="1",(V=V||{}).Consent="msft-consent",(Q=U=U||{}).Script="script",Q.IFrame="iframe",(g=Y=Y||{}).TrackerCategory="trackerCategory",g.Banner="banner",g.CookieSettingsSummary="cookieSettingsSummary",(W=W||{}).TemplateError="There is something wrong with template. Please check logs.";var v=Object.freeze({__proto__:null,get ConsentModelType(){return I},get PublicEvents(){return j},get Events(){return L},get SDKMode(){return k},get StyleType(){return x},get TemplateType(){return B},get Preference(){return H},get Cookie(){return V},get RegisteredDivType(){return U},get NoticeType(){return Y},get ErrorStrings(){return W}}),G=(J.initConsent=function(e){b.reducers.setInitConfig(e),X.trigger(L.Init,e)},J);function J(){}$.init=function(e){G.initConsent(e)},$.showChangeSettingsModal=function(){X.trigger(j.ShowChangeSettingsModal)},$.on=function(e,t,n){n=(void 0===n?{}:n).sync,n=void 0!==n&&n;if(!(e in L))return X.on(e,t,{sync:n});E.error("Cannot subscribe to internal event '"+e+"'.")},$.trigger=function(e,t){e in L?E.error("Cannot trigger internal event '"+e+"'."):X.trigger(e,t)},$.off=function(e,t){e in L?E.error("Cannot detach listener for internal event '"+e+"'."):X.off(e,t)},_=$;function $(){}z.createIFrame=function(e,t,n,o){document.body?z.appendIframe(z.getIframeObject(e,t,o),n):window.addEventListener("DOMContentLoaded",function(){z.appendIframe(z.getIframeObject(e,t,o),n)})},z.getIframeObject=function(e,t,n){n="<html><head>"+z.getAllStylesAsText(n)+'</head><body style="background:transparent;">'+e+"</body></html>",e=document.createElement("iframe");return e.setAttribute("style","height:100%;width:100%;border:0;position:fixed;top: 0"),e.setAttribute("sandbox","allow-scripts"),e.id=t,e.srcdoc=n,e},z.appendIframe=function(e,t){(t||document.body).appendChild(e)},z.getAllStylesAsText=function(e){var n="";return f(f([],d(document.getElementsByTagName("style")),!1),d(document.getElementsByTagName("link")),!1).forEach(function(e){return n+=e.outerHTML}),null!=e&&e.forEach(function(e){var t;e.type==x.Text?((t=document.createElement("style")).appendChild(document.createTextNode(e.value)),n+=t.outerHTML):e.type==x.Url&&((t=document.createElement("link")).rel="stylesheet",t.href=e.value,n+=t.outerHTML)}),n},z.getFrameById=function(e){for(var t,n=0;n<frames.length;n++)if((null===(t=frames[n].frameElement)||void 0===t?void 0:t.id)===e)return frames[n];return null},m=z;function z(){}var Z=(q.AddPublicApis=function(e){this.PublicApis=e},q.exposeApis=function(){var e=Object.getOwnPropertyNames(window.MSFTConsent).filter(function(e){return"function"==typeof e}),t=Object.getOwnPropertyNames(this.PublicApis);e.forEach(function(e){t.includes(e)&&E.warn("Already existing Public Api with the same name '"+e+"'")}),Object.defineProperties(window.MSFTConsent,Object.getOwnPropertyDescriptors(this.PublicApis))},q);function q(){}var Q=Object.freeze({__proto__:null,Constants:{OFF:"0",ON:"1",COOKIE_NAME:"APCC",ConsentConfig:"MicrosoftConsentConfig"}}),ee=(te.topologicalSort=function(e){var n=this,o=this.getAdjacencyList(e),r={};return Object.keys(o).reduce(function(e,t){return e.concat(n.dfs(t,o,r))},[])},te.dfs=function(e,n,o,r){var i=this;if((r=void 0===r?{}:r)[e])throw new Error("Circular dependency found!");if(o[e])return[];r[e]=!0;var t=(null===(t=n[e])||void 0===t?void 0:t.reduce(function(e,t){return e.concat(i.dfs(t,n,o,r))},[]))||[];return o[e]=!0,r[e]=!1,t.concat(e)},te.getAdjacencyList=function(e){var n={};return e.forEach(function(e){var t=d(e,2),e=t[0],t=t[1];n[e]=n[e]||[],(e=n[e]).push.apply(e,f([],d(t),!1))}),n},te);function te(){}var ne={Translation:function(e,t){window.__MSFT_SDK.Store.reducers.setTranslations(f(f([],d(window.__MSFT_SDK.Store.getters.translations||[]),!1),[{noticeName:e,translation:t}],!1))},Model:function(e){window.__MSFT_SDK.Store.reducers.setCurrentConsentModel(e)},Template:function(e){window.__MSFT_SDK.Store.reducers.setTemplate(e)}},oe=(re.deferred=function(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n},re);function re(){}var ie=(se.fetch=function(t){return r(this,void 0,void 0,function(){return c(this,function(e){try{return[2,this.exponentialRetry(function(){return fetch(t).then(function(e){if(!e.ok)throw new Error(e.statusText);return e})})]}catch(e){E.error("Unable to fetch asset '"+t+"'")}return[2]})})},se.exponentialRetry=function(i,s){return void 0===s&&(s=0),r(this,void 0,void 0,function(){var t,n,o,r=this;return c(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i()];case 1:return[2,e.sent()];case 2:if(t=e.sent(),(n=s+1)<this.MAX_RETRY_COUNT)return o=oe.deferred(),setTimeout(function(){r.exponentialRetry(i,n).then(function(){return o.resolve()}).catch(function(){return o.reject()})},this.EXPONENTIAL_DELAY_FACTOR_IN_MS*n),[2,o.promise];throw t;case 3:return[2]}})})},se.MAX_RETRY_COUNT=3,se.EXPONENTIAL_DELAY_FACTOR_IN_MS=250,se);function se(){}var ce,g=function(e,t){this.source=e,this.value="",this.callback=t},ae=(e(ue,ce=g),ue.prototype.fetch=function(){var o;return r(this,void 0,void 0,function(){var t,n;return c(this,function(e){switch(e.label){case 0:return this.source.type!==p.VARIABLE?[3,1]:(this.value=window[this.source.value],[3,4]);case 1:return[4,ie.fetch(this.source.value)];case 2:return t=e.sent(),n=this,[4,null==t?void 0:t.text()];case 3:n.value=null!==(o=e.sent())&&void 0!==o?o:"",e.label=4;case 4:return[2]}})})},ue.prototype.addToDOM=function(){var e=oe.deferred(),t=document.createElement("script");return t.type="text/javascript",t.appendChild(document.createTextNode(this.value)),t.onload=function(){return e.resolve()},t.onerror=function(){return e.reject()},document.body?document.body.appendChild(t):window.addEventListener("DOMContentLoaded",function(){document.body.appendChild(t)}),e.promise},ue.prototype.execute=function(){return this.callback?(this.callback(this.value),Promise.resolve()):this.addToDOM()},ue);function ue(e,t){return ce.call(this,e,t)||this}var le,de=(e(fe,le=g),fe.prototype.fetch=function(){var o;return r(this,void 0,void 0,function(){var t,n;return c(this,function(e){switch(e.label){case 0:return this.source.type!==p.VARIABLE?[3,1]:(this.value=window[this.source.value],[3,4]);case 1:return[4,ie.fetch(this.source.value)];case 2:return t=e.sent(),n=this,[4,null==t?void 0:t.json()];case 3:n.value=null!==(o=e.sent())&&void 0!==o?o:{},e.label=4;case 4:return[2]}})})},fe.prototype.execute=function(){return this.callback?(this.callback(this.value),Promise.resolve()):Promise.reject(new Error("Callback not provided"))},fe);function fe(e,t){return le.call(this,e,t)||this}var pe=(ge.resolveDependencies=function(){return r(this,void 0,void 0,function(){var t,n,o;return c(this,function(e){switch(e.label){case 0:return n=this.getModuleMapAndDependency(),t=n.moduleMap,o=n.moduleDependency,n=this.fetchAllAssets(t),o=ee.topologicalSort(o),[4,Promise.all(n)];case 1:return e.sent(),o.forEach(function(e){t[e]&&t[e].forEach(function(e){return e.execute()})}),[2]}})})},ge.fetchAllAssets=function(e){var t=[];return Object.values(e).forEach(function(e){e.forEach(function(e){t.push(e.fetch())})}),t},ge.getModuleMapAndDependency=function(){var e,s=this,c={},a=[],e={fields:{model:(null===(e=b.getters.selectedCoreConsentModel)||void 0===e?void 0:e.name)||"",lcid:b.getters.lcid,sdkRootPath:(null===(e=b.getters.selectedCoreConsentModel)||void 0===e?void 0:e.attributes.assetsPath)||""},modules:[{module:t.CONFIG,source:{type:p.VARIABLE,value:"test.js"},dependency:[],callback:function(){console.log("i m here"),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.Events.ConfigReady)},condition:function(){return!(b.getters.isPreviewMode||b.getters.isLivePreviewMode)},configs:f(f([],d((null===(e=b.getters.selectedCoreConsentModel)||void 0===e?void 0:e.attributes.notices.map(function(t){return{source:{type:p.PATH,value:"$sdkRootPath/notices/"+t+"/translations/$lcid.json"},callback:function(e){return ne.Translation(t,e)}}}))||[]),!1),[{source:{type:p.PATH,value:"$sdkRootPath/models/$model.json"},callback:ne.Model},{source:{type:p.PATH,value:"$sdkRootPath/templates/"+(null===(e=b.getters.selectedCoreConsentModel)||void 0===e?void 0:e.attributes.templates[0].name)+".json"},callback:ne.Template}],!1)},{module:t.PRESENTATION,source:b.getters.isPreviewMode?{type:p.VARIABLE,value:b.getters.presentationVariable}:{type:p.PATH,value:n.PRESENTATION},condition:function(){return!b.getters.isHeadless},dependency:[t.HANDLEBAR,t.CONFIG,t.PROXY]},{module:t.HANDLEBAR,source:b.getters.isPreviewMode?{type:p.VARIABLE,value:b.getters.handlebarVariable}:{type:p.PATH,value:n.HANDLEBAR},condition:function(){return!b.getters.isHeadless},dependency:[]},{module:t.PREVIEW,source:{type:p.PATH,value:n.PREVIEW},condition:function(){return b.getters.isLivePreviewMode},dependency:[]},{module:t.PROXY,source:{type:p.PATH,value:n.PROXY},callback:function(e){window.__MSFT_SDK.Store.reducers.setProxyJS(e)},dependency:[]}]},u=e.fields;return e.modules.forEach(function(e){var t=e.module,n=e.source,o=e.configs,r=e.condition,i=e.dependency,e=e.callback;r&&!r()||(c[t]=f([],d(s.getModuleTypeInstances({source:n,callback:e,fields:u})),!1),a.push([t,i||[]]),o&&(c[t+".configs"]=o.reduce(function(e,t){return e.concat(s.getModuleTypeInstances(l(l({},t),{fields:u})))},[]),a.push([t,[t+".configs"]])))}),{moduleMap:c,moduleDependency:a}},ge.getModuleTypeInstances=function(e){var t=e.source,n=e.callback,e=e.fields;if(void 0===t)return[];var o=[],r=t.value.split(".").pop();return t.type===p.PATH?this.resolvePathFields({path:t.value,fields:e}).forEach(function(e){ge.addModuleResolver({value:e,type:p.PATH},o,r,n)}):ge.addModuleResolver(t,o,r,n),o},ge.addModuleResolver=function(e,t,n,o){switch(n){case"js":t.push(new ae(e,o));break;case"json":o?t.push(new de(e,o)):E.error("No callback provided for json asset with "+e.type+" '"+e.value+"'. Skipping it.");break;default:E.error("Cannot resolve dependency. Unknown extension identified for "+e.type+" '"+e.value+"'")}},ge.resolvePathFields=function(e){var t=e.path,r=e.fields,e=f([],d(t.matchAll(/\$(\w+)/g)),!1),i=[t];return e.forEach(function(n){var e=r[n[1]],e=Array.isArray(e)?e:[e],o=[];e.forEach(function(t){i.forEach(function(e){o.push(e.replace(n[0],t))})}),i=o}),i},ge);function ge(){}window.__MSFT_SDK={EventBus:X,Logger:E,Store:b,Utils:{IFrameUtils:m,ObjectUtils:s},enums:v,constants:Q,Helpers:Z,config:(null===(Z=window.__MSFT_SDK)||void 0===Z?void 0:Z.config)||{},initConsent:G.initConsent},window.MSFTConsent=_,X.on(L.CoreConsentModelSelected,function(){pe.resolveDependencies()});var ve=(he.encodeConsent=function(e,t){var n=e.preferences,e=he.VERSION+"="+t.attributes.version.toString()+"%";return e+=he.ModelName+"="+t.name.toString()+"%",e+=Object.keys(n).map(function(e){return e+"="+n[e]}).join("%")},he.decodeConsentString=function(e){var n={};return e.split("%").forEach(function(e){var t=e.split("=");2===t.length&&(e=t[0],t=t[1],e!==he.VERSION&&e!==he.ModelName&&(n[e]=t))}),{preferences:n}},he.getVersionFromString=function(e){e=e.match(/version=([\d.]+)%/);if(null==e)return-1;e=parseInt(e[1]);return isNaN(e)?-1:e},he.getModelNameFromString=function(e){e=e.match(/modelName=([^%]+)%/);if(null!=e)return e[1]},he.VERSION="version",he.ModelName="modelName",he);function he(){}var Z=function(e){this.state=e||{config:{sdkConfig:window.__MSFT_SDK.config},custom:{}}},Se=(_e.get=function(){return document.cookie},_e.getItem=function(t){return document.cookie.split("; ").find(function(e){return e.startsWith(t+"=")})||""},_e.set=function(e){document.cookie=e},_e.setItem=function(e,t,n){var o;n&&((o=new Date).setTime(o.getTime()+n),o=o.toUTCString()),document.cookie=e+"="+t+(o?"; expires="+o:"")+"; path=/"},_e);function _e(){}var we,ye=(e(me,we=Z),Object.defineProperty(me.prototype,"currentConsentModel",{get:function(){return this.state.config.currentConsentModel},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"selectedCoreConsentModel",{get:function(){return this.state.config.selectedCoreConsentModel},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"consentModels",{get:function(){return this.state.config.sdkConfig.consentModels},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"template",{get:function(){return this.state.config.template},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"translations",{get:function(){return this.state.config.translations||[]},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"styles",{get:function(){return this.state.custom.styles},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"timezone",{get:function(){return window.Intl.DateTimeFormat().resolvedOptions().timeZone},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"languages",{get:function(){return navigator.languages},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"encodedConsent",{get:function(){return Se.getItem(window.__MSFT_SDK.enums.Cookie.Consent)},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"templateParentMap",{get:function(){var e;return(null===(e=this.state.config.template)||void 0===e?void 0:e.componentParentMap)||{}},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"extendedTrackers",{get:function(){return this.state.config.sdkConfig.extendedTrackers},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"lcid",{get:function(){return this.state.custom.lcid},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"components",{get:function(){return this.state.config.components||{}},enumerable:!1,configurable:!0}),Object.defineProperty(me.prototype,"proxyJS",{get:function(){return this.state.custom.proxyJS},enumerable:!1,configurable:!0}),me);function me(e){return we.call(this,e)||this}var be,_=(e(Ce,be=Z),Ce.prototype.setCurrentConsentModel=function(e){this.state.config.currentConsentModel=e},Ce.prototype.setSelectedCoreConsentModel=function(e){this.state.config.selectedCoreConsentModel=e},Ce.prototype.setTemplate=function(e){this.state.config.template=e},Ce.prototype.setTranslations=function(e){this.state.config.translations=e},Ce.prototype.setStyles=function(e){this.state.custom.styles=e},Ce.prototype.setEncodedConsentString=function(e,t,n){Se.setItem(e,t,n)},Ce.prototype.setLcid=function(e){this.state.custom.lcid=e},Ce.prototype.setComponents=function(e){this.state.config.components=e},Ce.prototype.setProxyJS=function(e){this.state.custom.proxyJS=e},Ce);function Ce(e){return be.call(this,e)||this}var Z=(new Z).state,Te={getters:new ye(Z),reducers:new _(Z)};function Me(){window.__MSFT_SDK.Store.addReducers(Te.reducers),window.__MSFT_SDK.Store.addGetters(ye),Me.registerEvents()}new(Me.registerEvents=function(){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.Init,Me.onInit)},Me.matchLocation=function(e,t){if(!t||!Array.isArray(t))return!1;for(var n=0;n<t.length;n++){var o=t[n];if("all"===o||o===e)return!0}return 0===t.length},Me.selectConsentModel=function(e){for(var t=e.countryOrRegion,n=e.coreConsentModels||window.__MSFT_SDK.Store.getters.consentModels,o=n[0],r=0;r<n.length;r++){var i=n[r];if(void 0===t?Me.matchLocation(window.__MSFT_SDK.Store.getters.timezone,i.conditionalAttributes.geoLocations):Me.matchLocation(t,i.conditionalAttributes.countriesOrRegions)){o=i;break}}window.__MSFT_SDK.Store.reducers.setSelectedCoreConsentModel(o),Me.selectLanguageCode(o.attributes.lcids,o.attributes.defaultLCID),window.__MSFT_SDK.EventBus.trigger(L.CoreConsentModelSelected),window.__MSFT_SDK.Logger.info("Consent model selected.")},Me.selectLanguageCode=function(e,t){for(var n=t,o=window.__MSFT_SDK.Store.getters.languages,r=0;r<o.length;r++)if(e.includes(o[r])){n=o[r];break}window.__MSFT_SDK.Store.reducers.setLcid(n)},Me.onInit=function(e){Me.selectConsentModel(e),Me.updateConfigIfPresent(e)},Me.updateConfigIfPresent=function(e){var t=e.translations,n=e.templates,e=e.consentModels;!e||(e=e.find(function(e){return e.name===(null===(e=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel)||void 0===e?void 0:e.name)}))&&window.__MSFT_SDK.Store.reducers.setCurrentConsentModel(e),t&&window.__MSFT_SDK.Store.reducers.setTranslations(t[window.__MSFT_SDK.Store.getters.lcid]),n&&(window.__MSFT_SDK.Store.reducers.setTemplate(n[0]),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.Events.ConfigReady))},Me);var Ee=(Ae.getTrackerCategories=function(){if(void 0!==window.__MSFT_SDK.Store.getters.currentConsentModel)return window.__MSFT_SDK.Store.getters.currentConsentModel.attributes.trackerCategories;throw new Error("Consent Model not selected.")},Ae.getDefaultConsent=function(t){var e,n={preferences:{}};return null!==(e=window.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.attributes.trackerCategories.forEach(function(e){n.preferences[e.categoryName]=e.isEssential||t===window.__MSFT_SDK.enums.ConsentModelType.Implicit?window.__MSFT_SDK.enums.Preference.ON:window.__MSFT_SDK.enums.Preference.OFF}),n},Ae);function Ae(){}var Pe=(De.registerEvents=function(){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.ConfigReady,De.showNoticeIfConsentInvalid),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.AcceptAll,De.acceptAllCategories),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.RejectAll,De.rejectAllNonEssentialCategories),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.UpdateConsent,De.setConsent)},De.getConsent=function(){return window.__MSFT_SDK.Store.getters.userConsent||Ee.getDefaultConsent(window.__MSFT_SDK.enums.ConsentModelType.Explicit)},De.getConsentFor=function(e){return De.getConsent().preferences[e]},De.setConsent=function(e){var t=e.consent,n=window.__MSFT_SDK.Store.getters.currentConsentModel,e=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel;void 0!==n&&void 0!==e?(e=ve.encodeConsent(t,e),window.__MSFT_SDK.Store.reducers.setEncodedConsentString(window.__MSFT_SDK.enums.Cookie.Consent,e,1e3*n.attributes.expiryInSec),window.__MSFT_SDK.Store.reducers.setUserConsent(t),window.__MSFT_SDK.Logger.info("Consent updated."),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.ConsentChanged)):window.__MSFT_SDK.Logger.warn("Cannot set user consent before consent model is ready.")},De.isConsentValid=function(){var e=window.__MSFT_SDK.Store.getters.encodedConsent;if(void 0===e)return!1;if(void 0===window.__MSFT_SDK.Store.getters.selectedCoreConsentModel)return window.__MSFT_SDK.Logger.warn("Consent model not selected, can't validate consent."),!0;var t=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel,n=t.attributes,t=t.name;return ve.getVersionFromString(e)===n.version&&ve.getModelNameFromString(e)===t},De.showNoticeIfConsentInvalid=function(){var t=(null===(e=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel)||void 0===e?void 0:e.attributes.definition)||I.Explicit,e=De.isConsentValid();e||t!==I.Explicit||window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.ShowConsentNotice);var n=e?ve.decodeConsentString(window.__MSFT_SDK.Store.getters.encodedConsent).preferences:{},o={preferences:{}};null!==(e=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel)&&void 0!==e&&e.attributes.trackerCategories.forEach(function(e){e.isEssential?o.preferences[e.categoryName]=window.__MSFT_SDK.enums.Preference.ON:o.preferences[e.categoryName]=n[e.categoryName]||De.getDefaultPreference(t)}),window.__MSFT_SDK.Store.reducers.setUserConsent(o)},De.getDefaultPreference=function(e){return e===I.Explicit?H.OFF:H.ON},De.acceptAllCategories=function(){var e,t={preferences:{}};null!==(e=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel)&&void 0!==e&&e.attributes.trackerCategories.forEach(function(e){t.preferences[e.categoryName]=window.__MSFT_SDK.enums.Preference.ON}),De.setConsent({consent:t}),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice)},De.rejectAllNonEssentialCategories=function(){var e,t={preferences:{}};null!==(e=window.__MSFT_SDK.Store.getters.selectedCoreConsentModel)&&void 0!==e&&e.attributes.trackerCategories.forEach(function(e){t.preferences[e.categoryName]=e.isEssential?window.__MSFT_SDK.enums.Preference.ON:window.__MSFT_SDK.enums.Preference.OFF}),De.setConsent({consent:t}),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice)},De);function De(){De.registerEvents()}new Pe;Fe.getConsent=function(){return Pe.getConsent()},Fe.getTrackerCategories=function(){return Ee.getTrackerCategories()},Fe.getConsentModels=function(){return window.__MSFT_SDK.Store.getters.consentModels.map(function(e){var t=e.name;return{name:t,version:e.attributes.version,selected:(null===(e=window.__MSFT_SDK.Store.getters.currentConsentModel)||void 0===e?void 0:e.name)===t}})},Z=Fe;function Fe(){}window.__MSFT_SDK.Helpers.AddPublicApis(Z),window.__MSFT_SDK.Helpers.exposeApis()}();
