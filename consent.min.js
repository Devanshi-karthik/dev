/* eslint-disable @microsoft/sdl/no-cookies */

!function(){"use strict";var o=(r.encodeConsent=function(e,n){var t=e.preferences,e=r.VERSION+"="+n.version.toString()+"%";return e+=r.ModelName+"="+n.name.toString()+"%",e+=Object.keys(t).map(function(e){return e+"="+t[e]}).join("%")},r.decodeConsentString=function(e){var t={};return e.split("%").forEach(function(e){var n=e.split("=");2===n.length&&(e=n[0],n=n[1],e!==r.VERSION&&e!==r.ModelName&&(t[e]=n))}),{preferences:t}},r.getVersionFromString=function(e){e=e.match(/version=([\d.]+)%/);if(null==e)return-1;e=parseInt(e[1]);return isNaN(e)?-1:e},r.getModelNameFromString=function(e){e=e.match(/modelName=([^%]+)%/);if(null!=e)return e[1]},r.VERSION="version",r.ModelName="modelName",r);function r(){}var e=function(e){this.state=e||{config:{sdkConfig:"undefined"==typeof config?{consentModels:[],extendedTrackers:[]}:config},custom:{}}},s=function(e,n){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}s(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var i=(t.get=function(){return document.cookie},t.getItem=function(n){return document.cookie.split("; ").find(function(e){return e.startsWith(n+"=")})||""},t.set=function(e){document.cookie=e},t.setItem=function(e,n,t){var o;t&&((o=new Date).setTime(o.getTime()+t),o=o.toUTCString()),document.cookie=e+"="+n+(o?"; expires="+o:"")+"; path=/"},t);function t(){}var c,u=(n(_,c=e),Object.defineProperty(_.prototype,"currentConsentModel",{get:function(){return this.state.config.currentConsentModel},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"consentModels",{get:function(){return this.state.config.sdkConfig.consentModels},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"templates",{get:function(){return this.state.config.templates},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"styles",{get:function(){return this.state.custom.styles},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"timezone",{get:function(){return window.Intl.DateTimeFormat().resolvedOptions().timeZone},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"languages",{get:function(){return navigator.languages},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"encodedConsent",{get:function(){return i.getItem(window.__MSFT_SDK.enums.Cookie.Consent)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"extendedTrackers",{get:function(){return this.state.config.sdkConfig.extendedTrackers},enumerable:!1,configurable:!0}),_);function _(e){return c.call(this,e)||this}var d,S=(n(l,d=e),l.prototype.setCurrentConsentModel=function(e){this.state.config.currentConsentModel=e},l.prototype.setTemplates=function(e){this.state.config.templates=e},l.prototype.setStyles=function(e){this.state.custom.styles=e},l.prototype.setEncodedConsentString=function(e,n,t){i.setItem(e,n,t)},l);function l(e){return d.call(this,e)||this}var e=(new e).state,a={getters:new u(e),reducers:new S(e)};function w(){window.__MSFT_SDK.Store.addReducers(a.reducers),window.__MSFT_SDK.Store.addGetters(u),w.registerEvents(),w.selectConsentModel()}new(w.registerEvents=function(){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.Init,w.onInit)},w.selectConsentModel=function(e){for(var n=window.__MSFT_SDK.Store.getters.consentModels,t=0;t<n.length;t++){var o=n[t];if(void 0===e?0==o.geoLocations.length||o.geoLocations.includes(window.__MSFT_SDK.Store.getters.timezone):o.countriesOrRegions.includes(e)){window.__MSFT_SDK.Store.reducers.setCurrentConsentModel(o),window.__MSFT_SDK.Logger.info("Consent model selected."),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.Events.ConsentModelSelected);break}}},w.onInit=function(e){e.consentModel?(window.__MSFT_SDK.Store.reducers.setCurrentConsentModel(e.consentModel),window.__MSFT_SDK.Logger.info("Consent model selected."),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.Events.ConsentModelSelected)):e.countryOrRegion&&w.selectConsentModel(e.countryOrRegion),e.template&&window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.ShowTemplate,{templateId:e.template})},w);var f=(g.getTrackerCategories=function(){if(void 0!==window.__MSFT_SDK.Store.getters.currentConsentModel)return window.__MSFT_SDK.Store.getters.currentConsentModel.trackerCategories;throw new Error("Consent Model not selected.")},g.getDefaultConsent=function(n){var e,t={preferences:{}};return null!==(e=window.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.trackerCategories.forEach(function(e){t.preferences[e.name]=e.isEssential||n===window.__MSFT_SDK.enums.ConsentModelType.Implicit?window.__MSFT_SDK.enums.Preference.ON:window.__MSFT_SDK.enums.Preference.OFF}),t},g);function g(){}var M=(p.registerEvents=function(){window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.Events.Init,p.showNoticeIfConsentInvalid),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.AcceptAll,p.acceptAllCategories),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.RejectAll,p.rejectAllNonEssentialCategories),window.__MSFT_SDK.EventBus.on(window.__MSFT_SDK.enums.PublicEvents.UpdateConsent,p.setConsent)},p.getConsent=function(){return window.__MSFT_SDK.Store.getters.userConsent||f.getDefaultConsent(window.__MSFT_SDK.enums.ConsentModelType.Explicit)},p.getConsentFor=function(e){return p.getConsent().preferences[e]},p.setConsent=function(e){var n=e.consent,t=window.__MSFT_SDK.Store.getters.currentConsentModel;void 0!==t?(e=o.encodeConsent(n,t),window.__MSFT_SDK.Store.reducers.setEncodedConsentString(window.__MSFT_SDK.enums.Cookie.Consent,e,1e3*t.expiryInSec),window.__MSFT_SDK.Store.reducers.setUserConsent(n),window.__MSFT_SDK.Logger.info("Consent updated."),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.ConsentChanged)):window.__MSFT_SDK.Logger.warn("Cannot set user consent before consent model is selected.")},p.isConsentValid=function(){var e=window.__MSFT_SDK.Store.getters.encodedConsent;if(void 0===e)return!1;if(void 0===window.__MSFT_SDK.Store.getters.currentConsentModel)return window.__MSFT_SDK.Logger.warn("Consent model not selected, can't validate consent."),!0;var n=window.__MSFT_SDK.Store.getters.currentConsentModel,t=n.version,n=n.name;return o.getVersionFromString(e)===t&&o.getModelNameFromString(e)===n},p.showNoticeIfConsentInvalid=function(){var e,n,t;p.isConsentValid()?(n=o.decodeConsentString(window.__MSFT_SDK.Store.getters.encodedConsent).preferences,t={preferences:{}},null!==(e=window.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.trackerCategories.forEach(function(e){e.isEssential?t.preferences[e.name]=window.__MSFT_SDK.enums.Preference.ON:t.preferences[e.name]=n[e.name]||window.__MSFT_SDK.enums.Preference.OFF}),window.__MSFT_SDK.Store.reducers.setUserConsent(t)):window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.ShowConsentNotice)},p.acceptAllCategories=function(){var e,n={preferences:{}};null!==(e=window.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.trackerCategories.forEach(function(e){n.preferences[e.name]=window.__MSFT_SDK.enums.Preference.ON}),p.setConsent({consent:n}),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice)},p.rejectAllNonEssentialCategories=function(){var e,n={preferences:{}};null!==(e=window.__MSFT_SDK.Store.getters.currentConsentModel)&&void 0!==e&&e.trackerCategories.forEach(function(e){n.preferences[e.name]=e.isEssential?window.__MSFT_SDK.enums.Preference.ON:window.__MSFT_SDK.enums.Preference.OFF}),p.setConsent({consent:n}),window.__MSFT_SDK.EventBus.trigger(window.__MSFT_SDK.enums.PublicEvents.CloseConsentNotice)},p);function p(){p.registerEvents()}new M;m.getConsent=function(){return M.getConsent()},m.getTrackerCategories=function(){return f.getTrackerCategories()},m.getConsentModels=function(){return window.__MSFT_SDK.Store.getters.consentModels.map(function(e){var n=e.name;return{name:n,version:e.version,selected:(null===(e=window.__MSFT_SDK.Store.getters.currentConsentModel)||void 0===e?void 0:e.name)===n}})},e=m;function m(){}window.__MSFT_SDK.Helpers.AddPublicApis(e),window.__MSFT_SDK.Helpers.exposeApis()}();
